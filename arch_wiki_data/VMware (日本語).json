{
  "title": "VMware (日本語)",
  "url": "https://wiki.archlinux.org/title/VMware_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- VMware に Arch Linux をインストール\n- VirtualBox\n- KVM\n- QEMU\n- Xen\n- 既存環境を仮想マシンに (から) 移動\n\nこの記事では最新バージョンの VMware である VMware Workstation Pro と Player 16, 15, 14, 12.5 を扱います。 ​ VMware に Arch Linux をインストールすることもできます。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 前提条件\n- 2 インストール 2.1 VMware bundle 2.2 Package build for x86_64\n- 3 設定 3.1 カーネルモジュール 3.2 systemd サービス 3.2.1 Workstation Server サービス\n- 4 アプリケーションを起動する\n- 5 ヒントとテクニック 5.1 Workstation Pro ライセンスキーを入力する 5.1.1 ターミナルから 5.1.2 GUI から 5.2 VMware BIOS を展開する 5.3 インストーラーを抽出する 5.3.1 改造 BIOS を使う 5.4 Intel と Optimus で 3D グラフィックを有効化 5.5 ホストが一時停止/休止状態になる前に仮想マシンを一時停止する 5.6 システム高速化のトリック 5.6.1 transparent hugepages を無効にする 5.6.2 直接 RAM アクセスを保証する 5.7 パフォーマンス向上のヒント 5.7.1 準仮想化 SCSI アダプター 5.7.2 準仮想ネットワークアダプター 5.7.3 仮想マシンの設定\n- 6 トラブルシューティング 6.1 Kernel headers for version 4.x-xxxx were not found. If you installed them[...] 6.2 USB デバイスが認識されない 6.3 VMware にリモートでアクセスしようとすると Incorrect login/password エラー 6.4 ALSA 出力の問題 6.5 カーネルベースの仮想マシン (KVM) が実行されている 6.6 モジュールの問題 6.6.1 /dev/vmmon not found 6.6.2 /dev/vmci not found 6.7 インストーラーが起動しない 6.7.1 User interface initialization failed 6.8 ゲストで VMware Tools がダウンロードできない 6.9 Intel のマイクロコードが古いせいで起動時にセグメンテーション違反が発生する 6.10 時刻がおかしくなったり \"[...]timeTracker_user.c:234 bugNr=148722\" というエラーで VMware が起動しない 6.11 システムを再起動した後にゲストのネットワークが使えなくなる 6.12 Linux 4.9 でカーネルモジュールのビルドに失敗する 6.13 バージョン 12.5.4 から vmplayer/vmware の起動に失敗する 6.14 バージョン 12.5.3 で vmplayer/vmware が起動できない 6.15 vmware 12 のプロセスが起動後にすぐ終了し、GUI が起動しない 6.16 カーネル 4.11 以上で vmware モジュールのビルドに失敗する\n- 7 アンインストール\n\n- 2.1 VMware bundle\n- 2.2 Package build for x86_64\n\n- 3.1 カーネルモジュール\n- 3.2 systemd サービス 3.2.1 Workstation Server サービス\n\n- 3.2.1 Workstation Server サービス\n\n- 5.1 Workstation Pro ライセンスキーを入力する 5.1.1 ターミナルから 5.1.2 GUI から\n- 5.2 VMware BIOS を展開する\n- 5.3 インストーラーを抽出する 5.3.1 改造 BIOS を使う\n- 5.4 Intel と Optimus で 3D グラフィックを有効化\n- 5.5 ホストが一時停止/休止状態になる前に仮想マシンを一時停止する\n- 5.6 システム高速化のトリック 5.6.1 transparent hugepages を無効にする 5.6.2 直接 RAM アクセスを保証する\n- 5.7 パフォーマンス向上のヒント 5.7.1 準仮想化 SCSI アダプター 5.7.2 準仮想ネットワークアダプター 5.7.3 仮想マシンの設定\n\n- 5.1.1 ターミナルから\n- 5.1.2 GUI から\n\n- 5.3.1 改造 BIOS を使う\n\n- 5.6.1 transparent hugepages を無効にする\n- 5.6.2 直接 RAM アクセスを保証する\n\n- 5.7.1 準仮想化 SCSI アダプター\n- 5.7.2 準仮想ネットワークアダプター\n- 5.7.3 仮想マシンの設定\n\n- 6.1 Kernel headers for version 4.x-xxxx were not found. If you installed them[...]\n- 6.2 USB デバイスが認識されない\n- 6.3 VMware にリモートでアクセスしようとすると Incorrect login/password エラー\n- 6.4 ALSA 出力の問題\n- 6.5 カーネルベースの仮想マシン (KVM) が実行されている\n- 6.6 モジュールの問題 6.6.1 /dev/vmmon not found 6.6.2 /dev/vmci not found\n- 6.7 インストーラーが起動しない 6.7.1 User interface initialization failed\n- 6.8 ゲストで VMware Tools がダウンロードできない\n- 6.9 Intel のマイクロコードが古いせいで起動時にセグメンテーション違反が発生する\n- 6.10 時刻がおかしくなったり \"[...]timeTracker_user.c:234 bugNr=148722\" というエラーで VMware が起動しない\n- 6.11 システムを再起動した後にゲストのネットワークが使えなくなる\n- 6.12 Linux 4.9 でカーネルモジュールのビルドに失敗する\n- 6.13 バージョン 12.5.4 から vmplayer/vmware の起動に失敗する\n- 6.14 バージョン 12.5.3 で vmplayer/vmware が起動できない\n- 6.15 vmware 12 のプロセスが起動後にすぐ終了し、GUI が起動しない\n- 6.16 カーネル 4.11 以上で vmware モジュールのビルドに失敗する\n\n- 6.6.1 /dev/vmmon not found\n- 6.6.2 /dev/vmci not found\n\n- 6.7.1 User interface initialization failed\n\n"
    },
    {
      "title": "前提条件",
      "level": 2,
      "content": "1. マシンの BIOS/UEFI で仮想化を有効にする。\n\n"
    },
    {
      "title": "インストール",
      "level": 2,
      "content": "VMware Bundle または vmware-workstationAUR パッケージを使用してインストールします。 x86_64で VMware Workstation を使用する場合は、後者が優先されます。\n\n"
    },
    {
      "title": "VMware bundle",
      "level": 3,
      "content": "適切な依存パッケージをインストールしてください:\n\n- fuse2 - vmware-vmblock-fuse 用\n- gtkmm - GUI 用\n- linux-headers - モジュールコンパイル用\n- ncurses5-compat-libsAUR - --console インストーラーを動かすのに必要\n- libcanberra - イベントサウンド用\n- pcsclite\n\n最新の VMware Workstation Pro または Player をダウンロードしてください (若しくは、可能であれば ベータ バージョン)。\n\nインストールを開始してください:\n\n```\n# sh VMware-<edition>-<version>.<release>.<architecture>.bundle\n```\n\n- --eulas-agreed - EULA をスキップ。\n- --console - コンソール UI を使います。\n- --custom - インストールディレクトリを /usr/local などに変更できます (変更した場合は systemd サービスの vmware-usbarbitrator.service 内のパスも更新してください)。\n- -I, --ignore-errors - 致命的なエラーを無視します。\n- --set-setting=vmware-workstation serialNumber XXXXX-XXXXX-XXXXX-XXXXX-XXXXX - インストールのシリアル番号を設定 (スクリプトでインストールするときに有用)。\n- --required - 必須の質問だけを表示 (--eulas-agreed や --console と組み合わせることでサイレントインストールできます)。\n\nSystem service scripts directory には、 /etc/init.d を使って下さい (デフォルト)。\n\n```\n# vmware-modconfig --console --install-all\n```\n\n"
    },
    {
      "title": "Package build for x86_64",
      "level": 3,
      "content": "VMware Workstation のバージョン 16、15、14、12、11 に対応する vmware-workstationAUR, vmware-workstation15AUR, vmware-workstation14AUR, vmware-workstation12AUR または vmware-workstation11AUR をインストールします。また、linux-headers や linux-lts-headers など、インストールしたカーネルに適したヘッダーパッケージをインストールする必要があります。\n\n次に、必要に応じて以下のサービスを有効にします:\n\n- vmware-networks.service ゲストネットワークへのアクセス\n- vmware-usbarbitrator.service USB デバイスへの接続\n- vmware-hostd.service 仮想マシンを共有するためのサービス(バージョン16以降は利用できません)\n\n最後に、VMware モジュールをロードします:\n\n```\n# modprobe -a vmw_vmci vmmon\n```\n\n"
    },
    {
      "title": "カーネルモジュール",
      "level": 3,
      "content": "VMware Workstation 12.5 はバージョン 4.8 までのカーネルをサポートしています。\n\n"
    },
    {
      "title": "systemd サービス",
      "level": 3,
      "content": "(任意) /etc/init.d/vmware (start|stop|status|restart) と /usr/bin/vmware-usbarbitrator を使って直接サービスを管理するのではなく、.service ファイルを使用することもできます (AUR の vmware-systemd-servicesAUR[リンク切れ: パッケージが存在しません] から取得することも可能、vmware-patchAUR[リンク切れ: パッケージが存在しません] にも入っています):\n\n```\n/etc/systemd/system/vmware.service\n```\n\n```\n[Unit]\nDescription=VMware daemon\nRequires=vmware-usbarbitrator.service\nBefore=vmware-usbarbitrator.service\nAfter=network.target\n\n[Service]\nExecStart=/etc/init.d/vmware start\nExecStop=/etc/init.d/vmware stop\nPIDFile=/var/lock/subsys/vmware\nRemainAfterExit=yes\n\n[Install]\nWantedBy=multi-user.target\n```\n\n```\n/etc/systemd/system/vmware-usbarbitrator.service\n```\n\n```\n[Unit]\nDescription=VMware USB Arbitrator\nRequires=vmware.service\nAfter=vmware.service\n\n[Service]\nExecStart=/usr/bin/vmware-usbarbitrator\nExecStop=/usr/bin/vmware-usbarbitrator --kill\nRemainAfterExit=yes\n\n[Install]\nWantedBy=multi-user.target\n```\n\n他の Workstation サーバーコンソールから VMware Workstation に接続したい場合、以下のサービスも追加してください:\n\n```\n/etc/systemd/system/vmware-workstation-server.service\n```\n\n```\n[Unit]\nDescription=VMware Workstation Server\nRequires=vmware.service\nAfter=vmware.service\n\n[Service]\nExecStart=/etc/init.d/vmware-workstation-server start\nExecStop=/etc/init.d/vmware-workstation-server stop\nPIDFile=/var/lock/subsys/vmware-workstation-server\nRemainAfterExit=yes\n\n[Install]\nWantedBy=multi-user.target\n```\n\n作成したら有効化することでブート時に起動できます。\n\n"
    },
    {
      "title": "Workstation Server サービス",
      "level": 4,
      "content": "vmware-workstation-server.service はコマンドチェインで wssc-adminTool を実行しますが、このバイナリファイルの名前は vmware-wssc-adminTool に変更されています。\n\nサービスが起動するのを防ぐには、以下のようにシンボリックリンクを作成してください:\n\n```\n# ln -s wssc-adminTool /usr/lib/vmware/bin/vmware-wssc-adminTool\n```\n\n"
    },
    {
      "title": "アプリケーションを起動する",
      "level": 2,
      "content": "VMware Workstation Pro を開くには:\n\n```\n$ vmware\n```\n\nVMware Player の場合:\n\n```\n$ vmplayer\n```\n\n"
    },
    {
      "title": "ターミナルから",
      "level": 4,
      "content": "```\n# /usr/lib/vmware/bin/vmware-vmx-debug --new-sn XXXXX-XXXXX-XXXXX-XXXXX-XXXXX\n```\n\nXXXXX-XXXXX-XXXXX-XXXXX-XXXXX はあなたのライセンスキーに置き換えてください。\n\n"
    },
    {
      "title": "GUI から",
      "level": 4,
      "content": "上記で上手くいかない場合は、次を試すことができます:\n\n```\n# /usr/lib/vmware/bin/vmware-enter-serial\n```\n\n"
    },
    {
      "title": "VMware BIOS を展開する",
      "level": 3,
      "content": "```\n$ objcopy /usr/lib/vmware/bin/vmware-vmx -O binary -j bios440 --set-section-flags bios440=a bios440.rom.Z\n$ perl -e 'use Compress::Zlib; my $v; read STDIN, $v, '$(stat -c%s \"./bios440.rom.Z\")'; $v = uncompress($v); print $v;' < bios440.rom.Z > bios440.rom\n```\n\n"
    },
    {
      "title": "インストーラーを抽出する",
      "level": 3,
      "content": "インストーラー .bundle の中身を確認するには:\n\n```\n$ sh VMware-edition-version.release.architecture.bundle --extract /tmp/vmware-bundle/\n```\n\n"
    },
    {
      "title": "改造 BIOS を使う",
      "level": 4,
      "content": "展開した BIOS に変更を加えるとき、あなたの仮想マシンがその BIOS を使うようにするには BIOS を ~/vmware/<Virtual machine name> に移動して:\n\n```\n$ mv bios440.rom ~/vmware/<Virtual machine name>/\n```\n\nファイルの名前を <Virtual machine name>.vmx ファイルに追記してください:\n\n```\n~/vmware/<Virtual machine name>/<Virtual machine name>.vmx\n```\n\n```\nbios440.filename = \"bios440.rom\"\n```\n\n"
    },
    {
      "title": "Intel と Optimus で 3D グラフィックを有効化",
      "level": 3,
      "content": "3D アクセラレーションが不安定なグラフィックドライバーはデフォルトでブラックリストに入れられています。Accelerate 3D graphics を有効化すると、ログに以下のように表示されることがあります:\n\n```\nDisabling 3D on this host due to presence of Mesa DRI driver.  Set mks.gl.allowBlacklistedDrivers = TRUE to override.\n```\n\nその場合、以下のように設定してください:\n\n```\n~/.vmware/preferences\n```\n\n```\nmks.gl.allowBlacklistedDrivers = TRUE\n```\n\n"
    },
    {
      "title": "ホストが一時停止/休止状態になる前に仮想マシンを一時停止する",
      "level": 3,
      "content": "実行可能ファイル /usr/lib/systemd/system-sleep/vmware_suspend_all.sh を作成します。\n\n```\n#! /bin/bash\n\nset -eu\n\nif [[ $# -ne 2 ]]; then\n    echo \"Usage: $0 <period> <action>\"\n    exit 1\nfi\n\nperiod=$1\naction=$2\n\necho \"vmware system-sleep hook argv: ${period} ${action}\"\n\nif ! command -v vmrun &>/dev/null; then\n    echo \"command not found: vmrun\"\nfi\n\nif [[ \"${period}\" = \"pre\" ]]; then\n    readarray -t vms < <(vmrun list | tail -n +2)\n\n    echo \"Number of running VMs: ${#vms[@]}\"\n\n    if [[ ${#vms[@]} -eq 0 ]]; then\n        exit\n    fi\n\n    for vm in \"${vms[@]}\"; do\n        echo -n \"Suspending ${vm}... \"\n        vmrun suspend \"${vm}\"\n        echo \"done\"\n    done\n\n    sleep 1\nelse\n    echo \"Nothing to do\"\nfi\n```\n\n参照 電源管理#/usr/lib/systemd/system-sleep のフック, suspend all virtual machines with vmrun と Support for hibernation\n\n"
    },
    {
      "title": "システム高速化のトリック",
      "level": 3,
      "content": "こちらを参照 パフォーマンスの最大化\n\n"
    },
    {
      "title": "transparent hugepages を無効にする",
      "level": 4,
      "content": "VM の実行中にゲストやホストが頻繁にフリーズすることに気付いた場合は、transparent hugepages を無効にすることをお勧めします。現在のセッションでそれらを無効にするには、(ホスト上で) 次を実行します。\n\n```\n# echo never > /sys/kernel/mm/transparent_hugepage/enabled\n```\n\n変更をブート後も永続化するには、カーネルパラメータ transparent_hugepage=never を追加します。\n\nnever の代わりに madvise を使用して、transparent hugepage 用に最適化されたアプリケーションがパフォーマンス上の利点を得られるようにすることもできます hugepages/ これは、上記と同じことを vmware に対して行います。\n\n"
    },
    {
      "title": "直接 RAM アクセスを保証する",
      "level": 4,
      "content": "デフォルトでは、VMware は実行中のゲストシステムの RAM をディスク上のファイルに書き込みます。予備のメモリが十分にあることが確実な場合は、VM の .vmx に以下を追加することで、ゲスト OS がそのメモリをホストの RAM に直接書き込むようにすることができます。\n\n```\nVirtual_machine_name.vmx\n```\n\n```\nMemTrimRate = \"0\"\nsched.mem.pshare.enable = \"FALSE\"\nprefvmx.useRecommendedLockedMemSize = \"TRUE\"\nmainmem.backing = \"swap\"\n```\n\n"
    },
    {
      "title": "パフォーマンス向上のヒント",
      "level": 3,
      "content": "仮想マシンのパフォーマンスを向上させるには、次のヒントを試してください。\n\n"
    },
    {
      "title": "準仮想化 SCSI アダプター",
      "level": 4,
      "content": "VMware Paravirtual SCSI (PVSCSI) アダプター は、VMware ESXi 用の高性能ストレージアダプターであり、スループットが向上し、CPU 使用率が低下します。PVSCSI アダプターは、ハードウェアまたはアプリケーションが非常に大量の I/O スループットを駆動する環境に最適です。\n\nSCSI アダプタータイプ VMware Paravirtual は、仮想マシンの設定で使用できます。\n\nこれらの設定が仮想マシンの構成に含まれていない場合でも、準仮想化 SCSI アダプターを有効にすることができます。mkinitcpio.conf を変更して、準仮想化 SCSI アダプターがカーネルイメージに含まれていることを確認します。\n\n```\n/etc/mkinitcpio.conf\n```\n\n```\n...\nMODULES=(... vmw_pvscsi)\n...\n```\n\n[[mkinitcpio#イメージ作成とアクティベーション|initramfs を再生成します]\n\n仮想マシンをシャットダウンし、SCSI アダプターを変更します。.vmx を次のように設定します。\n\n```\nscsi0.virtualDev = \"pvscsi\"\n```\n\n"
    },
    {
      "title": "準仮想ネットワークアダプター",
      "level": 4,
      "content": "VMware では、ゲスト OS 用に 複数のネットワークアダプター を提供しています。通常、使用されるデフォルトのアダプターは e1000 アダプターで、Intel 82545EM ギガビット イーサネット NIC をエミュレートします。この Intel アダプターは、Arch を含むほとんどのオペレーティング システムの組み込みドライバーと一般的に互換性があります。\n\nより多くのパフォーマンスと追加機能 (マルチキューサポートなど) については、VMware ネイティブ vmxnet3 ネットワークアダプターを使用できます。\n\nArch には、デフォルトのインストールで利用可能な vmxnet3 カーネルモジュールがあります。mkinitcpio で有効にしたら (または自動検出された場合は、lsmod | grep vmxnet3 を実行してロードされているかどうかを確認します)、シャットダウンしてネットワークアダプターの種類を変更します。.vmx ファイルを次のように変更します。\n\n```\nethernet0.virtualDev = \"vmxnet3\"\n```\n\nネットワークアダプターを変更した後、新しいアダプタ名と MAC アドレスを使用するには、ネットワークと dhcpcd 設定を更新する必要があります。\n\n```\n# dhcpcd new_interface_name\n# systemctl enable dhcpcd@new_interface_name.service\n```\n\nip link を実行すると、新しいインターフェイス名を取得できます。\n\n"
    },
    {
      "title": "仮想マシンの設定",
      "level": 4,
      "content": "これらの設定は、より多くのホストメモリを使用することを犠牲にして、ディスク I/O を減らすことによって仮想マシンの応答性を改善するのに役立ちます。 VMware の KB1008885 は、次の最適化を提供します。\n\n```\nmainMem.useNamedFile = \"FALSE\"\nMemTrimRate = \"0\"\nprefvmx.useRecommendedLockedMemSize = \"TRUE\"\nMemAllowAutoScaleDown = \"FALSE\"\nsched.mem.pshare.enable = \"FALSE\"\n```\n\n- mainMem.useNamedFile: これは Windows ホストでのみ機能し、このパラメータは、仮想マシンのシャットダウン時にディスクアクティビティが高い場合に使用できます。これにより、VMware は .vmem ファイルを作成できなくなります。代わりに、Linux ホストではmainmem.backing = \"swap\" を使用してください。\n- MemTrimRate: この設定により、ゲストによって解放されたメモリがホストでも解放されるのを防ぎます。\n- prefvmx.useRecommendedLockedMemSize: 残念ながら、この設定に関する適切な説明はないようです。ホストシステムがゲストメモリの一部をスワップするのを妨げているようです。\n- MemAllowAutoScaleDown: 十分なメモリを割り当てることができない場合、VMware が仮想マシンのメモリサイズを調整できないようにします。\n- sched.mem.pshare.enable: 複数の仮想マシンが同時に実行されている場合、VMware は同一のページを見つけて仮想マシン間で共有しようとします。これは、非常に I/O 集中型になる可能性があります。\n\n次の設定は、VMware Workstation の構成ダイアログ (編集 -> 設定... -> メモリ/優先度) でも設定できます。\n\n```\nprefvmx.minVmMemPct = \"100\"\nmainMem.partialLazySave = \"FALSE\"\nmainMem.partialLazyRestore = \"FALSE\"\n```\n\n- prefvmx.minVmMemPct: ホストシステム上の仮想マシンによって予約される RAM の量をパーセントで設定します。これを低い値に設定すると、ホストシステムで使用可能なメモリよりも多くのメモリを仮想マシンに割り当てることができます。ただし、この場合、ハードドライブの過剰使用につながる可能性が高いため、注意してください。ホストシステムに十分な RAM がある場合、この値は 100 のままにしておく必要があります。\n- mainMem.partialLazySave and mainMem.partialLazyRestore: これら 2 つのパラメーターは、仮想マシンがサスペンド用の部分的なスナップショットを作成するのを防ぎます。これらのパラメータを使用すると、仮想マシンの一時停止にかかる時間がわずかに長くなりますが、この情報を保存しようとする VMware からのハードディスク アクティビティは少なくなるはずです。\n\n"
    },
    {
      "title": "Kernel headers for version 4.x-xxxx were not found. If you installed them[...]",
      "level": 3,
      "content": "ヘッダーをインストールしてください (linux-headers)。\n\n"
    },
    {
      "title": "USB デバイスが認識されない",
      "level": 3,
      "content": "systemd サービスを使ってサービスを自動的に管理しない場合、毎回手動で root を使って vmware-usbarbitrator バイナリを起動する必要があります。\n\n起動するには:\n\n```\n# vmware-usbarbitrator\n```\n\n停止するには:\n\n```\n# vmware-usbarbitrator --kill\n```\n\n"
    },
    {
      "title": "VMware にリモートでアクセスしようとすると Incorrect login/password エラー",
      "level": 3,
      "content": "VMware Workstation には vmware-workstation-server サービスによって共有 VM をリモートで管理できる機能があります。しかしながら、vmware-authd サービスの PAM 設定が間違っているために、\"incorrect username/password\" エラーで失敗します。修正するには、以下のように /etc/pam.d/vmware-authd を編集して:\n\n```\n/etc/pam.d/vmware-authd\n```\n\n```\n#%PAM-1.0\nauth     required       pam_unix.so\naccount  required       pam_unix.so\npassword required       pam_permit.so\nsession  required       pam_unix.so\n```\n\nvmware の systemd サービスを再起動してください。\n\nこれでインストールで作られた証明書を使ってサーバーにアクセスできるはずです。\n\n"
    },
    {
      "title": "ALSA 出力の問題",
      "level": 3,
      "content": "音質や HD 音声出力が有効にできない問題を修正するには、まず以下を実行 [1]:\n\n```\n$ aplay -L\n```\n\nゲストから 5.1 のサラウンド音声を再生したい場合 surround51:CARD=vendor_name,DEV=num を、音質に問題がある場合は front:CARD=vendor_name,DEV=num を確認して、.vmx に名前を記述してください:\n\n```\n~/vmware/Virtual_machine_name/Virtual_machine_name.vmx\n```\n\n```\nsound.fileName=\"surround51:CARD=Live,DEV=0\"\nsound.autodetect=\"FALSE\"\n```\n\nOSS エミュレーションを使っている場合、無効化してください。\n\n"
    },
    {
      "title": "カーネルベースの仮想マシン (KVM) が実行されている",
      "level": 3,
      "content": "起動時に KVM を無効にするために、以下のようなファイルを使うことができます:\n\n```\n/etc/modprobe.d/vmware.conf\n```\n\n```\nblacklist kvm\nblacklist kvm-amd   # For AMD CPUs\nblacklist kvm-intel # For Intel CPUs\n```\n\n"
    },
    {
      "title": "/dev/vmmon not found",
      "level": 4,
      "content": "エラーの全文は:\n\n```\nCould not open /dev/vmmon: No such file or directory.\nPlease make sure that the kernel module `vmmon' is loaded.\n```\n\nこれは vmmon VMware サービスが動作していないことを意味しています。#Systemd サービスの systemd サービスを使っている場合は（再）起動してください。\n\n"
    },
    {
      "title": "/dev/vmci not found",
      "level": 4,
      "content": "エラーの全文は:\n\n```\nFailed to open device \"/dev/vmci\": No such file or directory\nPlease make sure that the kernel module 'vmci' is loaded.\n```\n\n以下のコマンドを実行して VMware のカーネルモジュールを再コンパイルしてみてください:\n\n```\n# vmware-modconfig --console --install-all\n```\n\n"
    },
    {
      "title": "インストーラーが起動しない",
      "level": 3,
      "content": ".bundle を開くとプロンプトに戻ってしまう場合、おそらく VMware インストーラーの古いバージョンまたは壊れたバージョンが存在しています。削除してください (この記事のアンインストールセクションも参照してください):\n\n```\n# rm -r /etc/vmware-installer/\n```\n\n"
    },
    {
      "title": "User interface initialization failed",
      "level": 4,
      "content": "以下のようなエラーが表示される場合もあります:\n\n```\nExtracting VMware Installer...done.\n No protocol specified\n No protocol specified\n User interface initialization failed.  Exiting.  Check the log for details.\n```\n\nncurses5-compat-libsAUR をインストールするか、一時的に X に root でアクセスできるようにすることで解決します:\n\n```\n$ xhost +\n $ sudo ./<vmware filename>.bundle\n $ xhost -\n```\n\n"
    },
    {
      "title": "ゲストで VMware Tools がダウンロードできない",
      "level": 3,
      "content": "ツールを手動でダウンロードするには VMware リポジトリ を訪れてください。\n\n\"application name / version / build ID / linux / packages/\" まで移動して適切な Tools をダウンロードします。\n\n展開するには次を実行:\n\n```\n$ tar -xvf vmware-tools-name-version-buildID.x86_64.component.tar\n```\n\nVMware インストーラーを使ってインストール:\n\n```\n# vmware-installer --install-component=/path/vmware-tools-name-version-buildID.x86_64.component\n```\n\n上記で上手くいかない場合は ncurses5-compat-libsAUR をインストールしてみてください。\n\n"
    },
    {
      "title": "Intel のマイクロコードが古いせいで起動時にセグメンテーション違反が発生する",
      "level": 3,
      "content": "Intel のマイクロコードが最新でないと起動時に以下のようなセグメンテーション違反が発生することがあります:\n\n```\n/usr/bin/vmware: line 31: 4941 Segmentation fault \"$BINDIR\"/vmware-modconfig --appname=\"VMware Workstation\" --icon=\"vmware-workstation\"\n```\n\nマイクロコードを参照してアップデートしてください。\n\n"
    },
    {
      "title": "時刻がおかしくなったり \"[...]timeTracker_user.c:234 bugNr=148722\" というエラーで VMware が起動しない",
      "level": 3,
      "content": "VMware Linux における電源管理機能 (Intel SpeedStep や AMD PowerNow!/Cool'n'Quiet) のサポートが 不完全 で CPU 周波数が変化するのが原因です。2012年3月、linux 3.3-1 のリリースによって、最大周波数の Performance ガバナーは動的な Ondemand によって置き換わりました。ホストの CPU 周波数が変化すると、ゲストのシステムクロックが早すぎたり遅すぎたりするようになり、ゲストが全く起動できなくなることもあります。\n\nこの問題を解決するには、全体設定で、ホストで最大 CPU 周波数を指定して、Time Stamp Counter (TSC) を無効化します:\n\n```\n/etc/vmware/config\n```\n\n```\nhost.cpukHz = \"X\"  # The maximum speed in KHz, e.g. 3GHz is \"3000000\".\nhost.noTSC = \"TRUE\" # Keep the Guest system clock accurate even when\nptsc.noTSC = \"TRUE\" # the time stamp counter (TSC) is slow.\n```\n\n"
    },
    {
      "title": "システムを再起動した後にゲストのネットワークが使えなくなる",
      "level": 3,
      "content": "おそらく vmnet モジュールがロードされていないのが原因です [2]。自動ロードする方法は #systemd サービスセクションを参照してください。\n\n"
    },
    {
      "title": "Linux 4.9 でカーネルモジュールのビルドに失敗する",
      "level": 3,
      "content": "VMware Workstation Pro 12.5.2 現在、コンパイルを通すにはモジュールのソースに修正が必要です [3]:\n\n```\n# cd /usr/lib/vmware/modules/source\n# tar xf vmmon.tar\n# mv vmmon.tar vmmon.old.tar\n# sed -i 's/uvAddr, numPages, 0, 0/uvAddr, numPages, 0/g' vmmon-only/linux/hostif.c\n# tar cf vmmon.tar vmmon-only\n# rm -r vmmon-only\n```\n\n```\n# tar xf vmnet.tar\n# mv vmnet.tar vmnet.old.tar\n# sed -i 's/addr, 1, 1, 0/addr, 1, 0/g' vmnet-only/userif.c\n# tar cf vmnet.tar vmnet-only\n# rm -r vmnet-only\n```\n\n"
    },
    {
      "title": "バージョン 12.5.4 から vmplayer/vmware の起動に失敗する",
      "level": 3,
      "content": "フォーラムスレッド によれば、libpng パッケージをバージョン 1.6.28-1 にダウングレードすることで一時的に解決できます。ダウングレードしたら /etc/pacman.conf の IgnorePkg パラメータにパッケージを追加してください。\n\nもしくは、以下のコマンドを実行することで VMWare がシステムの zlib を使うようになります:\n\n```\n# cd /usr/lib/vmware/lib/libz.so.1\n# mv libz.so.1 libz.so.1.old\n# ln -s /usr/lib/libz.so.1 .\n```\n\n"
    },
    {
      "title": "バージョン 12.5.3 で vmplayer/vmware が起動できない",
      "level": 3,
      "content": "この問題は /usr/lib/vmware/lib/libstdc++.so.6/libstdc++.so.6 で CXXABI_1.3.8 が抜けていることが原因です。\n\ngcc-libs か gcc-libs-multilib[リンク切れ: 置換パッケージ: gcc-libs] がインストールされているのであればライブラリは既にインストールされています。ファイルを削除することで vmplayer は gcc-libs のライブラリを使うようになります。root で以下のコマンドを実行してください:\n\n```\n# mv /usr/lib/vmware/lib/libstdc++.so.6/libstdc++.so.6 /usr/lib/vmware/lib/libstdc++.so.6/libstdc++.so.6.bak\n```\n\nまた、以下のコマンドで一時的に対処することもできます:\n\n```\n# export VMWARE_USE_SHIPPED_LIBS='yes'\n```\n\n"
    },
    {
      "title": "vmware 12 のプロセスが起動後にすぐ終了し、GUI が起動しない",
      "level": 3,
      "content": "Mageia にバグが報告されていますが、Arch ではターミナルにエラーメッセージが表示されません。/tmp/vmware-<id> のログを見ると VMWARE_SHIPPED_LIBS_LIST is not set, VMWARE_SYSTEM_LIBS_LIST is not set, VMWARE_USE_SHIPPED_LIBS is not set, VMWARE_USE_SYSTEM_LIBS is not set が確認できます。プロセスは Unable to execute /usr/lib/vmware/bin/vmware-modconfig で終了しています。解決するには root で以下のコマンドを実行してください:\n\n```\n# mv /etc/vmware/icu/icudt44l.dat /etc/vmware/icu/icudt44l.dat.bak\n```\n\nもしくは以下のコマンドでも一時的に回避できます:\n\n```\n$ export VMWARE_USE_SHIPPED_LIBS='yes'\n```\n\n"
    },
    {
      "title": "カーネル 4.11 以上で vmware モジュールのビルドに失敗する",
      "level": 3,
      "content": "vmware-modconfig を実行すると以下のように表示される場合:\n\n```\nFailed to get gcc information.\n```\n\nログで実際のエラーを確認できます:\n\n```\nmodconfig| I125: Got gcc version \"6.3.1\".\nmodconfig| I125: GCC major version 6 does not match Kernel GCC major version 7.\nmodconfig| I125: The GCC compiler \"/sbin/gcc\" cannot be used for the target kernel.\n```\n\nチェックをスキップするには、以下のコマンドを実行してください:\n\n```\n# sed 's/gcc version 7/gcc version 6/' /proc/version > /tmp/version\n# mount --bind /tmp/version /proc/version\n# vmware-modconfig --console --install-all\n# umount /proc/version && rm /tmp/version\n```\n\n"
    },
    {
      "title": "アンインストール",
      "level": 2,
      "content": "VMware をアンインストールするには製品名が必要です (vmware-workstation または vmware-player)。インストールされている製品を全て表示するには:\n\n```\n$ vmware-installer -l\n```\n\n次のコマンドでアンインストールしてください (--required で確認をスキップできます):\n\n```\n# vmware-installer -u <product> --required\n```\n\nvmware サービスを無効にして削除するのも忘れないで下さい:\n\n```\n# rm /etc/systemd/system/vmware.service\n# rm /etc/systemd/system/vmware-usbarbitrator.service\n```\n\n/usr/lib/modules/<kernel name>/misc/ のモジュールディレクトリにも何か残っていないか確認すると良いでしょう。\n\n"
    }
  ]
}