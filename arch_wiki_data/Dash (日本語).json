{
  "title": "Dash (日本語)",
  "url": "https://wiki.archlinux.org/title/Dash_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- コマンドラインシェル\n- Bash\n\nDash (Debian Almquist shell) は近代的な POSIX 互換の /bin/sh (sh, Bourne shell) の実装です。\n\nDash は Bash 互換ではありませんが、Bash は POSIX とほぼ互換であるようにしているため、Dash も互換性があります。\n\nDash が優れている点は次の通りです。\n\n- 実行速度が速い。Bash などのシェルに比べて 4倍高速 に動作します。\n- 使用するリソースが少ない (ディスク容量, RAM, CPU)。Bash などよりもずっと小さくコンパクトです (インストール容量は Bash の 6.5 MB に比べて 134.1 kB で、ソースコードの行数は 176 kSLOC に対して 13 kSLOC です)\n- セキュリティが高い。古くに開始されたプロジェクトであり、シンプルながら長い実績があります。そして 多くの開発者 が携わっている 活発に開発されている プロジェクトでもあります。攻撃されるような部位は少なく、コードを見ている目はたくさんあります。\n- 従来の /bin/sh だけを必要とする場合\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 インストール\n- 2 DASH を /bin/sh として使う 2.1 bashism を確認 2.1.1 チェックするべき場所 2.2 /bin/sh の再リンク\n- 3 参照\n\n- 2.1 bashism を確認 2.1.1 チェックするべき場所\n- 2.2 /bin/sh の再リンク\n\n- 2.1.1 チェックするべき場所\n\n"
    },
    {
      "title": "インストール",
      "level": 2,
      "content": "dash パッケージからインストールできます。または dash-static-muslAUR パッケージをインストールしてください。\n\n"
    },
    {
      "title": "DASH を /bin/sh として使う",
      "level": 2,
      "content": "ほとんどの POSIX 互換スクリプトはスクリプトの一番最初の行に /bin/sh を指定しており、/bin/sh がシェルとして動作しますが、Arch ではデフォルトで /bin/bash へのシンボリックリンクになっています。\n\n/bin/sh から /bin/dash にシンボリックリンクを貼り直すことでシステムのパフォーマンスを向上させることができます。ただその前に、明示的に #!/bin/bash を指定してないスクリプトが、ちゃんと POSIX 互換であり Bash の機能を使っていないことを確認する必要があります。\n\n"
    },
    {
      "title": "bashism を確認",
      "level": 3,
      "content": "Dash に含まれていない Bash の機能 ('bashism') は /bin/bash を明示的に指定していないと動作しなくなります。以下の手順に従うことで修正が必要なスクリプトがないか確認することができます。\n\ncheckbashisms パッケージをインストールしてください。\n\n"
    },
    {
      "title": "チェックするべき場所",
      "level": 4,
      "content": "- #!/bin/sh シバンを含む PATH 内のすべてのスクリプト:\n\n```\n$ IFS=:; rdo grep -Irl '#!/bin/sh' $PATH |xargs -r checkbashisms\n```\n\n- pacman -Qlq を使うことで pacman でインストールしたファイルを全て一覧することができます。\n\n"
    },
    {
      "title": "/bin/sh の再リンク",
      "level": 3,
      "content": "機能が破壊されないことを確認できたら、/bin/sh のリンクを変更しても安全なはずです。再リンクを行うには次のコマンドを使用:\n\n```\n# ln -sfT dash /usr/bin/sh\n```\n\nBash がアップデートされるとデフォルトのシンボリックリンクで /bin/sh が上書きされます。上書きされないようにするには、以下の pacman フックを使って、アップデート後に /bin/sh のリンクを再度作成するようにしてください:\n\n```\n[Trigger]\nType = Package\nOperation = Install\nOperation = Upgrade\nTarget = bash\n\n[Action]\nDescription = Re-pointing /bin/sh symlink to dash...\nWhen = PostTransaction\nExec = /usr/bin/ln -sfT dash /usr/bin/sh\nDepends = dash\n```\n\nこのフックは dashbinshAUR でもインストールできます。\n\n"
    },
    {
      "title": "参照",
      "level": 2,
      "content": "- https://mailman.archlinux.org/pipermail/arch-dev-public/2007-November/003053.html\n- https://launchpad.net/ubuntu/+spec/dash-as-bin-sh\n- https://wiki.ubuntu.com/DashAsBinSh\n\n"
    }
  ]
}