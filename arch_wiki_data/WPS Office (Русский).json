{
  "title": "WPS Office (Русский)",
  "url": "https://wiki.archlinux.org/title/WPS_Office_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "WPS Office for Linux – это проприетарная альтернатива Microsoft Office с современным интерфейсом, который поддерживает обмен файлами между устройствами и облачные сохранения. Оно же включает Writer, Presentation и Spreadsheets.\n\n"
    },
    {
      "title": "Установка",
      "level": 2,
      "content": "Установите wps-officeAUR.\n\nШрифты, используемые WPS Office, устанавливаются дополнительным пакетом: ttf-wps-fontsAUR.\n\nПрограммы, входящие в комплект, могут быть запущены с помощью:\n\nTable content:\nКоманда | Программа\nwps | WPS Writer\net | WPS Spreadsheets\nwpp | WPS Presentation\nwpspdf | WPS PDF\n\n"
    },
    {
      "title": "Язык интерфейса",
      "level": 3,
      "content": "Официально WPS Office поддерживает только английский и китайский (wps-office-cnAUR).\n\nНо на некоторых языках есть неофициальные переводы; Вы можете их установить из AUR:\n\n- wps-office-mui-frAUR\n- wps-office-mui-ruAUR\n\nПосле установки выберите язык в Review > Spell Check > Set Language и перезапустите WPS.\n\n"
    },
    {
      "title": "Модифицировать иконку файлов в WPS и его выбор по умолчанию",
      "level": 3,
      "content": "После установки WPS файлы DOC, XLS, PPT и другие файлы в используемой вами теме значков будут заменены текстом WPS, формой ET, презентацией WPP и другими значками, которые поставляются с WPS Office. Если вам это не нужно, вы можете самостоятельно изменить соответствующий конфигурационный файл mime:\n\n```\n/usr/share/mime/packages/wps-office-{wpp,wps,et}.xml\n/usr/share/mime/packages/freedesktop.org.xml #(Входит в комплекте пакета shared-mime-info)\n```\n\nИ ярлык приложения:\n\n```\n/usr/share/applications/wps-office-{wpp,wps,et}.desktop\n```\n\nСтратегия обработки: собственный формат WPS определяется wps-office-{wpp,wps,et}.xml, а другие определяются freedesktop.org.xml. Также измените элемент MimeType файла desktop.\n\nДобавьте следующую инструкцию к функции package в файле PKGBUILD:\n\n```\n##et wpp wps supported MimeType\n    _etMT=\"MimeType=application\\/wps-office.et;application\\/wps-office.ett;application\\/vnd.ms-excel;\\\napplication\\/vnd.openxmlformats-officedocument.spreadsheetml.template;\\\napplication\\/vnd.openxmlformats-officedocument.spreadsheetml.sheet;\"\n    _wppMT=\"MimeType=application\\/wps-office.dps;application\\/wps-office.dpt;application\\/vnd.ms-powerpoint;\\\napplication\\/vnd.openxmlformats-officedocument.presentationml.presentation;\\\napplication\\/vnd.openxmlformats-officedocument.presentationml.slideshow;\\\napplication\\/vnd.openxmlformats-officedocument.presentationml.template;\"\n    _wpsMT=\"MimeType=application\\/wps-office.wps;application\\/wps-office.wpt;\\\napplication\\/msword;application\\/rtf;application\\/msword-template;\\\napplication\\/vnd.openxmlformats-officedocument.wordprocessingml.template;\\\napplication\\/vnd.openxmlformats-officedocument.wordprocessingml.document;\"\n\n    ##mime\n    sed -i '3,31d' $pkgdir/usr/share/mime/packages/wps-office-et.xml\n    sed -i '3,36d' $pkgdir/usr/share/mime/packages/wps-office-wpp.xml\n    sed -i '3,30d' $pkgdir/usr/share/mime/packages/wps-office-wps.xml\n\n    ##desktop\n    #_et\n    sed -i \"s/^MimeType.*$/$_etMT/\" $pkgdir/usr/share/applications/wps-office-et.desktop\n    #_wpp\n    sed -i \"s/^MimeType.*$/$_wppMT/\" $pkgdir/usr/share/applications/wps-office-wpp.desktop\n    #_wps\n    sed -i \"s/^MimeType.*$/$_wpsMT/\" $pkgdir/usr/share/applications/wps-office-wps.desktop\n```\n\n"
    },
    {
      "title": "WPS Office переопределяет или ломает mime",
      "level": 3,
      "content": "Добавьте common\\do_not_detect_file_association_while_startup=true перед [kdcsdk]:\n\n```\n/home/your_user/.config/Kingsoft/Office.conf\n```\n\n```\n[6.0]\n...\ncommon\\do_not_detect_file_association_while_startup=true\n\n[kdcsdk]\n...\n```\n\nЗатем сохраните изменения и перезапустите WPS Office.\n\n"
    },
    {
      "title": "Искажённый сжатый пакет zip-шаблона",
      "level": 3,
      "content": "Используйте параметр -O gb18030 в unzip когда распаковываете.\n\n"
    },
    {
      "title": "Формулы отображаются некорректно",
      "level": 3,
      "content": "Для отображения большинства необходимых математических формул нужны перечисленные ниже шрифты:\n\n```\nsymbol.ttf webdings.ttf wingding.ttf wingdng2.ttf wingdng3.ttf monotypesorts.ttf MTExtra.ttf\n```\n\nttf-wps-fontsAUR содержит все эти шрифты за исключением monotypesorts.ttf, его вы можете установить вручную.\n\n"
    },
    {
      "title": "Форматы Microsoft Office в KDE Plasma определяются как архивы",
      "level": 3,
      "content": "После установки WPS Office файлы Microsoft Office будут распознаны как zip и не смогут быть открыты с помощью WPS. Вы можете удалить проблемный пакет wps-office-mimeAUR.\n\n"
    },
    {
      "title": "WPSPDF не работает",
      "level": 3,
      "content": "Экспорт в PDF, открытие и другие связанные с PDF функции предоставляет решение WPSPDF. В свою очередь, WPSPDF требует libtiff5.so.5 для работы с PDF: установите libtiff5AUR.\n\n"
    },
    {
      "title": "Шрифты слишком жирные",
      "level": 3,
      "content": "В версии 11.1.0.11704-1 не работают правильно шрифты freetype2 версии выше 2.13.0. Обычно freetype2 создаёт свой жирный вариант, если его нет в файле со шрифтом. Это называют \"fakebold\" (Фейковая жирность), но в данном случае wps-office делает тоже свою вариацию, и в результате шрифт становится необычайно жирным.\n\nПока нет официального патча в upstream, можно установить freetype2-wpsAUR.\n\n"
    },
    {
      "title": "Смотрите также",
      "level": 2,
      "content": "- WPS For Linux (Chinese)\n\n"
    }
  ]
}