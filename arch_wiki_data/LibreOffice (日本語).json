{
  "title": "LibreOffice (日本語)",
  "url": "https://wiki.archlinux.org/title/LibreOffice_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- Apache OpenOffice\n\nHome - LibreOffice より:\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 インストール\n- 2 テーマ\n- 3 拡張機能の管理\n- 4 フォント\n- 5 言語補助ツール 5.1 スペルチェック 5.2 双方向サポート 5.3 ハイフネーションルール 5.4 類語辞典 5.5 文法チェック 5.6 英語のオフラインヘルプ\n- 6 ヒントとテクニック 6.1 LibreOffice の高速化 6.2 マクロのインストール 6.3 データベースフロントエンドとしてのベース 6.4 LibreOffice または OpenOffice に基づく自動ドキュメント変換 6.5 通知音\n- 7 トラブルシューティング 7.1 フォントを替える 7.2 アンチエイリアス 7.3 NFSv3 共有を使うとフリーズする 7.4 Java Framework エラーの修正 7.5 LibreOffice が証明書を認識しない 7.6 .pps ファイルを編集モードで実行する(スライドショーを使わない) 7.7 文献目録の作成 7.8 アプリケーションエラー (起動できない) 7.9 保存ボタンを押したときに終了してしまう 7.10 メディアサポート 7.11 Writer や Draw のデフォルトの用紙サイズ 7.12 ダークテーマで LibreOffice のツールバーが読めなくなる 7.13 Breeze/Plasma 5 のダークテーマ LibreOffice のツールバーが読めない 7.14 en_US 以外のシステムロケールで AutoText のデフォルトの挙動が機能しない\n- 8 参照\n\n- 5.1 スペルチェック\n- 5.2 双方向サポート\n- 5.3 ハイフネーションルール\n- 5.4 類語辞典\n- 5.5 文法チェック\n- 5.6 英語のオフラインヘルプ\n\n- 6.1 LibreOffice の高速化\n- 6.2 マクロのインストール\n- 6.3 データベースフロントエンドとしてのベース\n- 6.4 LibreOffice または OpenOffice に基づく自動ドキュメント変換\n- 6.5 通知音\n\n- 7.1 フォントを替える\n- 7.2 アンチエイリアス\n- 7.3 NFSv3 共有を使うとフリーズする\n- 7.4 Java Framework エラーの修正\n- 7.5 LibreOffice が証明書を認識しない\n- 7.6 .pps ファイルを編集モードで実行する(スライドショーを使わない)\n- 7.7 文献目録の作成\n- 7.8 アプリケーションエラー (起動できない)\n- 7.9 保存ボタンを押したときに終了してしまう\n- 7.10 メディアサポート\n- 7.11 Writer や Draw のデフォルトの用紙サイズ\n- 7.12 ダークテーマで LibreOffice のツールバーが読めなくなる\n- 7.13 Breeze/Plasma 5 のダークテーマ LibreOffice のツールバーが読めない\n- 7.14 en_US 以外のシステムロケールで AutoText のデフォルトの挙動が機能しない\n\n"
    },
    {
      "title": "インストール",
      "level": 2,
      "content": "以下のグループのどちらかをインストールしてください:\n\n- libreoffice-still 保守的なユーザー向けの、比較的まれな更新を含む安定したメンテナンスブランチです。\n- libreoffice-fresh ブランチであり、アーリーアダプターまたはパワーユーザー向けの新しいプログラム拡張機能が含まれています。\n\n- 以前は少なくともどれか1つ言語パックをインストールする必要がありました。現在、LibreOffice はシステムのデフォルトを検出するので、言語パックの手動インストールは必須ではなくなっています。詳しくは help.libreoffice.org を見てください。\n- libreoffice-fresh-en-gb の代わりに間違って、libreoffice-fresh-uk (ウクライナ語) や libreoffice-fresh-br (ブルトン語) をインストールしないよう気をつけて下さい。\n- SDK を使いたいときは、libreoffice-fresh-sdk をインストールしてください。\n\npacman が提案する推奨・任意の依存パッケージをチェックしてください。Libreoffice Base を使う必要がない場合は Java 実行環境は不要です: Java を見て下さい。Libreoffice Base の モジュール を使う場合 hsqldb2-java が必要なことがあります。\n\n"
    },
    {
      "title": "テーマ",
      "level": 2,
      "content": "LibreOffice は GTK+ と Qt のテーマの統合をサポートしています。Qt と GTK アプリケーションの外観の統合を見てください。\n\n- Qt の統合では GTK+ のテーマに似せることができます。qtconfig-qt4 コマンドで開くウィンドウでテーマを選んで下さい。\n- それぞれのデスクトップ環境を使っておらず、それらに\"あわせる\"必要がないときでも、パッケージをインストールして libreoffice に gtk や qt のテーマを使わせることは可能です。例えば、e17 の libreoffice はデフォルトで \"ugly\" (別名 \"win95\") テーマを使っていますが、libreoffice-still-gnome をインストールして gtk テーマを選ぶことができます。\n\nLibreOffice バージョン 3.5.x からはデスクトップ UI を自動検知するようになっています。ライブラリを見つける順番は次の通りです:\n\n```\ngtk3 > gtk > kde4 > generic\n```\n\n特定の VCL UI インターフェースを強制するには SAL_USE_VCLPLUGIN=gen, SAL_USE_VCLPLUGIN=kde4, SAL_USE_VCLPLUGIN=gtk, SAL_USE_VCLPLUGIN=gtk3 環境変数のどれかを使ってください。これらの環境変数は /etc/profile.d/libreoffice-fresh.sh や /etc/profile.d/libreoffice-still.sh でアンコメントすることができます。\n\nWindows 98 アイコンが使われてしまっている場合は、メニューの ツール > オプション から LibreOffice > Accessibility を選択して \"Automatically detect high-contrast mode of operating system\" のチェックを外して下さい。\n\nすぐに変更が適用されない場合は、使っているアイコンセットを変える必要があります。オプションダイアログの LibreOffice > View から \"Icon size and style\" の2つのポップアップボックスを使って下さい (二番目のポップアップボックスは \"High-contrast\" 以外のどれかに変更する必要があります)\n\n"
    },
    {
      "title": "拡張機能の管理",
      "level": 2,
      "content": "Arch は以下の追加エクステンションを提供しています:\n\n- libreoffice-extension-texmaths\n- libreoffice-extension-writer2latex\n\n他にも拡張機能をインストールしたい場合は AUR や LibreOffice 内蔵の拡張機能マネージャ、または libreplanet をチェックしてください。\n\n"
    },
    {
      "title": "フォント",
      "level": 2,
      "content": "Document Foundation wiki には、Windows および macOS 上の LibreOffice にデフォルトで含まれているさまざまなフォントが記載されています。Arch では以下のパッケージがインストールされているかもしれません。\n\n- ttf-caladea\n- ttf-carlito\n- ttf-dejavu\n- ttf-gentium-basicAUR\n- ttf-liberation\n- ttf-linux-libertine-g\n- noto-fonts\n- adobe-source-code-pro-fonts\n- adobe-source-sans-fonts\n- adobe-source-serif-fonts\n\nフォント#フォントパッケージも参照してください。\n\n"
    },
    {
      "title": "スペルチェック",
      "level": 3,
      "content": "スペルチェックをするには、hunspell がインストールされている必要があります。LibreOffice の still と fresh 両方のバージョンで動作します。また、hunspell 用の言語辞典が必要です (英語は hunspell-en[リンク切れ: 置換パッケージ: hunspell-en_AU]、ドイツ語は hunspell-de など)。インストールしたら、Tools -> Options -> Language Settings -> Writing Aids -> Hunspell SpellChecker のチェックボックスを選択して有効にしてください。\n\n"
    },
    {
      "title": "双方向サポート",
      "level": 3,
      "content": "Bidi サポートを有効にするには、Tools > Options... > Language Settings > Languages > Default Languages for Documents から 複合テキストレイアウト (CTL) を有効にします。次に、適切な言語を選択します。その後、RCtrl + RShift および LCtrl + LShift によって言語の配置を強制できます。段落スタイルが変更されるとテキストの方向が切り替わる 既知の問題 があります。\n\n"
    },
    {
      "title": "ハイフネーションルール",
      "level": 3,
      "content": "ハイフネーションルールを使うには、hyphen と言語別のハイフンルールセットが必要です (英語は hyphen-en、ドイツ語は hyphen-de など)。\n\n"
    },
    {
      "title": "類語辞典",
      "level": 3,
      "content": "類語辞典オプションを使うには、libmythes と言語別の mythes 類語辞典が必要です (英語は mythes-en、ドイツ語は mythes-de など)。\n\n"
    },
    {
      "title": "文法チェック",
      "level": 3,
      "content": "文法チェックを使いたい場合、複数のツールが利用できます。最もよく使われているツールは LanguageTool です。languagetool パッケージでインストールできますが、LibreOffice の拡張はパッケージになっていません。従って libreoffice-extension-languagetoolAUR パッケージを使ってインストールすることを推奨します。このパッケージには LanguageTool が含まれていますが、languagetool パッケージと衝突はしません。将来的には、languagetool パッケージに依存するようになる可能性があります。\n\nこのパッケージをインストールした後は、Java 8 実行環境 (jre8-openjdk) がインストールされていることを確認してください。Languagetool は Java を使っているので LibreOffice の動作を重くしたりフリーズさせたりすることがあります (特にドキュメントを開いた時)。ただし最初にドキュメントを開くときだけそうなるのであって他の動作では問題ないことが普通です。Java をインストールしたら、LibreOffice でデフォルト環境として有効にすると良いでしょう。\"Tools\" --> \"Options\" --> \"Advanced\" から適切な JRE (1.8.0) を選択して \"Ok\" を押してください。LibreOffice スイートの再起動が必要です。再起動したら Languagetools をインストールできるはずです。\n\n他の文法ツールは LibreOffice Extension Page や LibreOffice Extensions 公式ウェブサイト、OpenOffice のウェブサイト にあります。全ての OpenOffice 拡張が LibreOffice で動くという保証はありません。\n\n"
    },
    {
      "title": "英語のオフラインヘルプ",
      "level": 3,
      "content": "バージョン 5.2.2 現在、libreoffice-fresh には英語のオフラインヘルプファイルが含まれています。他の言語のヘルプファイルは libreoffice の言語パッケージに含まれています (例: libreoffice-fresh-ja)。\n\n"
    },
    {
      "title": "LibreOffice の高速化",
      "level": 3,
      "content": "- 起動ロゴを無効にする: 読み込みの進行状況で起動ロゴ画面を無効にしたい場合は、/etc/libreoffice/sofficerc を開き、Logo= を見つけます。行を選択し、それを Logo=0 に設定します。あるいは、--nologo CLI オプションを使用します。\n- Java ランタイムを無効にする: Java に依存する機能を使用していない場合は、Java ランタイムを無効にすることを検討してください。Tools > Options > LibreOffice > Advanced に移動して Use a Java runtime environment のチェックを外します。\n- オートスペルチェックをオフにする:Tools > Options > Language Settings > Writing Aids uncheck Check spelling as you typeと Check grammar as you type のチェックを外します。\n\n"
    },
    {
      "title": "マクロのインストール",
      "level": 3,
      "content": "マクロを使うには、JRE を有効にする必要があります。JRE はデフォルトで有効になっていますが、無効にすることで Libreoffice を高速化できます\n\nArch Linux での LibreOffie のマクロディレクトリのパスは:\n\n```\n~/.config/.libreoffice/4/user/Scripts/\n```\n\n"
    },
    {
      "title": "データベースフロントエンドとしてのベース",
      "level": 3,
      "content": "Base は、PostgreSQL などのデータベースのフロントエンドとして使用できます。テーブルを編集することはできませんが、テーブルの列と行の非常に優れた概要が得られ、関連するデータの概要をより良く把握するために列を非表示にすることもできます。データをフィルタリングすることもでき、複数の行を選択して削除したり、単一セルを簡単に編集したりできます。\n\nまた、クエリ GUI を使用して SQL クエリを構築することもできます。\n\n"
    },
    {
      "title": "LibreOffice または OpenOffice に基づく自動ドキュメント変換",
      "level": 3,
      "content": "--headless コマンドラインオプションを使用して呼び出すと、libreoffice によってドキュメント変換を直接実行できます。たとえば、.odt を .pdf ファイルに変換するには、次のコマンドを発行します:\n\n```\n$ libreoffice --headless --convert-to pdf ./*.odt\n```\n\nもう 1 つのオプションは、コマンドラインツール unoconv を使用することです。これは、LibreOffice を使用する自動変換およびスタイル設定ツールです。たとえ厳しいものであっても、さらに多くの作業が必要になります [1] が、現状でも非常に便利です。実行中の LibreOffice に接続するか、独自の使用のために LibreOffice を起動するか、その使用のために明示的に起動された実行中のインスタンスに接続します。X サーバーを実行する必要はありません。\n\n"
    },
    {
      "title": "通知音",
      "level": 3,
      "content": "ドキュメントを保存していない状態で LibreOffice を閉じるなどの一部のユーザー操作では、ドキュメントを保存しますか? というメッセージが表示されます。通知音とともにポップアップウィンドウが表示されます。通知サウンドの有効化/無効化は、GTK 設定オプション gtk-enable-event-sounds を変更することで試行できます。GTK#例 を参照してください。\n\n"
    },
    {
      "title": "フォントを替える",
      "level": 3,
      "content": "LibreOffice のオプションから設定を変更できます。ドロップダウンメニューから、ツール > オプション > LibreOffice > フォントの種類 を選んでください。「置換テーブルを使う」のチェックボックスをチェックします。フォントボックスに Andale Sans UI と入力して置換候補から使いたいフォントを選んでください。それができたら、チェックマークをクリックしてください。それから下のボックスで常にと画面のみを選びます。OK をクリックしてください。 それから ツール > オプション > LibreOffice > 表示 と辿り、「ユーザーインターフェースにシステムフォントを使用」のチェックを外す必要があります。Arial など、アンチエイリアスのないフォントを使う場合は、フォントを正しくレンダリングするために「スクリーンフォントの縁を滑らかする」のチェックも外す必要があります。\n\n"
    },
    {
      "title": "アンチエイリアス",
      "level": 3,
      "content": "次を実行してください:\n\n```\n$ echo \"Xft.lcdfilter: lcddefault\" | xrdb -merge\n```\n\n変更を永続するには、~/.Xresources ファイルに Xft.lcdfilter: lcddefault を加えて、$ xrdb -merge ~/.Xresources を実行してください。ソース。詳しくは X resources を見て下さい。\n\nこれが働かない場合、~/.Xdefaults に Xft.lcdfilter: lcddefault を加えることも試してください。このファイルが存在しないときは作る必要があります。\n\n"
    },
    {
      "title": "NFSv3 共有を使うとフリーズする",
      "level": 3,
      "content": "NFSv3 共有にあるドキュメントを開いたり保存したりしようとすると LibreOffice がハングアップする場合、/usr/lib/libreoffice/program/soffice 内の (go-openoffice を使っているなら /usr/bin/soffice) 以下の行の前に # を付けてみて下さい:\n\n```\n# file locking now enabled by default\nSAL_ENABLE_FILE_LOCKING=1\nexport SAL_ENABLE_FILE_LOCKING\n```\n\nアップデートのときに上書きされてしまうのを避けるために /usr/local/bin 内の /usr/lib/libreoffice/program/soffice をコピーしておいてください。\n\n"
    },
    {
      "title": "Java Framework エラーの修正",
      "level": 3,
      "content": "LibreOffice を実行しようとすると次のようなエラーが表示されるかもしれません。\n\n```\n[Java framework] Error in function createSettingsDocument (elements.cxx).\njavaldx failed!\n```\n\nこの場合、~/.config/ の所有者をあなた自身にします:\n\n```\n# chown -vR username:users ~/.config\n```\n\nArch Linux フォーラムの投稿。\n\n"
    },
    {
      "title": "LibreOffice が証明書を認識しない",
      "level": 3,
      "content": "ドキュメントに署名しようとしたときに証明書が見つからない場合、Mozilla Firefox (もしくは Thunderbird) で証明書を設定する必要があります。それでも LibreOffice が証明書を表示しないなら、Mozilla Firefox (もしくは Thunderbird) フォルダを指定する MOZILLA_CERTIFICATE_FOLDER 環境変数を設定してください。\n\n```\nexport MOZILLA_CERTIFICATE_FOLDER=$HOME/.mozilla/firefox/XXXXXX.default/\n```\n\nCertificate Detection。\n\n"
    },
    {
      "title": ".pps ファイルを編集モードで実行する(スライドショーを使わない)",
      "level": 3,
      "content": ".pps ファイルを .ppt に名前を変えるのが唯一の解決策です。\n\n以下のスクリプトを home ディレクトリに追加して .pps ファイルを開くときに使って下さい。メールで受け取った .pps ファイルを(保存しないで)開くときに便利です。\n\n```\n#!/bin/bash\n\nf=$(mktemp)\n\ncp \"$1\" \"${f}.ppt\" && libreoffice \"${f}.ppt\" && rm -f \"${f}.ppt\"\n```\n\n"
    },
    {
      "title": "文献目録の作成",
      "level": 3,
      "content": "文献目録データベースを開こうとすると次のエラーが出て Writer が落ちる場合:\n\n```\ncom::sun::star::loader::CannotActivateFactoryException\n```\n\nlibreoffice-base[リンク切れ: パッケージが存在しません] をインストールしてください。この既知のバグは修正されています。\n\n"
    },
    {
      "title": "アプリケーションエラー (起動できない)",
      "level": 3,
      "content": "Adwaita 以外の GTK テーマを使っていると、LibreOffice が起動できないことがあります:\n\n```\n(soffice:2148): GLib-GObject-CRITICAL **: g_value_set_boxed: assertion 'G_VALUE_HOLDS_BOXED (value)' failed\n\n(soffice:2148): GLib-GObject-WARNING **: gtype.c:4268: type id '0' is invalid\n\n(soffice:2148): GLib-GObject-WARNING **: can't peek value table for type '<invalid>' which is not currently referenced\nApplication Error\n```\n\nFS#46614 を見てください。\n\n"
    },
    {
      "title": "保存ボタンを押したときに終了してしまう",
      "level": 3,
      "content": "以下の方法を試してください:\n\n- ~/.config/libreoffice フォルダを削除する。LibreOffice 関連の全ての設定が消去されます。LibreOffice を次に起動したときに再生成されます。\n\n- メニューの Tools > Options > LibreOffice > General から Use LibreOffice dialogs にチェックを入れる。\n\n- libvclplug_gtk3lo.so による GTK3 の統合が問題を起こしていると言われています [2]。#テーマに書かれているように gtk など別の VCL を使用してください。\n\n"
    },
    {
      "title": "メディアサポート",
      "level": 3,
      "content": "埋め込んだビデオが灰色のボックスになる場合、必要な GStreamer プラグインがインストールしてあるか確認してください。\n\n"
    },
    {
      "title": "Writer や Draw のデフォルトの用紙サイズ",
      "level": 3,
      "content": "空の Writer や Draw のドキュメントでデフォルトの用紙サイズがロケールにあってない場合、任意の依存パッケージである libpaper をインストールして、/etc/papersize (システム全体の設定) を更新するか PAPERSIZE 環境変数 (ユーザー個別の設定) を適当な用紙サイズで設定してください。詳しくは papersize(5) を参照。\n\n"
    },
    {
      "title": "ダークテーマで LibreOffice のツールバーが読めなくなる",
      "level": 3,
      "content": "https://bugs.documentfoundation.org/show_bug.cgi?id=94632 を見てください。\n\nダークテーマと互換性のあるツールバーアイコンを使用するには、VCL_ICONS_FOR_DARK_THEME=1 環境変数を設定してください。\n\nまた、libreoffice をライトテーマで起動する方法もあります (例: GTK_THEME=Adwaita:light 環境変数を使用)。\n\n"
    },
    {
      "title": "Breeze/Plasma 5 のダークテーマ LibreOffice のツールバーが読めない",
      "level": 3,
      "content": "breeze-gtk をインストールしたくない場合、Tools > Options > LibreOffice > View > Icon Style からアイコンのスタイルを LibreOffice が提供しているスタイルに変更してください。\n\nもしくは GTK+ の Breeze テーマ breeze-gtk と LibreOffice 用の Breeze ダークアイコン libreoffice-breeze-iconsAUR をインストールしてください。\n\n問題が解決しない場合、LibreOffice で gtk インターフェイスが使われるようにしてください。詳しくはテーマを参照。\n\n正しく動作しない場合、gen インターフェイスを使ってみてください [3]。\n\n"
    },
    {
      "title": "en_US 以外のシステムロケールで AutoText のデフォルトの挙動が機能しない",
      "level": 3,
      "content": "システムロケールが en_US 以外の場合に AutoText の期待されるデフォルトの挙動が存在しない場合 (例えば、Writer のドキュメントで fn と入力してから F3 キーを押しても数字の付いた関数が自動的に挿入されない)、AutoText のパスにデフォルトの en_US AutoText テンプレートを追加する必要があります。Tools > AutoText から Path... をクリックして次のパスをリストに追加してください: /usr/lib/libreoffice/share/autotext/en-US。これで AutoText がデフォルトで動作するようになるはずです。\n\n"
    },
    {
      "title": "参照",
      "level": 2,
      "content": "- Libreoffice 拡張\n- Libreoffice テンプレート\n- Wikipedia:ja:LibreOffice\n\n"
    }
  ]
}