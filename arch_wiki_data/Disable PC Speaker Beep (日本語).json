{
  "title": "Disable PC Speaker Beep (日本語)",
  "url": "https://wiki.archlinux.org/title/Disable_PC_Speaker_Beep_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- カーネルモジュール\n- Advanced Linux Sound Architecture\n\n最初の IBM PC 以来、ほとんどの PC には PCスピーカー (または beeper) が内蔵されており、ビープ音を発生させることができます。このスピーカーは高音質再生が可能なものではなく、単にビープ音という聴覚的なフィードバックを得るための簡単な手段です。ウェブブラウザ、エディタ、端末などのソフトウェアでは、ユーザーが望むと望まざるとにかかわらず、ビープ音を発生させることがあります。そこで、この記事では、これらのビープ音を設定する、あるいは無効にする方法について説明します。\n\nサウンドカードやスピーカーがなく、単純な音声通知が必要な場合は、Beep をご覧ください。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 メカニズム\n- 2 PC スピーカーの無効化 2.1 グローバル 2.2 Linux の場合 2.3 コンソール 2.3.1 Less ページャ 2.4 Xorg 2.5 ALSA 2.6 GNOME 2.7 KDE Plasma 2.8 Cinnamon 2.9 GTK 2.10 PulseAudio\n- 3 Beep 3.1 インストール 3.2 root 以外のユーザーによる使用 3.3 ヒントとテクニック\n- 4 参照\n\n- 2.1 グローバル\n- 2.2 Linux の場合\n- 2.3 コンソール 2.3.1 Less ページャ\n- 2.4 Xorg\n- 2.5 ALSA\n- 2.6 GNOME\n- 2.7 KDE Plasma\n- 2.8 Cinnamon\n- 2.9 GTK\n- 2.10 PulseAudio\n\n- 2.3.1 Less ページャ\n\n- 3.1 インストール\n- 3.2 root 以外のユーザーによる使用\n- 3.3 ヒントとテクニック\n\n"
    },
    {
      "title": "メカニズム",
      "level": 2,
      "content": "PC スピーカーは通常、マザーボードの前面接続ヘッダーに接続された物理的なユニットです。マザーボードメーカーによっては、マザーボードに PC スピーカーを搭載して出荷していない場合や、PC スピーカーが表面に直接ハンダ付けされている場合があります。ノートパソコンでは、通常、物理的な PC スピーカーはなく、beeper はノートパソコンの内蔵スピーカーにルーティングされています。また、サウンドカードの通常出力 (スピーカーやヘッドフォンなど) で鳴らす場合もあり、その場合は予想外の音量になる傾向があります。\n\n起動時、BIOS は従来、POST 中にビープ音を発生させます。最近のマザーボードでは、OS を高速に起動させるために POST ビープ音を省略するモデルもあります。BIOS は通常、POST ビープ音を切り替えることができますが、PCスピーカーを完全にオフにする設定はできません。\n\nシステムが Linux で起動し、pcspkr が起動すると、カーネルモジュール が起動します。カーネルモジュール がロードされると、PC スピーカーは環境によって使用され、ユーザによって手動で起動され、ある程度まで設定することができるようになります。PC スピーカーは CPU によって直接制御されており、また、ビープ音のためだけに作られているため、PC スピーカーを音声の再生に使用することはできません。\n\n"
    },
    {
      "title": "PC スピーカーの無効化",
      "level": 2,
      "content": "音声自体をオフにしないで、特定のサウンドだけをオフにするには、そのサウンドが使用している環境のどの部分から生まれているのか認識する必要があります。カスタマイズできるサウンドの選択範囲はいろいろあるため、他のユーザーにとっても有益であるような設定の組み合わせ例を見つけた時はこの wiki ページに追加していただけると幸いです。\n\n"
    },
    {
      "title": "グローバル",
      "level": 3,
      "content": "PC スピーカーを取り外すと、システムはビープ音を発することができなくなります。これは、ユニットをマザーボードから物理的に取り外すことで実現できます(可能な場合)。メーカーによっては、これをオフにするためのジャンパヘッダを提供している場合があります。\n\n"
    },
    {
      "title": "Linux の場合",
      "level": 3,
      "content": "PC スピーカーは、pcspkr カーネルモジュール を アンロード することで無効にできます。\n\n```\n# rmmod pcspkr\n```\n\nブラックリストへ登録 すると、起動時に udev がモジュールをロードしないようになります。\n\n```\n/etc/modprobe.d/nobeep.conf\n```\n\n```\nblacklist pcspkr\n```\n\nカーネルコマンドラインでブラックリストに登録 はさらにもう1つの方法です。ブートローダのカーネルラインに modprobe.blacklist=pcspkr を追加するだけです。\n\n"
    },
    {
      "title": "コンソール",
      "level": 3,
      "content": "以下のコマンドを /etc/profile や /etc/profile.d/disable-beep.sh のようなファイル(実行可能にする必要があります)に加えてください:\n\n```\nsetterm -blength 0\n```\n\n/etc/inputrc や ~/.inputrc に以下の行を加える、もしくはアンコメントする方法もあります:\n\n```\nset bell-style none\n```\n\n"
    },
    {
      "title": "Less ページャ",
      "level": 4,
      "content": "less ページャを less -q で起動することで最終行イベントのビープ音を無効化できます。less -Q で全てのイベントのビープ音を無効化できます。man ページで PC スピーカーを無効にしたいときは man -P \"less -Q\" を使用するか $MANPAGER または $PAGER 環境変数を設定してください。\n\n~/.bashrc に以下の行を追加することでも設定できます:\n\n```\nalias less='less -Q'\nalias man 'man -P \"less -Q\"'\n```\n\n"
    },
    {
      "title": "Xorg",
      "level": 3,
      "content": "```\n$ xset -b\n```\n\n/etc/xprofile などのスタートアップファイルにこのコマンドを加えることで、設定を永続的にすることができます。詳しくは xprofile を見てください。\n\n"
    },
    {
      "title": "ALSA",
      "level": 3,
      "content": "大抵のサウンドカードでは ALSA のチャンネルとして PC スピーカーが認識されます。名前は PC Speaker, PC Beep, Beep のどれかです。スピーカーをミュートにするには alsamixer または amixer を使います:\n\n```\n$ amixer set channel 0% mute\n```\n\nチャンネルのミュートを解除する方法は Advanced Linux Sound Architecture#チャンネルのミュートを解除するを見てください。\n\n"
    },
    {
      "title": "GNOME",
      "level": 3,
      "content": "GSettings を使用:\n\n```\n$ gsettings set org.gnome.desktop.wm.preferences audible-bell false\n```\n\n"
    },
    {
      "title": "KDE Plasma",
      "level": 3,
      "content": "Bell 通知設定は \"System Settings\"->\"Accessibility Options\"->\"Bell\" で変更できます。\n\n"
    },
    {
      "title": "Cinnamon",
      "level": 3,
      "content": "Cinnamon では\"水滴\"サウンドが流れますが、dconf で無効に設定できます:\n\n```\n$ dconf write /org/cinnamon/desktop/wm/preferences/audible-bell false\n```\n\n"
    },
    {
      "title": "GTK",
      "level": 3,
      "content": "~/.gtkrc-2.0 に以下の行を追加:\n\n```\ngtk-error-bell = 0\n```\n\n同じ行を $XDG_CONFIG_HOME/gtk-3.0/settings.ini の [Settings] セクションに追加:\n\n```\n[Settings]\ngtk-error-bell = 0\n```\n\n上記の設定は Gnome Developer Handbook に載っています。\n\n"
    },
    {
      "title": "PulseAudio",
      "level": 3,
      "content": "PulseAudio を使用して、PC スピーカーのビープ音の代わりに音声を出力します。\n\n"
    },
    {
      "title": "Beep",
      "level": 2,
      "content": "仮想コンソールにログインした際に、ユーザーが短い音を鳴らすことができます。詳しくは Wikipedia:bell character#usage をご覧ください。\n\nBeep は高度な PC スピーカービーププログラムです。サウンドカードやスピーカーがなく、シンプルな音声通知が必要な場合に便利です。\n\n"
    },
    {
      "title": "インストール",
      "level": 3,
      "content": "beep パッケージをインストールします。\n\nALSA で PC スピーカーのミュートを解除する必要があるかもしれません。\n\n"
    },
    {
      "title": "root 以外のユーザーによる使用",
      "level": 3,
      "content": "beep は /dev/input/by-path/platform-pcspkr-event-spkr を使って PC スピーカーを制御しています。非 root ユーザーとしてアクセスするには、適切なパーミッションを設定する必要があります。/etc/udev/rules.d/70-pcspkr-beep.rules を作成し、以下のルールを追加してください。\n\n```\nACTION==\"add\", SUBSYSTEM==\"input\", ATTRS{name}==\"PC Speaker\", ENV{DEVNAME}!=\"\", TAG+=\"uaccess\"\n```\n\nこれにより、現在アクティブなバーチャルコンソール・セッションにログインしているユーザーであれば、誰でも PC スピーカーを使用することができます。\n\nまたは、新しいユーザーグループ(例:beep)を作成し、デバイスファイルに正しい権限を設定するための対応するルールを設定することもできます。\n\n```\nACTION==\"add\", SUBSYSTEM==\"input\", ATTRS{name}==\"PC Speaker\", ENV{DEVNAME}!=\"\", GROUP=\"beep\", MODE=\"0620\"\n```\n\nこのソリューションでは、beep グループに属するユーザーであれば誰でもスピーカーをコントロールすることができます。\n\n再起動せずに新しいユーザー権限を適用するために、ルールとデバイスファイルを強制的に再読み込みするには、以下を実行します。\n\n```\n$ udevadm control --reload && rmmod pcspkr && modprobe pcspkr\n```\n\n"
    },
    {
      "title": "ヒントとテクニック",
      "level": 3,
      "content": "大抵の場合は伝統的なビープ音で満足するとおもいますが、音色をちょっと変えたいと思う人がいるかもしれません。以下のコマンドは少しだけ高音で短い音を2回鳴らします:\n\n```\n# beep -f 5000 -l 50 -r 2\n```\n\n"
    },
    {
      "title": "参照",
      "level": 2,
      "content": "- xset(1), setterm(1), readline(3)\n\n"
    }
  ]
}