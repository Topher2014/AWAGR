{
  "title": "Advanced Linux Sound Architecture (日本語)",
  "url": "https://wiki.archlinux.org/title/Advanced_Linux_Sound_Architecture_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- Advanced Linux Sound Architecture/設定例\n- Advanced Linux Sound Architecture/トラブルシューティング\n- サウンドシステム\n- PC スピーカーのビープ音の無効化\n- PulseAudio\n- Open Sound System\n\nAdvanced Linux Sound Architecture (ALSA) は、サウンドカードのデバイスドライバを提供する Open Sound System (OSSv3) を置き換えるために開発された Linux カーネルコンポーネントです。デバイスドライバの他に、ALSA は、カーネルドライバと直接やりとりせずに高レベルの API を使ってドライバ機能を使いたいという開発者のために、ユーザ空間のライブラリも提供しています。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 インストール 1.1 ユーザー権限 1.2 ALSA ユーティリティ 1.3 OSS との互換性 1.4 PulseAudio との互換性 1.5 ALSA と systemd 1.6 ALSA ファームウェア\n- 2 チャンネルのミュートを解除する 2.1 amixer を使ってミュートを解除 2.2 alsamixer を使ってミュートを解除 2.3 5.1/7.1 サウンドのミュートの解除 2.4 マイクの有効化 2.5 テスト 2.6 ノート\n- 3 設定 3.1 デフォルトサウンドカードの設定 3.1.1 環境変数を使ってデフォルト PCM を選択する 3.1.2 ハードウェアを直接割り当てる 3.2 サウンドモジュールがロードされていることを確かめる 3.3 S/PDIF 出力 3.4 イコライザー 3.4.1 AlsaEqual を使う (UI あり) 3.4.1.1 AlsaEqual の管理 3.4.2 mbeq を使う\n- 4 高品質なリサンプリング\n- 5 アップ・ダウンミキシング 5.1 アップミキシング 5.2 ダウンミキシング\n- 6 ミキシング 6.1 手動で dmix を有効にする 6.2 ハードウェアミキシング 6.2.1 サポート 6.2.2 フィックス\n- 7 ヒントとテクニック 7.1 USB サウンドカードのホットプラグ 7.2 同時出力 7.3 キーボードのボリュームコントロール\n- 8 トラブルシューティング\n- 9 設定例\n- 10 参照\n\n- 1.1 ユーザー権限\n- 1.2 ALSA ユーティリティ\n- 1.3 OSS との互換性\n- 1.4 PulseAudio との互換性\n- 1.5 ALSA と systemd\n- 1.6 ALSA ファームウェア\n\n- 2.1 amixer を使ってミュートを解除\n- 2.2 alsamixer を使ってミュートを解除\n- 2.3 5.1/7.1 サウンドのミュートの解除\n- 2.4 マイクの有効化\n- 2.5 テスト\n- 2.6 ノート\n\n- 3.1 デフォルトサウンドカードの設定 3.1.1 環境変数を使ってデフォルト PCM を選択する 3.1.2 ハードウェアを直接割り当てる\n- 3.2 サウンドモジュールがロードされていることを確かめる\n- 3.3 S/PDIF 出力\n- 3.4 イコライザー 3.4.1 AlsaEqual を使う (UI あり) 3.4.1.1 AlsaEqual の管理 3.4.2 mbeq を使う\n\n- 3.1.1 環境変数を使ってデフォルト PCM を選択する\n- 3.1.2 ハードウェアを直接割り当てる\n\n- 3.4.1 AlsaEqual を使う (UI あり) 3.4.1.1 AlsaEqual の管理\n- 3.4.2 mbeq を使う\n\n- 3.4.1.1 AlsaEqual の管理\n\n- 5.1 アップミキシング\n- 5.2 ダウンミキシング\n\n- 6.1 手動で dmix を有効にする\n- 6.2 ハードウェアミキシング 6.2.1 サポート 6.2.2 フィックス\n\n- 6.2.1 サポート\n- 6.2.2 フィックス\n\n- 7.1 USB サウンドカードのホットプラグ\n- 7.2 同時出力\n- 7.3 キーボードのボリュームコントロール\n\n"
    },
    {
      "title": "インストール",
      "level": 2,
      "content": "ALSA はデフォルトの Arch カーネルにモジュールセットとして含まれているので、インストールは不要です。\n\n起動時に自動で udev があなたのハードウェアを調べて、オーディオカード用の適切なカーネルモジュールをロードします。したがって、サウンドはすでに鳴らせるはずです。ただ、デフォルトでは全てのチャンネルはミュートにされています。チャンネルのミュートを解除してください。\n\n"
    },
    {
      "title": "ユーザー権限",
      "level": 3,
      "content": "通常、ローカルユーザーは音楽を再生したり、ミキサーレベルを変更する権限があります。\n\nリモートユーザーが ALSA を使用できるようにするには、ユーザーを audio グループに追加する必要があります。\n\n"
    },
    {
      "title": "ALSA ユーティリティ",
      "level": 3,
      "content": "alsa-utils パッケージをインストールしてください、サウンドデバイスをコンソールや端末から設定するための alsamixer ユーザー空間ツールが含まれています。また、高品質なリサンプリングやアップ・ダウンミキシングなどの高度な機能を使いたい場合は alsa-plugins パッケージをインストールしてください。\n\n"
    },
    {
      "title": "OSS との互換性",
      "level": 3,
      "content": "ALSA には OSS のコールに介入して ALSA を使うようにさせる機能があります。このエミュレーションレイヤーは /dev/dsp を開いて音声データを直接書き込むような古いアプリケーションで有用です。OSS やエミュレーションライブラリがないと、/dev/dsp が見つからずにアプリケーションは音声を鳴らすことができません。\n\nOSS アプリケーションに dmix (ソフトウェアミキシング) を扱わせたい場合は alsa-oss パッケージをインストールして snd-seq-oss, snd-pcm-oss, snd-mixer-oss カーネルモジュールをロードして OSS エミュレーションモジュールを有効にしてください。\n\n"
    },
    {
      "title": "PulseAudio との互換性",
      "level": 3,
      "content": "apulseAUR を使うことで PulseAudio にしか対応していないアプリケーションで ALSA を利用することができます。使用方法は $ apulse yourapplication とアプリケーションを起動するだけです。\n\n"
    },
    {
      "title": "ALSA と systemd",
      "level": 3,
      "content": "alsa-utils パッケージには、それぞれ起動時とシャットダウン時に動くように設定された alsa-restore.service と alsa-state.service が含まれています。\n\n自動的にインストールされ有効化されるため、特に設定は必要ありません。systemctl を使うことでステータスを確認できます。\n\n"
    },
    {
      "title": "ALSA ファームウェア",
      "level": 3,
      "content": "alsa-firmware パッケージには特定のサウンドカードを使うのに必要なファームウェアが含まれています (例: Creative SB0400 Audigy2)。\n\n"
    },
    {
      "title": "チャンネルのミュートを解除する",
      "level": 2,
      "content": "現在のバージョンでは ALSA をインストールしたあと全てのチャンネルはデフォルトでミュートされています。手動でチャンネルをアンミュートする必要があります。\n\n"
    },
    {
      "title": "amixer を使ってミュートを解除",
      "level": 3,
      "content": "コマンドラインで amixer を使うことでサウンドカードのマスターボリュームのミュートを解除できます:\n\n```\n$ amixer sset Master unmute\n```\n\n"
    },
    {
      "title": "alsamixer を使ってミュートを解除",
      "level": 3,
      "content": "alsamixer ncurses UI を使えば簡単にミュートを解除できます:\n\n```\n$ alsamixer\n```\n\nalsamixer の、チャンネルの下の MM ラベルはそのチャンネルがミュートになっていることを示しています。00 はミュートが解除されていることを示しています。\n\n← や → キーを押して Master や PCM チャンネルに移動して m キーを押してミュートを解除してください。↑ キーを押してボリュームを上げて値を 0 dB ゲインにしてください。ゲインは左上の 項目: の隣に表示されます。\n\n"
    },
    {
      "title": "5.1/7.1 サウンドのミュートの解除",
      "level": 3,
      "content": "5.1 または 7.1 サラウンドを鳴らしたいときは Front, Surround, Center, LFE (サブウーファー), Side などの他のチャンネルも同じようにミュートを解除してください（これらのチャンネル名は Intel HD Audio のものです、チャンネル名はハードウェアによって変わっているかもしれません）。\n\n"
    },
    {
      "title": "マイクの有効化",
      "level": 3,
      "content": "マイクロフォンを有効にするには、Capture タブに F4 で切り替えてチャンネルを Space で有効にしてください。マイクが使えない時は Advanced Linux Sound Architecture/トラブルシューティング#マイクロフォン を見て下さい。\n\n"
    },
    {
      "title": "テスト",
      "level": 3,
      "content": "次に、音が鳴るかテストしてみましょう:\n\n```\n$ speaker-test -c 2\n```\n\n-c はスピーカーによって変えて下さい。例えば 7.1 では -c 8 を使います:\n\n```\n$ speaker-test -c 8\n```\n\n間違ったデバイスから音が出力される場合、-D 引数を使って手動でデバイスを指定してみてください:\n\n```\n$ speaker-test -D default:PCH -c 8\n```\n\n-D では PCM チャンネルの名前を値として指定できます。以下のコマンドで確認することができます:\n\n```\n$ aplay -L | grep :CARD\n```\n\n```\ndefault:CARD=PCH  # 'default:PCH' is the PCM channel name for -D\nsysdefault:CARD=PCH\nfront:CARD=PCH,DEV=0\nsurround21:CARD=PCH,DEV=0\nsurround40:CARD=PCH,DEV=0\nsurround41:CARD=PCH,DEV=0\nsurround50:CARD=PCH,DEV=0\nsurround51:CARD=PCH,DEV=0\nsurround71:CARD=PCH,DEV=0\n```\n\n音が出ない場合、#設定や Advanced Linux Sound Architecture/トラブルシューティングに進んで問題を解決してください。\n\n"
    },
    {
      "title": "ノート",
      "level": 3,
      "content": "- カードによってはアナログサウンドを聞くためにはデジタル出力をミュートする必要があります。Soundblaster Audigy LS では IEC958 チャンネルをミュートしてください。\n- マシンによっては (Thinkpad T61 など)、Speaker チャンネルのミュートを解除する必要があります。\n- マシンによっては (Dell E6400 など)、同じく Front や Headphone チャンネルのミュートを解除する必要があります。\n- 再起動するとボリューム調整が元に戻ってしまう場合、root で alsamixer を実行してみて下さい。\n\n"
    },
    {
      "title": "設定",
      "level": 2,
      "content": "システムの設定ファイルは /etc/asound.conf で、ユーザー別の設定ファイルは ~/.asoundrc です。\n\n"
    },
    {
      "title": "デフォルトサウンドカードの設定",
      "level": 3,
      "content": "起動毎にサウンドカードの順番が変わってしまうときは、/etc/modprobe.d 内の .conf で終わるファイル (例: /etc/modprobe.d/alsa-base.conf) に順番を明記することができます。 例えば、mia サウンドカードを #0 にしたい場合は:\n\n```\n/etc/modprobe.d/alsa-base.conf\n```\n\n```\noptions snd slots=snd_mia,snd_hda_intel\noptions snd_mia index=0\noptions snd_hda_intel index=1\n```\n\n$ cat /proc/asound/modules を使ってロードされているサウンドモジュールとその順番を取得してください。$ lsmod | grep snd を使ってデバイス・モジュールのリストを取得してください。この設定では snd_mia を使うサウンドカードと snd_hda_intel を使うサウンドカード (例: オンボード) を一枚づつ挿していると仮定しています。\n\nindex を -2 にすることで ALSA にカードを優先的に使わせないようにすることも可能です。Linux Mint や Ubuntu などのディストリビューションでは以下の設定を使うことで USB やその他の\"一般的でない\"ドライバに index 0 を与えないようにしています:\n\n```\n/etc/modprobe.d/alsa-base.conf\n```\n\n```\noptions bt87x index=-2\noptions cx88_alsa index=-2\noptions saa7134-alsa index=-2\noptions snd-atiixp-modem index=-2\noptions snd-intel8x0m index=-2\noptions snd-via82xx-modem index=-2\noptions snd-usb-audio index=-2\noptions snd-usb-caiaq index=-2\noptions snd-usb-ua101 index=-2\noptions snd-usb-us122l index=-2\noptions snd-usb-usx2y index=-2\noptions snd-pcsp index=-2\noptions snd-usb-audio index=-2\n```\n\n変更を反映させるには再起動する必要があります。\n\n"
    },
    {
      "title": "環境変数を使ってデフォルト PCM を選択する",
      "level": 4,
      "content": "設定ファイルで、以下を追加してください:\n\n```\npcm.!default {\n   type plug\n   slave.pcm {\n     @func getenv\n     vars [ ALSAPCM ]\n     default \"hw:Audigy2\"\n   }\n }\n```\n\ndefault の行はあなたのカードの名前に置き換える必要があります (ここでは Audigy2 を例にしています)。aplay -l で名前を取得することができ surround51 のように PCM を使うことも可能です。ただしマイクロフォンを使う必要がある場合は full-duplex PCM をデフォルトにすると良いでしょう。\n\nこれで環境変数 ALSAPCM を変更することでサウンドカードを選択できるようになります。カードを選択できない全てのプログラムで問題なく使えます。 例えば、mix51to20 という名前の downmix PCM を書いたときは mplayer を ALSAPCM=mix51to20 mplayer example_6_channel.wav で使うことができます。\n\n"
    },
    {
      "title": "ハードウェアを直接割り当てる",
      "level": 4,
      "content": "まずデフォルトに設定したいカード・デバイスの id を aplay -l で見つける必要があります:\n\n```\n$ aplay -l\n```\n\n```\n**** List of PLAYBACK Hardware Devices ****\ncard 0: Intel [HDA Intel], device 0: CONEXANT Analog [CONEXANT Analog]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\ncard 0: Intel [HDA Intel], device 1: Conexant Digital [Conexant Digital]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\ncard 1: JamLab [JamLab], device 0: USB Audio [USB Audio]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\ncard 2: Audio [Altec Lansing XT1 - USB Audio], device 0: USB Audio [USB Audio]\n  Subdevices: 1/1\n  Subdevice #0: subdevice #0\n```\n\n例えば、このリストの最後のエントリはカード ID 2,カード名 Audio でデバイス ID 0 です。このカードをデフォルトにするには、システム全体のファイル /etc/asound.conf かユーザー定義ファイル ~/.asoundrc のどちらかを使ってください。ファイルが存在しないときは作成する必要があります。そして以下のオプションを適切なカード・デバイス id を使って挿入して下さい。\n\n```\npcm.!default {\n\ttype hw\n\tcard Audio #又はcard 2\n}\n\nctl.!default {\n\ttype hw           \n\tcard Audio\n}\n\n pcm.dmixer {\n \ttype dmix\n \tipc_key 2048\n \tslave {\n \t\tpcm \"hw:Audio\"\n \t}\n }\n```\n\nカードIDではなくカード名の使用をおすすめします。デバイスの順番に依存しないためです。\n\npcm.dmixerはミキシングが必要なアプリケーションの為の予備です。\n\nTable content:\nこの記事またはセクションの正確性には問題があります。 理由: General method to select alsa device should be introduced such as environment value. (議論: トーク:Advanced Linux Sound Architecture#)\n\n例えば、chromium -alsa-output-device=pcm.dmixerでChromiumがミキシングを使えるようになります。\n\n'pcm' オプションは音声の再生で使われるカード・デバイスに影響を与え、'ctl' オプションは alsamixer などのコントロールユーティリティで使われるカードに影響を与えます。\n\nアプリケーション (mplayer など) を（再）起動すれば変更はすぐ適用されます。また、aplay などのコマンドを使ってテストすることが可能です。\n\n```\n$ aplay -D default:PCH your_favourite_sound.wav\n```\n\nasound 設定に関するエラーが表示される場合は、上流のドキュメント を確認して設定ファイルフォーマットの変更を確認してください。\n\n"
    },
    {
      "title": "サウンドモジュールがロードされていることを確かめる",
      "level": 3,
      "content": "udev が正しくサウンドカードを検知しているかチェックするには次のコマンドを実行してください:\n\n```\n$ lsmod | grep '^snd' | column -t\n```\n\n```\nsnd_hda_codec_hdmi     22378   4\nsnd_hda_codec_realtek  294191  1\nsnd_hda_intel          21738   1\nsnd_hda_codec          73739   3  snd_hda_codec_hdmi,snd_hda_codec_realtek,snd_hda_intel\nsnd_hwdep              6134    1  snd_hda_codec\nsnd_pcm                71032   3  snd_hda_codec_hdmi,snd_hda_intel,snd_hda_codec\nsnd_timer              18992   1  snd_pcm\nsnd                    55132   9  snd_hda_codec_hdmi,snd_hda_codec_realtek,snd_hda_intel,snd_hda_codec,snd_hwdep,snd_pcm,snd_timer\nsnd_page_alloc         7017    2  snd_hda_intel,snd_pcm\n```\n\n出力が上と同じようになっていれば、サウンドドライバが首尾よく自動検出されています。\n\n/dev/snd/ ディレクトリにデバイスファイルがあるか調べてもいいかもしれません:\n\n```\n$ ls -l /dev/snd\n```\n\n```\ntotal 0\ncrw-rw----  1 root audio 116,  0 Apr  8 14:17 controlC0\ncrw-rw----  1 root audio 116, 32 Apr  8 14:17 controlC1\ncrw-rw----  1 root audio 116, 24 Apr  8 14:17 pcmC0D0c\ncrw-rw----  1 root audio 116, 16 Apr  8 14:17 pcmC0D0p\ncrw-rw----  1 root audio 116, 25 Apr  8 14:17 pcmC0D1c\ncrw-rw----  1 root audio 116, 56 Apr  8 14:17 pcmC1D0c\ncrw-rw----  1 root audio 116, 48 Apr  8 14:17 pcmC1D0p\ncrw-rw----  1 root audio 116,  1 Apr  8 14:17 seq\ncrw-rw----  1 root audio 116, 33 Apr  8 14:17 timer\n```\n\nとにかく controlC0 や pcmC0D0p のようなデバイスがあれば、サウンドモジュールが正しくロードされていることを示しています。\n\nそうなってないのなら、あなたのサウンドモジュールは正しく検出されていません。これを解決するには、手動でモジュールのロードを試して下さい:\n\n- サウンドカードのモジュールを確認します: ALSA Soundcard Matrix モジュールには名前の前に 'snd-' が付きます (例: snd-via82xx)。\n- モジュールをロードします。\n- /dev/snd の中のデバイスファイルを確認したり（上述）、alsamixer や amixer に変化がないか調べて下さい。\n- snd-NAME-OF-MODULE と snd-pcm-oss を起動時にロードするよう設定して下さい。\n\n"
    },
    {
      "title": "S/PDIF 出力",
      "level": 3,
      "content": "S/PDIF はコンピュータとオーディオアンプを接続するときにしばしば使われるデジタルオーディオインターフェイスです (5.1/7.1 サラウンドのホームシアターなど)。\n\n使用しているシェルにあわせて、シェルの設定ファイルに以下の行を追加してください:\n\n```\namixer -c 0 cset name='IEC958 Playback Switch' on\n```\n\nカードのデジタル出力の名前は以下のコマンドで確認できます:\n\n```\n$ amixer scontrols\n```\n\n"
    },
    {
      "title": "AlsaEqual を使う (UI あり)",
      "level": 4,
      "content": "alsaequalAUR パッケージをインストールしてください。\n\nパッケージをインストールした後、以下を ALSA 設定ファイル (~/.asoundrc か /etc/asound.conf) に挿入してください:\n\n```\nctl.equal {\n type equal;\n}\n\npcm.plugequal {\n  type equal;\n  # Modify the line below if you do not\n  # want to use sound card 0.\n  #slave.pcm \"plughw:0,0\";\n  #by default we want to play from more sources at time:\n  slave.pcm \"plug:dmix\";\n}\n#pcm.equal {\n  # If you do not want the equalizer to be your\n  # default soundcard comment the following\n  # line and uncomment the above line. (You can\n  # choose it as the output device by addressing\n  # it with specific apps,eg mpg123 -a equal 06.Back_In_Black.mp3)\npcm.!default {\n  type plug;\n  slave.pcm plugequal;\n}\n```\n\nx86_64 環境で lib32-flashplugin[リンク切れ: アーカイブ: aur-mirror] を使用している場合、上記の設定では flash で音が鳴りません。以下の設定で flash の音を有効にできますが、pcm \"hw:0,0\" の行でサウンドカードを手動で指定する必要があります (利用可能なサウンドカードとカードのデバイス番号は aplay -l で確認できます):\n\n```\n/etc/asound.conf\n```\n\n```\npcm.dmixer {\n    type dmix\n    ipc_key 2048\n    slave {\n        pcm \"hw:0,0\"\n        buffer_size 16384\n    }\n}\n\nctl.equal {\n    type equal;\n}\n\npcm.equalizer {\n    type equal\n    slave.pcm \"plug:dmixer\"\n}\n\npcm.!default {\n    type plug\n    slave.pcm equalizer\n}\n```\n\n次のコマンドを使ってイコライザーを変更することができます:\n\n```\n$ alsamixer -D equal\n```\n\n設定ファイルはユーザーごとに違うので注意してください。~/.alsaequal.bin に保存されます。 AlsaEqual を異なるユーザーの mpd などのソフトウェアで使いたいときは、次を実行することで設定できます:\n\n```\n# su mpd -c 'alsamixer -D equal'\n```\n\nもしくは、ユーザーの home にある .alsaequal.bin のシンボリックリンクを作って下さい。\n\nalsaequal-mgrAUR パッケージをインストールしてください。\n\n通常通りイコライザーを設定してください:\n\n```\n$ alsamixer -D equal\n```\n\n状態に満足したら、名前を付けて保存してください (例: \"foo\"):\n\n```\n$ alsaequal-mgr save foo\n```\n\nイコライザーの状態 \"foo\" は次のコマンドで戻すことができます:\n\n```\n$ alsaequal-mgr load foo\n```\n\nゲームや映画、音楽のジャンル別、VoIP アプリなどそれぞれに合わせてイコライザーの状態を作成し、必要なときにリロードできます。\n\nオプションの詳細は project page を見て下さい。\n\n"
    },
    {
      "title": "mbeq を使う",
      "level": 4,
      "content": "alsa-plugins, ladspa, swh-plugins パッケージをインストールしてください。\n\nまだ ~/.asoundrc か /etc/asound.conf ファイルを作成していない場合は、どちらかを作成して以下を挿入して下さい:\n\n```\n/etc/asound.conf\n```\n\n```\npcm.eq {\n  type ladspa\n\n  # The output from the EQ can either go direct to a hardware device\n  # (if you have a hardware mixer, e.g. SBLive/Audigy) or it can go\n  # to the software mixer shown here.\n  #slave.pcm \"plughw:0,0\"\n  slave.pcm \"plug:dmix\"\n\n  # Sometimes you may need to specify the path to the plugins,\n  # especially if you have just installed them.  Once you have logged\n  # out/restarted this should not be necessary, but if you get errors\n  # about being unable to find plugins, try uncommenting this.\n  #path \"/usr/lib/ladspa\"\n\n  plugins [\n    {\n      label mbeq\n      id 1197\n      input {\n        #this setting is here by example, edit to your own taste\n        #bands: 50hz, 100hz, 156hz, 220hz, 311hz, 440hz, 622hz, 880hz, 1250hz, 1750hz, 25000hz,\n        #50000hz, 10000hz, 20000hz\n        controls [ -5 -5 -5 -5 -5 -10 -20 -15 -10 -10 -10 -10 -10 -3 -2 ]\n      }\n    }\n  ]\n }\n\n # Redirect the default device to go via the EQ - you may want to do\n # this last, once you are sure everything is working.  Otherwise all\n # your audio programs will break/crash if something has gone wrong.\n\n pcm.!default {\n  type plug\n  slave.pcm \"eq\"\n }\n\n # Redirect the OSS emulation through the EQ too (when programs are running through \"aoss\")\n\n pcm.dsp0 {\n  type plug\n  slave.pcm \"eq\"\n }\n```\n\n"
    },
    {
      "title": "高品質なリサンプリング",
      "level": 2,
      "content": "ソフトウェアミキシングが有効になっていると、ALSA は全てを同じ周波数 (デフォルトで 48000) にリサンプリングします。dmix はサウンドの品質を落としてしまう低品質リサンプリングアルゴリズムを使っています。\n\nalsa-plugins と libsamplerate をインストールして下さい。\n\nデフォルトの変換器を libsamplerate に変更します:\n\n```\n/etc/asound.conf\n```\n\n```\ndefaults.pcm.rate_converter \"samplerate_best\"\n```\n\nまたは:\n\n```\n~/.asoundrc\n```\n\n```\ndefaults.pcm.rate_converter \"samplerate_best\"\n```\n\nsamplerate_best は最高のサウンド品質を提供しますが、リアルタイムサンプリングをするには CPU サイクルが大量に必要になるので使うにはそこそこの CPU が必須です。また、dmix の設定で buffer_size を基本の 4096 から 8192 か 16384 に調整する必要もあるかもしれません。他のアルゴリズム (samplerate など) も利用できますがデフォルトのリサンプラーに比べておそらくあまり改善はないでしょう。\n\n"
    },
    {
      "title": "アップミキシング",
      "level": 3,
      "content": "音楽などのステレオ音源を 5.1 や 7.1 サウンドシステムをフルに使って再生するには、アップミキシングを使う必要があります。黎明期ではこれをするのはとても難しいものでした。ですが現在では簡単にアップミキシングができるプラグインがあります。alsa-plugins に含まれている upmix プラグインを使います。\n\nそれから以下を ALSA 設定ファイル (/etc/asound.conf か ~/.asoundrc) に追加してください:\n\n```\npcm.upmix71 {\n    type upmix\n    slave.pcm \"surround71\"\n    delay 15\n    channels 8\n}\n```\n\n上の例は 7.1 のものですが 5.1 や 4.0 にも簡単に変えられます。\n\n設定をするとアップミキシングに使う新しい pcm が加わります。全てのサウンド音源をこの pcm に通したい時は、次のようにデフォルトとして追加してください:\n\n```\npcm.!default \"plug:upmix71\"\n```\n\nこのプラグインは使うにあたって特に設定を変える必要はありません。 プラグインが動作しないときは、以下のようにしてアップミキシングする PCM のための dmixer を自分で設定してください:\n\n```\npcm.dmix6 {\n    type asym\n    playback.pcm {\n        type dmix\n        ipc_key 567829\n        slave {\n            pcm \"hw:0,0\"\n            channels 6\n        }\n    }\n}\n```\n\nそして \"surround71\" のかわりに \"dmix6\" を使って下さい。 音がスキップしたり歪むときは、buffer_size を増やす (例: 32768) か 高品質リサンプラーを使ってください。\n\n"
    },
    {
      "title": "ダウンミキシング",
      "level": 3,
      "content": "5.1 サウンドの映画をステレオシステムで視聴するときなど、音源をステレオにダウンミキシングしたい場合、alsa-plugins に含まれている vdownmix プラグインを使って下さい。\n\n設定ファイルに以下を追加して下さい:\n\n```\npcm.!surround51 {\n    type vdownmix\n    slave.pcm \"default\"\n}\npcm.!surround40 {\n    type vdownmix\n    slave.pcm \"default\"\n}\n```\n\n"
    },
    {
      "title": "ミキシング",
      "level": 2,
      "content": "ミキシングを使うことで複数のアプリケーションが同時に音を出力することが可能になります。外付けのサウンドカードはほとんどの場合ハードウェアミキシングをサポートしており、可能であればデフォルトで有効にされます。内蔵のマザーボードに載っているサウンドカード (Intel HD Audio など) は基本的にハードウェアミキシングをサポートしていません。そのようなカードでは、dmix という名前の ALSA プラグインを使ってソフトウェアミキシングを利用します。この機能はハードウェアミキシングが使えない場合に自動で有効にされます。\n\n"
    },
    {
      "title": "手動で dmix を有効にする",
      "level": 3,
      "content": "ソフトウェアミキシングが動作しない場合は、あなたの home フォルダに以下の内容で .asoundrc ファイルを作成してください。\n\n```\npcm.dsp {\n    type plug\n    slave.pcm \"dmix\"\n}\n```\n\nこれでソフトウェアミキシングが有効になり複数のアプリケーションがサウンドカードを使えるようになるはずです。使えない場合は、/etc/asound.conf の中身を全て上のように置き換えてみて下さい。\n\nS/PDIF などのデジタル音声出力をするために、ALSA パッケージは依然として dmix をデフォルトで有効にしていません。そのため、上の dmix 設定は S/PDIF デバイスで dmix を有効にするために使うことはできません。\n\n一般的な問題と解決方法は Advanced Linux Sound Architecture/トラブルシューティング を見て下さい。\n\n"
    },
    {
      "title": "サポート",
      "level": 4,
      "content": "ハードウェアでミキシングをサポートしているオーディオチップセットを持っている場合、設定は必要ありません。ほとんど全てのオンボード・オーディオチップセットはハードウェアミキシングをサポートしていないので、ソフトウェアでミキシングする必要があります（上述）。ハードウェアミキシングをサポートしているサウンドカードは少なく、Linux でサポートされているサウンドカードは以下になります:\n\n- Creative SoundBlaster Live! (5.1 モデル)\n- Creative SoundBlaster Audigy (複数)\n- Creative SoundBlaster Audidy 2 (ZS モデル)\n- Creative SoundBlaster Audigy 4 (Pro モデル)\n\n- 上記のカードのローエンド版 (Audigy SE, Audigy 2 NX, SoundBlaster Live! 24bit, SoundBlaster Live! 7.1) は別のチップを使っているためハードウェアミキシングに対応していません。\n- オンボードの VIA8237 チップは4ストリームのハードウェアミキシングに対応していますが、マザーボードによってはそれが3ストリームになったり (4番目のストリームが音を出さない) あるいは使えないこともあります。動作したとしても、他の方法と比べて音質は劣ります。\n\n"
    },
    {
      "title": "フィックス",
      "level": 4,
      "content": "64-bit Arch で Intel Corporation 82801I (ICH9 Family) HD Audio Controller (rev 02) を使っている場合、Enemy Territory でサウンドを鳴らすには以下を実行して下さい:\n\n```\necho \"et.x86 0 0 direct\" > /proc/asound/card0/pcm0p/oss\necho \"et.x86 0 0 disable\" > /proc/asound/card0/pcm0c/oss\n```\n\n"
    },
    {
      "title": "USB サウンドカードのホットプラグ",
      "level": 3,
      "content": "USB サウンドカードが挿入されたときに、自動的に第一のアウトプットデバイスにするために、以下の udev ルールを使うことができます (例: 以下の2行を /etc/udev/rules.d/00-local.rules に追加して再起動する)。\n\n```\nKERNEL==\"pcmC[D0-9cp]*\", ACTION==\"add\", PROGRAM=\"/bin/sh -c 'K=%k; K=$${K#pcmC}; K=$${K%%D*}; echo defaults.ctl.card $$K > /etc/asound.conf; echo defaults.pcm.card $$K >>/etc/asound.conf'\"\nKERNEL==\"pcmC[D0-9cp]*\", ACTION==\"remove\", PROGRAM=\"/bin/sh -c 'echo defaults.ctl.card 0 > /etc/asound.conf; echo defaults.pcm.card 0 >>/etc/asound.conf'\"\n```\n\n"
    },
    {
      "title": "同時出力",
      "level": 3,
      "content": "ミニジャックで接続した外付けスピーカーと内蔵のスピーカーで同時に音楽を再生したい場合、alsamixer や amixer を使うことで Auto-Mute のミュートを解除してください:\n\n```\n$ amixer sset \"Auto-Mute\" unmute\n```\n\nそして Headphones, Speaker, Bass Speaker など他の必要なアイテムのミュートを解除してください。\n\n"
    },
    {
      "title": "キーボードのボリュームコントロール",
      "level": 3,
      "content": "以下のコマンドをボリュームキーにマッピングしてください: XF86AudioRaiseVolume, XF86AudioLowerVolume, XF86AudioMute\n\nボリュームを上げるには:\n\n```\namixer set Master 5%+\n```\n\nボリュームを下げるには:\n\n```\namixer set Master 5%-\n```\n\n"
    },
    {
      "title": "トラブルシューティング",
      "level": 2,
      "content": "Advanced Linux Sound Architecture/トラブルシューティングを見て下さい。\n\n"
    },
    {
      "title": "設定例",
      "level": 2,
      "content": "Advanced Linux Sound Architecture/設定例を見て下さい。\n\n"
    },
    {
      "title": "参照",
      "level": 2,
      "content": "- ALSA wiki\n- Asoundrc\n- 非公式 ALSA wiki\n- 高度な ALSA モジュール設定\n- HOWTO: compile driver from svn\n- A close look at ALSA: ALSA concept introduction\n- Linux ALSA sound notes\n\n"
    }
  ]
}