{
  "title": "USB storage devices (日本語)",
  "url": "https://wiki.archlinux.org/title/USB_storage_devices_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- マウント\n\nこの文章では Linux で一般的な USB メモリーを使用する方法を説明します。また、デジタルカメラなど他のデバイスも USB ストレージデバイスとして使える場合があります。\n\n標準の Arch カーネルと最近のデスクトップ環境を使っている場合、最新の環境なら、デバイスはデスクトップに表示され、コンソールを開く必要はありません。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 udisks による自動マウント\n- 2 手動マウント 2.1 usb_storage をサポートするカーネルを取得 2.2 デバイスの確認 2.3 USB メモリーのマウント 2.3.1 root を使用 2.3.2 通常ユーザーで mount を使用 2.3.3 通常ユーザーで fstab を使用 2.3.4 マウントツール\n- 3 トラブルシューティング 3.1 USB ストレージデバイスがシステムから認識されない 3.2 USB デバイスは検出されましたが、マウントできません 3.3 すべてのパーティションをアンマウントした後、デバイスがシャットダウンされない\n\n- 2.1 usb_storage をサポートするカーネルを取得\n- 2.2 デバイスの確認\n- 2.3 USB メモリーのマウント 2.3.1 root を使用 2.3.2 通常ユーザーで mount を使用 2.3.3 通常ユーザーで fstab を使用 2.3.4 マウントツール\n\n- 2.3.1 root を使用\n- 2.3.2 通常ユーザーで mount を使用\n- 2.3.3 通常ユーザーで fstab を使用\n- 2.3.4 マウントツール\n\n- 3.1 USB ストレージデバイスがシステムから認識されない\n- 3.2 USB デバイスは検出されましたが、マウントできません\n- 3.3 すべてのパーティションをアンマウントした後、デバイスがシャットダウンされない\n\n"
    },
    {
      "title": "udisks による自動マウント",
      "level": 2,
      "content": "これは一番簡単でよく使われている方法です。多数のデスクトップ環境によって用いられいますが、単独で使用することも可能です。詳しくは Udisks を見て下さい。\n\n"
    },
    {
      "title": "usb_storage をサポートするカーネルを取得",
      "level": 3,
      "content": "カスタムカーネルを使っていない場合、問題はありません。全ての Arch Linux 標準カーネルはちゃんと設定されています。カスタムカーネルを使っている場合 SCSI-Support, SCSI-Disk-Support, usb_storage を有効にしてカーネルをコンパイルするようにしてください。最新の udev を使っていれば、デバイスを接続するだけでシステムは自動的に必要なカーネルモジュールを全てロードします。古いリリースの udev では hotplug もインストールする必要があります。もしくは、手動で同じことを行うこともできます:\n\n```\n# modprobe usb_storage\n# modprobe sd_mod      (only for non SCSI kernels)\n```\n\n"
    },
    {
      "title": "デバイスの確認",
      "level": 3,
      "content": "ストレージデバイスにアクセスするのにまず必要なのはカーネルによって割り振られたデバイスの識別子です。詳しくは fstab#ファイルシステムの識別 を参照。\n\n"
    },
    {
      "title": "USB メモリーのマウント",
      "level": 3,
      "content": "デバイスをマウントするディレクトリを作成する必要があります:\n\n```\n# mkdir /mnt/usbstick\n```\n\n"
    },
    {
      "title": "root を使用",
      "level": 4,
      "content": "次のコマンドで root でデバイスをマウント (device_node は確認したパスに置き換えてください):\n\n```\n# mount device_node /mnt/usbstick\n```\n\nまたは:\n\n```\n# mount -U UUID /mnt/usbstick\n```\n\nmount がデバイスのフォーマットを認識できないときは -t 引数を使うことができます。詳しくは man mount を参照。\n\n"
    },
    {
      "title": "通常ユーザーで mount を使用",
      "level": 4,
      "content": "root 以外のユーザーで USB メモリーに書き込みを行えるようにするには、次のコマンドを実行:\n\n```\n# mount -o gid=users,fmask=113,dmask=002 /dev/sda1 /mnt/usbstick\n```\n\n"
    },
    {
      "title": "通常ユーザーで fstab を使用",
      "level": 4,
      "content": "root 以外のユーザーで fstab を使って USB メモリーをマウントできるようにするには、次の行を /etc/fstab ファイルに追加:\n\n```\n/dev/sdXY /mnt/usbstick vfat user,noauto,noatime,flush 0 0\n```\n\nまたは:\n\n```\nUUID=E8F1-5438 /mnt/usbstick vfat user,noauto,noatime,flush 0 0\n```\n\nfstab の user やその他のオプションの説明を見て下さい。\n\nこれで、どのユーザーでも次のコマンドでマウントできます:\n\n```\n$ mount /mnt/usbstick\n```\n\nアンマウントするには:\n\n```\n$ umount /mnt/usbstick\n```\n\n"
    },
    {
      "title": "マウントツール",
      "level": 4,
      "content": "複数の マウントツール により、通常のユーザーとしてのマウントが容易になります。\n\n"
    },
    {
      "title": "USB ストレージデバイスがシステムから認識されない",
      "level": 3,
      "content": "コンピュータに USB ストレージデバイスを接続しても lsblk や dmesg で表示されない場合、BIOS で XCHI Handoff と EHCI Handoff が有効になっているか確認してください。\n\n"
    },
    {
      "title": "USB デバイスは検出されましたが、マウントできません",
      "level": 3,
      "content": "最近カーネルをアップグレードした場合、現在動作中のカーネルのUSBストレージのモジュールが削除され、新しくインストールされたカーネル用のモジュールに置き換えられました。これらのモジュールは、新しいカーネルを再起動して実行するか、現在実行しているカーネルのバージョンに対応するカーネルパッケージを ダウングレード するまでロードされません。\n\n"
    },
    {
      "title": "すべてのパーティションをアンマウントした後、デバイスがシャットダウンされない",
      "level": 3,
      "content": "デバイスの電源を切らないと、次のようなことが起こる可能性があります。\n\n- ハードディスクドライブがヘッドを退避せず、回転しながらかすかなスクラッチ音を出し、デバイスを劣化させます [1]\n- ソリッドステートドライブ（特に古いもの）がキャッシュバッファをフラッシュせず、マッピングテーブルを更新せず、データを失う [2]\n\nパーティションをアンマウントしても、デバイスの電源は入ったままです。安全に取り外すには、まずシステムの電源を切る必要があります。[3]\n\n```\n# echo 1 > /sys/block/disk_name/device/delete\n```\n\nudisks を使用する場合は、次のコマンドを使用できます:[4]\n\n```\n$ udisksctl unmount -b /dev/sdXY\n$ udisksctl power-off -b /dev/sdX\n```\n\n"
    }
  ]
}