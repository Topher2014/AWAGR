{
  "title": "Systemd FAQ (日本語)",
  "url": "https://wiki.archlinux.org/title/Systemd_FAQ_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- systemd\n- systemd/ユーザー\n- デーモン\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 FAQ 1.1 どうしてログメッセージがコンソールに表示されるのですか？ 1.2 デフォルトで動作する getty の数を修正するにはどうすればいいですか? 1.3 起動中の出力をもっと詳細に表示するにはどうすればいいですか？ 1.4 起動後にコンソールが消されるのを止めるにはどうすればいいですか？ 1.5 公式の Arch カーネルを使わない場合どのカーネルオプションを有効にする必要がありますか？ 1.6 あるユニットが依存している他のユニットを調べるにはどうすればいいですか？ 1.7 コンピューターをシャットダウンにしたのに、電源が落ちません 1.8 ブートプロセスの間にスクリプトを起動するにはどうすればいいですか？ 1.9 .service の状態が緑の \"active (exited)\" (例: iptables) 1.10 既存のシンボリックリンクのためにユニットを有効にすることができない\n\n- 1.1 どうしてログメッセージがコンソールに表示されるのですか？\n- 1.2 デフォルトで動作する getty の数を修正するにはどうすればいいですか?\n- 1.3 起動中の出力をもっと詳細に表示するにはどうすればいいですか？\n- 1.4 起動後にコンソールが消されるのを止めるにはどうすればいいですか？\n- 1.5 公式の Arch カーネルを使わない場合どのカーネルオプションを有効にする必要がありますか？\n- 1.6 あるユニットが依存している他のユニットを調べるにはどうすればいいですか？\n- 1.7 コンピューターをシャットダウンにしたのに、電源が落ちません\n- 1.8 ブートプロセスの間にスクリプトを起動するにはどうすればいいですか？\n- 1.9 .service の状態が緑の \"active (exited)\" (例: iptables)\n- 1.10 既存のシンボリックリンクのためにユニットを有効にすることができない\n\n"
    },
    {
      "title": "FAQ",
      "level": 2,
      "content": "既知の問題の最新のリストについては、アップストリームの TODO を調べて下さい。\n\n"
    },
    {
      "title": "どうしてログメッセージがコンソールに表示されるのですか？",
      "level": 3,
      "content": "カーネルの loglevel はあなた自身の手で設定してください。歴史的に、/etc/rc.sysinit がこれを行って dmesg のログレベルを 3 (適度に quiet なログレベル) に設定していました。loglevel=3 か quiet のどちらかをカーネルパラメータに追加してください。\n\n"
    },
    {
      "title": "デフォルトで動作する getty の数を修正するにはどうすればいいですか?",
      "level": 3,
      "content": "現在、デフォルトで起動される getty は 1 つだけです。別の TTY に切り替えると、そこで getty が起動されます (ソケットアクティブ化スタイル) Ctl+Alt+F2 で tty2 新しい getty を起動します。\n\nデフォルトでは、自動アクティブ化される getty の数は 6 に制限されています。したがって、F7 から F12 は getty を起動しません。\n\nこの動作を変更したい場合は、/etc/systemd/logind.conf を編集して、NAutoVTs の値を変更します。すべての Fx キーで getty を開始したい場合は、NAutoVTs の値を 12 に増やします。ジャーナルを tty12 に転送 する場合は、NAutoVTs の値を 11 に増やします (したがって、tty12 は空きのままになります)\n\nブート時に実行される getty を事前にアクティブ化することもできます。\n\n別の事前にアクティブ化された getty を追加するには、getty@ttyX.service を 有効化 および 起動 します。\n\ngetty を削除するには、関連する getty@ttyX.service を 無効化 および 停止 します。\n\nsystemd は /etc/inittab ファイルを使用しません。\n\n"
    },
    {
      "title": "起動中の出力をもっと詳細に表示するにはどうすればいいですか？",
      "level": 3,
      "content": "initram のメッセージの後、コンソールに何も表示されない場合、kernel 行に quiet パラメータが設定されているのが原因です。パラメータを削除すれば、少なくとも最初に systemd で起動した時、全てが ok かどうか見ることができます。そして、緑の [ OK ] か赤の [ FAILED ] のリストが表示されます。\n\n全てのメッセージはシステムログに保存されるので、システムの状態を知りたいときは systemctl を実行 (root 権限は必要ありません) するか journalctl を使ってブート・システムログを見て下さい。\n\n"
    },
    {
      "title": "起動後にコンソールが消されるのを止めるにはどうすればいいですか？",
      "level": 3,
      "content": "/etc/systemd/system/getty@.service.d という名前のディレクトリを作成してその中に nodisallocate.conf を配置して TTYVTDisallocate オプションを no に上書きしてください。\n\n```\n/etc/systemd/system/getty@.service.d/nodisallocate.conf\n```\n\n```\n[Service]\nTTYVTDisallocate=no\n```\n\n"
    },
    {
      "title": "公式の Arch カーネルを使わない場合どのカーネルオプションを有効にする必要がありますか？",
      "level": 3,
      "content": "2.6.39 以前のカーネルはサポートされていません。\n\n以下は必須・推奨オプションのリストの一部です、全てではありません:\n\n```\nGeneral setup\n CONFIG_FHANDLE=y\n CONFIG_AUDIT=y (推奨)\n CONFIG_AUDIT_LOGINUID_IMMUTABLE=y (not required, may break sysvinit compatibility)\n CONFIG_CGROUPS=y\n -> Namespaces support\n    CONFIG_NET_NS=y (for private network)\nNetworking support -> Networking options\n CONFIG_IPV6=[y|m] (強く推奨)\nDevice Drivers\n -> Generic Driver Options\n    CONFIG_UEVENT_HELPER_PATH=\"\"\n    CONFIG_DEVTMPFS=y\n    CONFIG_DEVTMPFS_MOUNT=y (必須、initramfs を使わない場合)\n -> Real Time Clock\n    CONFIG_RTC_DRV_CMOS=y (強く推奨)\nFile systems\n CONFIG_FANOTIFY=y (readahead に必須)\n CONFIG_AUTOFS4_FS=[y|m]\n -> Pseudo filesystems\n    CONFIG_TMPFS_POSIX_ACL=y (推奨、pam_systemd.so を使う場合)\n```\n\n"
    },
    {
      "title": "あるユニットが依存している他のユニットを調べるにはどうすればいいですか？",
      "level": 3,
      "content": "例えば、multi-user.target のようなターゲットがどのサービスを使っているか調べたい時は、次のようなコマンドを使って下さい:\n\n```\n$ systemctl show -p \"Wants\" multi-user.target\n```\n\n```\nWants=rc-local.service avahi-daemon.service rpcbind.service NetworkManager.service acpid.service dbus.service atd.service crond.service auditd.service ntpd.service udisks.service bluetooth.service org.cups.cupsd.service wpa_supplicant.service getty.target modem-manager.service portreserve.service abrtd.service yum-updatesd.service upowerd.service test-first.service pcscd.service rsyslog.service haldaemon.service remote-fs.target plymouth-quit.service systemd-update-utmp-runlevel.service sendmail.service lvm2-monitor.service cpuspeed.service udev-post.service mdmonitor.service iscsid.service livesys.service livesys-late.service irqbalance.service iscsi.service\n```\n\nWants の代わりにそれぞれの依存関係のタイプによって WantedBy, Requires, RequiredBy, Conflicts, ConflictedBy, Before, After を使うこともできます。\n\n"
    },
    {
      "title": "コンピューターをシャットダウンにしたのに、電源が落ちません",
      "level": 3,
      "content": "systemctl halt ではなく次のコマンドを使って下さい:\n\n```\n$ systemctl poweroff\n```\n\n"
    },
    {
      "title": "ブートプロセスの間にスクリプトを起動するにはどうすればいいですか？",
      "level": 3,
      "content": "/etc/systemd/system/myscript.service とのように新しいファイル を作成して以下の内容を追加してください:\n\n```\n[Unit]\nDescription=My script\n\n[Service]\nExecStart=/usr/bin/my-script\n\n[Install]\nWantedBy=multi-user.target\n```\n\nこの例では multi-user ターゲットが起動した時にあなたのスクリプトを実行します。スクリプトには実行可能属性が付与されているようにしてください。\n\nmyscript.service を有効化すると次回起動時からは起動時に実行されます。\n\n"
    },
    {
      "title": ".service の状態が緑の \"active (exited)\" (例: iptables)",
      "level": 3,
      "content": "これはおかしなことでは全くありません。iptables の場合、実行するデーモンがなくカーネル内でコントロールされるためです。従って、ルールがロードされた後 iptables は終了します。\n\niptables のルールが正しくロードされたか確認するには:\n\n```\n# iptables --list\n```\n\n"
    },
    {
      "title": "既存のシンボリックリンクのためにユニットを有効にすることができない",
      "level": 3,
      "content": "ユニットを 有効化 しようとすると、次のようなエラーが発生することがあります。\n\n```\nFailed to enable unit: File /etc/systemd/system/symlink already exists and is a symlink to file.\n```\n\nユニットを有効にして作成された symlink が既に /etc/systemd/system/ に存在する場合に発生する可能性があります。これは通常、あるディスプレイマネージャから別のディスプレイに切り替えたとき (例えば GDM から SDDM へ、それぞれ gdm.service と sddm.service で有効にできる)、対応するシンボリックリンク /etc/systemd/system/display-manager.service が既に存在するときに起こります。\n\nこの問題を解決するには、まず関連するディスプレイマネージャを無効にしてから新しいものを有効にするか、新しいものを有効にするときに -f/--force オプションを使って既存の競合するシンボリックリンクを上書きします (systemctl(1) § OPTIONS による)\n\n"
    }
  ]
}