{
  "title": "OpenConnect (Português)",
  "url": "https://wiki.archlinux.org/title/OpenConnect_(Portugu%C3%AAs)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "OpenConnect é um cliente para o AnyConnect SSL VPN[link inativo 2022-09-22 ⓘ] da Cisco e o Pulse Connect Secure da Pulse Secure.\n\n"
    },
    {
      "title": "Instalação",
      "level": 2,
      "content": "Instale o pacote openconnect.\n\n"
    },
    {
      "title": "Uso",
      "level": 2,
      "content": "Veja openconnect(8). Basta executar openconnect como root e inserir seu nome de usuário e senha quando solicitado:\n\n```\n# openconnect vpnserver\n```\n\nInvocação mais avançada com nome de usuário e senha. Insira a senha após executar o comando.\n\n```\n# openconnect -u user --passwd-on-stdin vpnserver\n```\n\nMuitas vezes, o provedor de VPN oferece diferentes grupos de autenticação para diferentes configurações de acesso, como, por exemplo, para um túnel completo ou uma conexão de túnel dividida. Para mostrar os diferentes grupos de autenticação oferecidos e obter mais informações sobre a conexão com o servidor em geral, use:\n\n```\n# openconnect --authenticate servidorvpn\n```\n\n"
    },
    {
      "title": "Cliente Juniper Pulse",
      "level": 3,
      "content": "Para conectar a um servidor Pulse Connect Secure, você precisa saber a SHA-1 de seu certificado.\n\n```\n# openconnect --servercert=sha1:<HASH> --authgroup=\"single-Factor Pulse Clients\" --protocol=nc <ENDEREÇO_SERVIDOR_VPN>/dana-na/auth/url_6/welcome.cgi --pid-file=\"/var/run/work-vpn.pid\" --user=<NOME_DE_USUÁRIO>\n```\n\n"
    },
    {
      "title": "Roteamento dividido",
      "level": 3,
      "content": "O roteamento dividido pode ser obtido usando-se vpn-slice-gitAUR no lugar do vpnc-script, para que você possa acessar seletivamente os hosts através da VPN, mas permanecer em sua própria LAN. Exemplo:\n\n```\nsh\n   $ sudo openconnect gateway.bigcorp.com -u user1234 \\\n       -s 'vpn-slice 192.168.1.0/24 hostname1 alias2=alias2.bigcorp.com=192.168.1.43'\n   $ cat /etc/hosts\n   ...\n   192.168.1.1 dns0.tun0\t\t\t\t\t# vpn-slice-tun0 AUTOCREATED\n   192.168.1.2 dns1.tun0\t\t\t\t\t# vpn-slice-tun0 AUTOCREATED\n   192.168.1.57 hostname1 hostname1.bigcorp.com\t\t# vpn-slice-tun0 AUTOCREATED\n   192.168.1.43 alias2 alias2.bigcorp.com\t\t# vpn-slice-tun0 AUTOCREATED\n```\n\n"
    },
    {
      "title": "NetworkManager",
      "level": 3,
      "content": "Instale o pacote networkmanager-openconnect. Então, configure e conecte com o nm-applet (utilitário de área de notificação do NetworkManager de network-manager-applet) ou utilitário similar. Após a instalação, reinicie o NetworkManager.service.\n\nVeja NetworkManager para detalhes.\n\n"
    },
    {
      "title": "netctl",
      "level": 3,
      "content": "Um netctl.profile(5) simples de tuntap pode ser usado para integrar o OpenConnect no fluxo de trabalho normal do Netctl. Por exemplo:\n\n```\n/etc/netctl/vpn\n```\n\n```\nDescription='VPN'\nInterface=vpn\nConnection=tuntap\nMode=tun\n#User=root\n#Group=root\n\nBindsToInterfaces=(enp0s25 wlp2s0)\nIP=no\n\nPIDFILE=/run/openconnect_${Interface}.pid\nSERVER=vpn.example.net\nAUTHGROUP='<GRUPO_DE_AUTH>'\nLOCAL_USERNAME=<NOME_DE_USUÁRIO_LOCAL>\nREMOTE_USERNAME=<NOME_DE_USUÁRIO_VPN>\n# Assuming the use of pass(1): \nPASSWORD_CMD=\"su ${LOCAL_USERNAME} -c \\\"pass ${REMOTE_USERNAME} | head -n 1\\\"\"\n\nExecUpPost=\"${PASSWORD_CMD} | /usr/bin/openconnect --background --pid-file=${PIDFILE} --interface='${Interface}' --authgroup='${AUTHGROUP}' --user='${REMOTE_USERNAME}' --passwd-on-stdin ${SERVER}\"\nExecDownPre=\"kill -INT $(cat ${PIDFILE}) ; resolvconf -d ${Interface} ; ip link delete ${Interface}\"\n```\n\nIsso permite uma execução como:\n\n```\n$ netctl start vpn\n$ netctl restart vpn\n$ netctl stop vpn\n```\n\nObserve que isso depende de LOCAL_USERNAME ter um gpg-agent em execução, com a senha para a chave PGP já em cache.\n\nSe uma consulta interativa do pass for desejado, use a seguinte linha para PASSWORD_CMD:\n\n```\nDISPLAY=\":0\"\nPASSWORD_CMD=\"su ${LOCAL_USERNAME} -c \\\"DISPLAY=${DISPLAY} pass ${REMOTE_USERNAME} | head -n 1\\\"\"\n```\n\nAjuste a variável DISPLAY conforme necessário.\n\n"
    }
  ]
}