{
  "title": "Flashing BIOS from Linux (日本語)",
  "url": "https://wiki.archlinux.org/title/Flashing_BIOS_from_Linux_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "この記事では Linux でシステム BIOS を書き換える方法についての情報を提供します。ほとんどのメーカーは Windows でしか実行できない Windows の実行ファイルか BIOS 実行ファイルしか提供していません。しかしながら、Linux でシステム BIOS を更新することを可能にするユーティリティが少数ながら存在します。\n\n- HP を使っている場合、HP のウェブサイトから Windows BIOS アップデータをダウンロードして、*.exe ファイルを解凍して ISO イメージを CD に書き込むことができます。以下のツールを利用しなくても CD を使うことで BIOS メニューの 'Firmware Upgrade' からアップグレードが可能です。詳しくは こちらのスレッド を参照してください。\n- Dell 製のコンピュータを使っている場合、Dell が Linux ユーザーに推奨している BIOS の更新情報が こちら に存在します。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 fwupd\n- 2 BiosDisk 2.1 インストール 2.2 使用方法\n- 3 Flashrom 3.1 インストール 3.2 使用方法\n- 4 FreeDOS 4.1 Unetbootin 4.2 dosemu 4.3 ビルド済みのイメージ 4.4 Linux で FreeDOS 提供のディスクイメージ+USB メモリを使う 4.5 FreeDOS 提供のディスクイメージ+USB メモリを Windows で使用する場合 4.6 イメージがフロッピーに収めるには大きすぎる 4.7 使用方法\n- 5 ブータブル光学ディスクのエミュレーション 5.1 インストール 5.2 使用方法\n- 6 Windows PE 6.1 使用方法\n- 7 ベンダー固有 7.1 HP 7.2 ASUS 7.3 Lenovo\n\n- 2.1 インストール\n- 2.2 使用方法\n\n- 3.1 インストール\n- 3.2 使用方法\n\n- 4.1 Unetbootin\n- 4.2 dosemu\n- 4.3 ビルド済みのイメージ\n- 4.4 Linux で FreeDOS 提供のディスクイメージ+USB メモリを使う\n- 4.5 FreeDOS 提供のディスクイメージ+USB メモリを Windows で使用する場合\n- 4.6 イメージがフロッピーに収めるには大きすぎる\n- 4.7 使用方法\n\n- 5.1 インストール\n- 5.2 使用方法\n\n- 6.1 使用方法\n\n- 7.1 HP\n- 7.2 ASUS\n- 7.3 Lenovo\n\n"
    },
    {
      "title": "fwupd",
      "level": 2,
      "content": "fwupd はソフトウェアによってローカルマシンのファームウェアをアップデートできるようにするシンプルなデーモンです。デスクトップ用に開発されていますが、スマートフォンやタブレット、ヘッドレスサーバーなどでも利用できます。GNOME Software などの GUI のソフトウェアマネージャを使ってアップデートを表示・適用したり、コマンドラインツールやシステムの D-Bus インターフェイスを直接使うことができます。\n\nDell や Logitech などのメーカーによって Linux にファームウェアのアップデートを配布するために使われています。\n\nfwupd は UEFI モードでの BIOS アップデートだけサポートしています。\n\nインストールや使用方法について詳しくは fwupd を見てください。\n\n"
    },
    {
      "title": "BiosDisk",
      "level": 2,
      "content": "BiosDisk は Linux におけるシステム BIOS の書き換えプロセスを簡単にします。\n\n"
    },
    {
      "title": "インストール",
      "level": 3,
      "content": "biosdisk-gitAUR パッケージをインストールしてください。\n\n"
    },
    {
      "title": "使用方法",
      "level": 3,
      "content": "biosdisk ユーティリティを使って BIOS フラッシュイメージを作成するには、まずメーカーのウェブサイトからあなたのシステム用の最新の生の BIOS イメージをダウンロードします。ただし、入手するのは BIOS 実行ファイルであって Windows の実行ファイルでないのでそこを確認してください。それからはふたつの選択肢があります: ISO を作成するか、あるいはブートローダー用のイメージをインストールするかです。\n\n- mkimage はユーザーのハードドライブ上に ISO イメージを作成します。使用方法は以下の通り:\n\n```\n# biosdisk mkimage [-o option] [-i destination] /path/to/.exe\n```\n\n- install は biosdisk イメージを作成して、イメージファイルを /boot にコピー、そしてそのイメージのエントリと共にブートローダーを更新します。したがってユーザーがするべきことはシステムを起動し BIOS を書き換えるイメージを選択するだけです。ハードドライブから直接 biosdisk イメージがロードされて BIOS が書き換えられます。\n\n```\n# biosdisk install [-o option] [--name=] /path/to/.exe\n```\n\n"
    },
    {
      "title": "Flashrom",
      "level": 2,
      "content": "Flashrom はフラッシュチップを確認・読込・書込・検証・消去するためのユーティリティです。メインボードやネットワーク・グラフィック・ストレージコントローラーカード、そして様々なプログラマーデバイスにおける BIOS/EFI/coreboot/ファームウェア/optionROM イメージを書き換えるために作られました。\n\n"
    },
    {
      "title": "インストール",
      "level": 3,
      "content": "flashrom か flashrom-gitAUR パッケージをインストールしてください。\n\n"
    },
    {
      "title": "使用方法",
      "level": 3,
      "content": "ウェブサイトであなたのマザーボードや (内部の) チップセットが flashrom によってサポートされているか確認してください: Supported Hardware。次のコマンドを実行してハードウェアがサポートされているか確認することもできます:\n\n```\n# flashrom --programmer internal\n```\n\n上のコマンドはあなたのマザーボードとチップセットを表示します。それから次のコマンドを実行することでサポートされているか確認できます:\n\n```\n# flashrom --programmer internal -L | grep CHIPNAMEfrompreviouscommand\n```\n\n新しいメインボードを使っている場合、複数のロムチップが表示されることがあります。上のコマンドで表示されたところからチップの名前を選択してください。-c オプションを使うことでコマンドによってどの ROM を書き換えるのか選択できます:\n\n```\n# flashrom --programmer internal -c \"CHIPNAME\" -r backup_CHIPNAME.bin\n```\n\nROM チップ上に新しい BIOS イメージ (プロプライエタリのイメージまたは Coreboot) を書き込んで検証する:\n\n```\n# flashrom --programmer internal internal -c \"CHIPNAME\" -w newbios.bin\n```\n\nメインボード上の他のフラッシュチップを書き換えたい場合は、次のコマンドで全てのオプションを知ることができます:\n\n```\n# flashrom\n```\n\n"
    },
    {
      "title": "FreeDOS",
      "level": 2,
      "content": "FreeDOS はフリーの DOS 互換のオペレーティングシステムで、プロプライエタリの DOS を必要なくさせるという挑戦をしています。必要なのは FreeDOS カーネルが載ったブータブルフロッピーディスクイメージだけです。\n\n"
    },
    {
      "title": "Unetbootin",
      "level": 3,
      "content": "ブータブルな FreeDOS USB スティックを作成する一番簡単な方法は unetbootinAUR を使うことです。\n\nUSB メモリを FAT16 でフォーマットして \"boot\" フラグを有効にします (gparted や partitionmanager などで GUI を使って行うことができます)。それから、フラッシュドライブをマウントした後、ディストリビューション FreeDOS とマウントしたスティックを選択します。アプリは自動的にイメージをダウンロードしてドライブにコピーします。最後に、書き換えたいもの全てをコピーすることができます (BIOS, ファームウェアなど)。\n\n"
    },
    {
      "title": "dosemu",
      "level": 3,
      "content": "公式 FreeDOS イメージの問題点は、ファームウェアや BIOS のアップデートファイル、プログラムを保持するための余分なスペースがないことです。Linux で任意のサイズの DOS、ブータブル FAT ドライブを作る最も簡単な方法は mount a FAT drive under dosemu and then make it bootable with the FreeDOS sys command です。\n\n別の方法として、Gentoo:BIOS Update#FreeDOS environment を参照してください。\n\n"
    },
    {
      "title": "ビルド済みのイメージ",
      "level": 3,
      "content": "他の方法も存在します: FreeDOS prebuilt bootable USB flash drive image by Christian Taube\n\n"
    },
    {
      "title": "Linux で FreeDOS 提供のディスクイメージ+USB メモリを使う",
      "level": 3,
      "content": "執筆時点(2017-07-11)では、unetbootinAUR は FreeDOS の1.0より新しいバージョンには対応していません(現在のバージョンは1.2です)。Inspiron 17-3737 を A09 BIOS にアップグレードするには、以下の手順でうまくいきました。(Dell はこれを提供しています こちらのサイト)\n\n始める前にいくつか注意点があります。\n\n- 現在の BIOS のバージョンは dmidecode で確認することができます。すでに最新版になっている可能性もあります。\n- ハードウェアベンダがこの方法がうまくいくことを確認していること(BIOS アップデート .exe を実行するために FreeDOS を使用すること。)\n- ノートパソコンのユーザーは AC 電源なしでこれを試みてはいけない\n- 危険ですので、この手順を実行する場合は、すべてのリスクを負うことを理解して下さい。\n\n手順\n\n1. FreeDOS ダウンロードページ から最新の USB インストーラを入手する。 著者注:full バージョンを使用したのは、より多くのドライバなどが含まれているのではないかという疑惑からです(純粋な推測です。)\n1. アーカイブを展開すると、.img ファイルができます。\n1. /dev/sdX のどれが自分の USB メモリか判断する (fdisk -l を使う)\n1. イメージをブロックデバイスに直接書き込む。 dd if=FD12FULL.img of=/dev/sdX status=progress\n1. ブロックデバイスに直接イメージを書き込む。(ここで X はブロックデバイスとしての USB メモリを表す文字です。パーティションにイメージを書き込まないでください)\n1. イメージのコピーがうまくいったかどうかダブルチェックしてください。 fdisk -l です。(起動可能 (\"boot\") フラグが設定されたDOSディスクの1つのパーティションが表示されるはずです)\n1. パーティションをマウントし、ファームウェアのアップデートに使用した .exe をコピーしてください。 ファイル名は8文字以内(拡張子なし)、大文字でお願いします。 ハードウェアベンダから提供されたチェックサムを検証していることを確認します。\n1. アンマウントしてリブート USB ドライブから起動するために必要なことは何でもしてください。\n\n- 著者注:full バージョンを使用したのは、より多くのドライバなどが含まれているのではないかという疑惑からです(純粋な推測です。)\n\n- dd if=FD12FULL.img of=/dev/sdX status=progress\n\n- fdisk -l です。(起動可能 (\"boot\") フラグが設定されたDOSディスクの1つのパーティションが表示されるはずです)\n\n- ファイル名は8文字以内(拡張子なし)、大文字でお願いします。\n- ハードウェアベンダから提供されたチェックサムを検証していることを確認します。\n\nこれで FreeDOS のライブインストール環境が整いました。\n\n1. 言語を選択する\n1. FreeDOS のインストールを促すプロンプトが表示されます。 \"いいえ - DOS に戻る\" を選択します。\n1. プロンプトが表示されるはずです (C:\\>)\n1. ファームウェアアップグレードツールが存在することを確認します。\n1. 実行ファイルを実行する 著者注:Dell のツールの場合、マシンはスプラッシュスクリーンを表示した後、再起動しました。再起動後、自動的にファームウェアのアップグレードが開始され、ファンをフル回転させた状態で2分ほど実行されました)\n1. ベンダー固有のプロセスが完了したら、オプションで BIOS セットアップ画面や、Linux に戻ったときに dmidecode を実行して確認することができます。\n\n- \"いいえ - DOS に戻る\" を選択します。\n\n- 著者注:Dell のツールの場合、マシンはスプラッシュスクリーンを表示した後、再起動しました。再起動後、自動的にファームウェアのアップグレードが開始され、ファンをフル回転させた状態で2分ほど実行されました)\n\n"
    },
    {
      "title": "FreeDOS 提供のディスクイメージ+USB メモリを Windows で使用する場合",
      "level": 3,
      "content": "この手順の著者は、Linux で dd を使用する前の方法で USB の FAT パーティションタイプをマウントする際にいくつかの問題に遭遇しました。この手順では、FreeDOS と USBメモリと Ruckus を使って、Windows 7/8/8.1/10 上で BIOS をフラッシュする方法の概要を説明します。この手順は、Dell Inspiron 5547 LaptopでBIOS A10 から A12 にアップグレードするために 2019年7月4日 に実行されました。\n\n前提条件として\n\n- Windows 用 Rufus をダウンロードし、インストールします。これは、フルインストールまたはポータブルバージョンのいずれかを使用できます。\n- FreeDOS 用の最新の Full USB インストーラ (執筆時点では v1.2) をダウンロード。\n- 最新の BIOS アップデートをベンダーのウェブサイトからダウンロードしてください。\n- dmidecode がインストールされていることが前提です。\n\n手順\n\n1. FD12FULL.zip アーカイブの内容を展開し、.img ファイルに注目する\n1. フラッシュドライブを挿入し、FD12FULL.imgファイルをRufusを使用してフラッシュし、すべてのデフォルトオプションを残す。 Rufus の詳細な使用方法は本ガイドでは扱いません。詳しい使い方は Rufus のマニュアルやドキュメントを参照してください。\n1. Rufus でフラッシュしたら、BIOS ファイルの名前を 8 文字の大文字に変更し (拡張子は含まず)、フラッシュドライブにコピーしてください。\n1. フラッシュドライブを取り出し、ノートパソコンに差し込んでください。\n1. LEGACY BOOT で USB から起動するために必要な手順は何でも実行する。 著者注: 私の Dell Laptop では、F12 を押してブートオプションを選び、Legacy Options の下で USB Storage Device を選択しています。私は BIOS から明示的にレガシーブートを有効にしていますが、システムが UEFI で起動するようにしか設定されていない場合、このオプションは表示されないかもしれません。\n1. FreeDOS のインストール環境が表示されます。 優先言語を選択 次の画面で いいえ - DOSに戻る を選択します。 USB フラッシュドライブの内容を表示するには dir と入力します。 BIOS アップグレードファイルを実行するには、ファイル名を入力し、エンターキーを押すだけです。 注:私のアップグレードは、ファンをフル回転させて2分未満で完了しました。システムの再起動は合計3回です。\n1. アップグレードが完了し、システムが OS に戻って起動したら、root で dmidecode | grep -E 'BIOS{!Version'}} を発行して BIOS バージョンがアップグレードされたことを確認する。\n\n- Rufus の詳細な使用方法は本ガイドでは扱いません。詳しい使い方は Rufus のマニュアルやドキュメントを参照してください。\n\n- 著者注: 私の Dell Laptop では、F12 を押してブートオプションを選び、Legacy Options の下で USB Storage Device を選択しています。私は BIOS から明示的にレガシーブートを有効にしていますが、システムが UEFI で起動するようにしか設定されていない場合、このオプションは表示されないかもしれません。\n\n- 優先言語を選択\n- 次の画面で いいえ - DOSに戻る を選択します。\n- USB フラッシュドライブの内容を表示するには dir と入力します。\n- BIOS アップグレードファイルを実行するには、ファイル名を入力し、エンターキーを押すだけです。\n- 注:私のアップグレードは、ファンをフル回転させて2分未満で完了しました。システムの再起動は合計3回です。\n\n"
    },
    {
      "title": "イメージがフロッピーに収めるには大きすぎる",
      "level": 3,
      "content": "フラッシュイメージがフロッピーには大きすぎる場合、FreeDos bootdisk ウェブサイト に行って、10Mb のハードディスクイメージをダウンロードしてください。このイメージは完全なディスクイメージで、パーティションを含んでいるため、フラッシュユーティリティを追加するのはすこし手間が要ります:\n\nまず最初のパーティションを確認してください (これを書いている時点では、最初のパーティションはブロック63から始まっています。つまりパーティションはオフセット 512 * 63 = 32256 からです)。次のコマンドを実行:\n\n```\n# file -sk <image-file> | sed -r 's/.*startsector ([0-9]+).*/\\1/'\n63\n```\n\nもしくは:\n\n```\n# fdisk -l <image-file>\n...\nUnits = sectors of 1 * 512 = 512 bytes\n...\n      Device  Boot  Start    End  Blocks  Id  System\n              *        63  19151   9544+   1  FAT12\n```\n\nそしてイメージをマウントします:\n\n```\n# mount -oloop,offset=$((63 * 512)) <image-file> /mnt\n```\n\nこれで通常通りにファイルシステムにフラッシュユーティリティをコピーできます。完了したら:\n\n```\n# umount /mnt\n```\n\n通常の手順どおり USB スティックにイメージをコピーするか、memdisk として起動することが可能です。\n\n"
    },
    {
      "title": "使用方法",
      "level": 3,
      "content": "OEM Bootdisk バージョンを推奨します。kernel と command.com しか含まれておらずフラッシュユーティリティや新しい BIOS イメージのための領域が存在するからです。FreeDOS イメージをダウンロードして解凍:\n\n```\n$ wget http://www.fdos.org/bootdisks/autogen/FDOEM.144.gz\n$ gunzip FDOEM.144.gz\n```\n\nフロッピーディスクイメージをマウントしてBIOS フラッシュユーティリティと新しい BIOS イメージをコピーします。必要なモジュールをロード:\n\n```\n# modprobe vfat\n# modprobe loop\n```\n\n/proc/fileystems で必要なファイルシステムがサポートされているかどうか表示されます。フロッピーディスクイメージを一時的なパスにループマウント:\n\n```\n$ mkdir /tmp/floppy\n$ mount -t vfat -o loop FDOEM.144 /tmp/floppy\n```\n\nマウントで何もエラーが出なかったら、BIOS フラッシュユーティリティと新しい BIOS イメージをコピーしてください。マザーボードのメーカーサイトからダウンロードした圧縮ファイルを解凍したら、おそらく2つのファイルが作られるはずです。例:\n\n```\n# unzip 775Dual-VSTA\\(2.60\\).zip\nArchive: 775Dual-VSTA(2.60).zip\n inflating: 75DVSTA2.60\n inflating: ASRflash.exe\n# cp 75DVSTA2.60 ASRflash.exe /tmp/floppy\n```\n\n2つのファイルがフロッピーに収まることを確認:\n\n```\nFilesystem           1K-blocks      Used Available Use% Mounted on\n/tmp/FDOEM.144\n                         1424       990       434  70% /tmp/floppy\n```\n\nフロッピーディスクイメージをアンマウント:\n\n```\n# umount /tmp/floppy\n```\n\n次に CD/DVD-RW メディアにフロッピーイメージを書き込みます。後で起動できるように注意してください。まずブータブル CD イメージを作成して、焼き込み:\n\n```\n# genisoimage -o bootcd.iso -b FDOEM.144 FDOEM.144\n# wodim -v bootcd.iso\n```\n\nまたは GRUB のメニューにイメージを追加することもできます。Syslinux をインストールして memdisk とイメージを /boot にコピー:\n\n```\n# cp /usr/lib/syslinux/memdisk /boot\n# cp FDOEM.144 /boot/flashbios.img\n```\n\nそしてエントリを /boot/grub/menu.lst に追加:\n\n```\ntitle Flash BIOS\n kernel /memdisk\n initrd /flashbios.img\n```\n\nあるいは GRUB2 の場合、/boot/grub/grub.cfg に追加:\n\n```\nmenuentry \"Flash BIOS\" {\n linux16 /boot/memdisk\n initrd16 /boot/flashbios.img\n }\n```\n\nあるいは Syslinux の場合、/boot/syslinux/syslinux.cfg に追加:\n\n```\nLABEL flashbios\n\tMENU LABEL Flash BIOS\n\tLINUX ../memdisk\n\tINITRD ../fdboot.img\n```\n\n最後にマシンを再起動して、ブートの順序で CD ドライブが一番最初に来ることを確認して、CD を起動したら BIOS アップグレードを実行してください。GRUB メニューを使う場合、リストの新しいエントリを選択すれば FreeDOS が起動します。\n\n"
    },
    {
      "title": "ブータブル光学ディスクのエミュレーション",
      "level": 2,
      "content": "Geteltorito.pl スクリプトは El Torito 起動イメージを抽出します。X220, X230, X260, W540, T450, T450s などの Lenovo のノートパソコンで使えることを確認済みです。他のメーカーでも利用できるかもしれません。\n\n"
    },
    {
      "title": "インストール",
      "level": 3,
      "content": "geteltoritoAUR パッケージをインストールしてください。\n\n"
    },
    {
      "title": "使用方法",
      "level": 3,
      "content": "メーカーのサポートサイトから BIOS アップデート ISO を取得してください。geteltorito のイメージ抽出を実行:\n\n```\n$ geteltorito.pl -o <image>.img <image>.iso\n```\n\nイメージを usb メモリにコピー:\n\n```\n# dd if=<image>.img of=<destination> bs=512K\n```\n\n再起動して USB メモリから起動し、メーカーの指示に従ってください。\n\n"
    },
    {
      "title": "Windows PE",
      "level": 2,
      "content": "もし、メーカーが exe ファイルしか提供せず、事前のアドバイスに従わなかった場合、Windows PE フラッシュドライブを作成し、そこから通常通り BIOS アップデートをフラッシュすることができます。\n\n"
    },
    {
      "title": "使用方法",
      "level": 3,
      "content": "ISO Windows PE をダウンロードし、起動可能なドライブを作成します。\n\nその USB を起動し、メーカーサイトでそれぞれのアップデートをダウンロードし、通常通り実行します。\n\n"
    },
    {
      "title": "HP",
      "level": 3,
      "content": "HP BIOS の一部、特にビジネスラインで利用可能なもの - ProDesk 600、EliteDesk 800、Thin Client (T620, T730 など) - には、BIOS 内から BIOS をアップデートするオプションがあります。このオプションは通常Fileメニューの下にあり、\"Flash System ROM \"と呼ばれています。2つの異なるディレクトリ構造があり、動作するようです。お使いの BIOS はどちらのディレクトリ構造でも動作する場合としない場合があります。\n\n1. FAT32 でフォーマットされた USB ドライブのルートに BIOS *.bin ファイルを置き、他のディレクトリを作らない。他のファイルは必要ありません。\n1. 説明されているようなディレクトリ構造を使用する こちら\n\n上記のいずれのディレクトリ構造もうまくいかないようであれば、HP があなたの BIOS バージョンに関連する DOS 実行ファイルを提供している場合は FreeDOS 法を使用するか、Windows マシンで HP BIOS Flash Recovery USB をまず作成し、その USB を使って同じ Flash System ROM オプションを使って BIOS をフラッシュすることになります。\n\n手順\n\n1. シリアル番号と OS として Windows を指定して、HP のサポートウェブサイトから BIOS 実行ファイルをダウンロードします。\n1. この exe ファイルはアーカイブになっており、7z を使って解凍することができます。 7z e <filename>.exe\n1. 上記のように USB 内に適切なディレクトリ構造を作成する。片方でうまくいかない場合は、もう片方を試す\n1. USB をアンマウントする\n1. BIOS のアップグレードが必要なコンピュータに取り付ける(USB ドライブを作成するために別のコンピュータを使用する場合。)\n1. コンピュータを再起動し、BIOS に割り当てられたキー (例:F10) を使って BIOS に入る。\n1. BIOS に入ったら、Flash System ROM オプションを見つけて選択します。次の3つのオプションからフラッシュすることができます。 USB Hard disk Network\n1. 適切なオプション(この場合は USB)を選択すると、USB ドライブのルートに置いた BIN ファイルのファイル名が書かれた別のテキストボックスがポップアップ表示されます。\n\n- 7z e <filename>.exe\n\n- USB\n- Hard disk\n- Network\n\nこのとき、USB ドライブのルートに置いた BIN ファイルのファイル名が表示されます。Enter キーを押すと、現在の BIOS のバージョンとアップグレードする新しいバージョンが表示されます。\n\n1. 画面の指示に従って BIOS をアップグレードし、最後に再起動します。\n\n一部のモデル、特に 2010 年から 2014 年頃のモデルでは、実行ファイルを解凍すると、BIOS ファイルとそのファイルの RSA 署名を含む .fd で終わるファイルが生成されます。 この.fdファイルから展開する方法が公開されており、ツールもいくつか公開されています。これらのファイルを解凍して USB メモリに入れたら、それを使ってアップデートを実行することができます。ファームウェアアップデートのユーザーインターフェイスでファイルへの移動が可能な場合もあるが、特定のディレクトリに特定の名前で配置する必要がある場合もある。BIOS ファイルには通常 .bin' という接尾辞が付き、署名ファイルには .sig または .s12 という接尾辞が付きます。HP ENVY m4-1015dx のページでは、そのようなモデルの具体的な詳細を説明しています。\n\n"
    },
    {
      "title": "ASUS",
      "level": 3,
      "content": "最新の Asus マザーボードでは、ファームウェアのアップデートに Windows は必要ありません。内蔵ユーティリティ Ez-Flash を使用して BIOS 内から BIOS を更新できます。ただし、彼らは BIOS を更新する前に ME をアップデートするように 求めています 問題は、アーカイブに Linux アップデートツールが含まれていないことです (例)\n\nBIOS が最新バージョンであっても、とにかく ME をアップデートする必要があります。スリープから復帰できないなどのハードウェアの問題を回避することが重要です。\n\nシステムツールを ここから ダウンロードします。特定のマザーボードでは、最新 (v15) バージョンは動作しませんでした (Unknown PCH platform) 推奨されているように ここから、v11 バージョンを使用すると機能しました。アーカイブ (\"CSME System Tools v11 r46/FWUpdate/LINUX64/FWUpdLcl\") から Linux 実行可能ファイルを抽出し、Asus サイト (MEUpdateTool_11.8.80.3746v5_S/FW/) からダウンロードしたアーカイブ内のファームウェアが含まれるフォルダーに配置して \"FWUpdLcl\" を実行可能にします。\n\nShow usage\n\n```\n$ ./FWUpdLcl\n```\n\n```\nIntel (R) Firmware Update Utility Version: 11.8.92.4222\nCopyright (C) 2007 - 2022, Intel Corporation.  All rights reserved.\n\nFWUpdLcl.exe [-H|?] [-VER] [-EXP] [-VERBOSE] [-F] [-Y] [-SAVE] \n             [-FWVER] [-PARTID] [-ALLOWSV] [-FORCERESET] [-OEMID] [-PASS] \n             [-PARTVER] \n\n-H|?                    Displays help screen. \n-VER                    Displays version information. \n-EXP                    Displays example usage of this tool. \n-VERBOSE<file>          Display the debug information of the tool. \n-F <file>               File used for updating the FW. \n-Y                      Automatically answer Yes to prompts. \n-SAVE <file>            Save the current FW to an update image. \n-FWVER<file>            Display the FW Version of current FW or update image. \n-PARTID<Partition ID>   Provide specific Partition ID to perform partial update. \n-ALLOWSV                Allows same version firmware updates. \n-FORCERESET             Automatically Reboots system after update (if needed). \n-OEMID <UUID>           OEM ID needed to perform firmware update. \n-PASS <pass>            MeBX password. Optional with the '-f' option.  \n-PARTVER <Partition ID> Display the Version of specific partition.\n```\n\n現在の ME バージョンを表示します:\n\n```\n$ sudo ./FWUpdLcl -FWVER\n```\n\n```\nIntel (R) Firmware Update Utility Version: 11.8.92.4222\nCopyright (C) 2007 - 2022, Intel Corporation.  All rights reserved.\n\nFW Version: 11.8.65.3590\n```\n\nダウンロードしたアーカイブ内のファイルの ME バージョンを表示します:\n\n```\n$ ./FWUpdLcl -FWVER ME.bin\n```\n\n```\nIntel (R) Firmware Update Utility Version: 11.8.92.4222\nCopyright (C) 2007 - 2022, Intel Corporation.  All rights reserved.\n\nFW Version: 11.8.80.3746\n```\n\n書き込みをスタート:\n\n```\nsudo ./FWUpdLcl -F ME.bin\n```\n\n```\nIntel (R) Firmware Update Utility Version: 11.8.92.4222\nCopyright (C) 2007 - 2022, Intel Corporation.  All rights reserved.\n\nCommunication Mode: MEI\nChecking firmware parameters...\n\nWarning: Do not exit the process or power off the machine before the firmware update process ends.\nSending the update image to FW for verification:  [ COMPLETE ] \n\n\n\nFW Update:  [ 100% (/)]Do not Interrupt\nFW Update is completed successfully.\n```\n\n新しいバージョンを表示するには、再起動する必要があります。これで、適用されたバージョンが表示されます:\n\n```\nsudo ./FWUpdLcl -FWVER\n```\n\n```\nIntel (R) Firmware Update Utility Version: 11.8.92.4222\nCopyright (C) 2007 - 2022, Intel Corporation.  All rights reserved.\n\nFW Version: 11.8.80.3746\n```\n\n"
    },
    {
      "title": "Lenovo",
      "level": 3,
      "content": "一部のファームウェア更新は、Windows 実行可能形式でのみ提供されます。このセクションでは、例として Lenovo IdeaPad L340-15API ファームウェアを使用します。これらの手順を別のシステムに適用しようとすると、結果が変わる可能性があります。Lenovo IdeaPad L340-15API は、Lenovo サポート サイトで \".exe\" のみを提供します。これにより、記事内の多くのメソッドだけでなく、すべてのメソッドが無効になります。\n\n- Wine:危険です、IdeaPad のファームウェアが \"TDK library \"エラーで失敗しました。これについては後述します。\n- セキュアブート 禁止署名データベース (dbx) などの他のエントリが存在する場合でも、ファームウェアが LVFS 上にないため、fwupd だけでは機能しません。\n- BiosDisk は \"BIOS 実行可能ファイル\"でのみ動作し、私たちの実行可能ファイルでは動作しません。\n- Flashrom はラップトップでは使用しないようにとの警告があります。多くのシステム、そして IdeaPad も含めて、そのハードウェアリストではサポートされていません。\n- FreeDOS が動作するためには、ファームウェアが DOS 実行ファイルである必要があります。もし、あなたのファームウェアの実行ファイルが、議論されている IdeaPad のようなものであれば、DOS ヘッダで始まる最新のWindows 実行ファイルであっても、FreeDOS ではまったく動作しません。\n- geteltorito.pl は ISO がある場合のみ動作します。\n- Windows PE でも非互換性の問題が発生するかもしれません。特に、インストーラはオペレーティングシステムの互換性をチェックしているため、実行できないかもしれません。\n\n1. IdeaPad のファームウェアのダウンロードはインストーラー形式で提供され、特に Inno Setup によってセットアップ されます。 Wine などでインストーラーを実行して抽出する代わりに、innoextract ツールを使用します。: $ innoextract installer.exe\n1. 別の実行可能ファイルの中にあります。この内部 IdeaPad 実行可能ファイルも、FreeDOS または Windows PE では動作しません。ただし、前述の TDK ライブラリのエラーに注意してください。TDK は、Technologies によって作成されたファームウェア開発キットを指します。badcaps フォーラム で、実行可能ファイル自体が /ext 引数を使用してコンテンツを抽出することが記載されています。したがって、Wine を使用して、$ wine firmware.exe /ext を実行します。あるいは、7z を使用しても機能することが報告されています: $ 7z x firmware.exe\n\n```\n$ innoextract installer.exe\n```\n\n```\n$ wine firmware.exe /ext\n```\n\n```\n$ 7z x firmware.exe\n```\n\nこの .exe ファイルには、さらに多くの .exe ファイルがあることがわかります。これらはいずれも FreeDOS または Windows PE では動作しません。ただし、ファームウェア自体は、bladecoder のブログ で提案されている UEFI カプセル アップデート形式であることに注意してください。\n\n1. 抽出されたファイルから、.cap ファイルを探します。 また、一部のモデルでは .fd ファイルが使用されます。\n1. UEFI カプセルを入手したら、次のステップは手動でインストールしてみます。そのブログで言及されているように、fwupd がこれに役立ちます。fwupdate は fwupd パッケージでは提供されていませんが、fwupdtool は同じタスクを実行します。まず、ファームウェアのデバイス ID を特定します: # fwupdtool get-devices\n1. デバイスの出力で ID を見つけて、手動インストールで使用します: # fwupdtool install-blob BIOS.ext DEVICE-ID\n1. プロンプトが表示されたら再起動します。画面が完全に黒くなる場合があります。インストールが完了するまで待ちます。\n1. EFI ブートリストは更新後にクリアされます。まず、UEFI 設定を以前の設定に更新します。\n1. 最後に、外部ブートメディアを使用してブートローダーを再インストールします。\n\n- 抽出されたファイルから、.cap ファイルを探します。\n- また、一部のモデルでは .fd ファイルが使用されます。\n\n```\n# fwupdtool get-devices\n```\n\n```\n# fwupdtool install-blob BIOS.ext DEVICE-ID\n```\n\n"
    }
  ]
}