{
  "title": "Password Recovery (日本語)",
  "url": "https://wiki.archlinux.org/title/Password_Recovery_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "このページでは忘れてしまった root パスワードをリカバリする方法を記述します。複数の方法があります。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 sudo を使用する\n- 2 デバッグシェルの使用方法\n- 3 bash を init として使用する場合\n- 4 LiveCD を使う 4.1 Change Root\n- 5 参照\n\n- 4.1 Change Root\n\n"
    },
    {
      "title": "sudo を使用する",
      "level": 2,
      "content": "sudo をインストールし、wheel グループまたはパスワードを覚えているユーザに権限を設定した場合、sudo passwd root を実行して root パスワードを変更することができます。\n\n"
    },
    {
      "title": "デバッグシェルの使用方法",
      "level": 2,
      "content": "1. systemd.debug_shell を カーネルパラメータ に追加します。\n1. これにより、通常のブートが行われますが、tty9 でルートシェル (/bin/sh) を実行する debug-shell.service が開始されます。Ctrl+Alt+F9 を押してアクセスします。\n1. passwd コマンドを使用して、root ユーザの新しいパスワードを作成します。\n1. 完了したら debug-shell.service を 停止 します。\n\n"
    },
    {
      "title": "bash を init として使用する場合",
      "level": 2,
      "content": "1. ブートローダのブートエントリに init=/bin/bash カーネルパラメータ を追加してください。\n1. ルートファイルシステムが読み込み専用でマウントされているので、読み込み/書き込みで 再マウントしてください。mount -n -o remount,rw /\n1. passwd コマンドを使って、root ユーザの新しいパスワードを作成します。\n1. reboot -f と入力して再起動、パスワードを再度紛失しないようにしてください。\n\n"
    },
    {
      "title": "LiveCD を使う",
      "level": 2,
      "content": "LiveCD では、root を変更して passwd コマンドを使う方法と、パスワードファイルを直接編集してパスワードフィールドの入力を消去する方法の2つが利用できます。Linux が動作する LiveCD であれば、どのようなものでも使用できますが、root を変更するためには、インストールされているアーキテクチャの種類と一致する必要があります。パスワードファイルを手動で編集するのはかなり危険なので、ここでは chroot でパスワードをリセットする方法のみを説明します。\n\n"
    },
    {
      "title": "Change Root",
      "level": 3,
      "content": "1. LiveCD を起動してメインシステムのルートパーティションを マウント して下さい。\n1. passwd --root mountpoint username コマンドでパスワードを再設定します。このとき従来のパスワードは尋ねられません。\n1. ルートパーティションのマウントを解除してください。\n1. 再起動して、先に設定したパスワードを使います。\n\n"
    },
    {
      "title": "参照",
      "level": 2,
      "content": "- このガイドに例が載っています。\n- Early Debug Shell\n\n"
    }
  ]
}