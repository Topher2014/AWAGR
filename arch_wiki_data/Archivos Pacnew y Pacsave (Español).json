{
  "title": "Archivos Pacnew y Pacsave (Español)",
  "url": "https://wiki.archlinux.org/title/Archivos_Pacnew_y_Pacsave_(Espa%C3%B1ol)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Note: **2018-12-21** \n\nCuando pacman elimina un paquete que tiene un archivo de configuración, normalmente crea una copia de respaldo de ese archivo de configuración y agrega .pacsave al nombre del archivo. Del mismo modo, cuando pacman actualiza un paquete que incluye un nuevo archivo de configuración creado por el mantenedor que difiere del archivo que se instala, guarda un archivo .pacnew con la nueva configuración. pacman avisa de estas operacoines cuando se escriben dichos archivos.\n\n"
    },
    {
      "title": "Por qué se crean estos archivos",
      "level": 2,
      "content": "Se puede crear un archivo .pacnew durante la actualización de un paquete (con pacman -Syu, pacman -Su o pacman -U) para evitar sobrescribir un archivo que ya existe y fue modificado previamente por el usuario. Cuando esto sucede, aparecerá un mensaje como el siguiente en la salida de pacman:\n\n```\nadvertencia: /etc/pam.d/usermod instalado como /etc/pam.d/usermod.pacnew\n```\n\nSe puede crear un archivo .pacsave durante la eliminación de un paquete (con pacman -R), o mediante una actualización del paquete (el paquete debe eliminarse primero). Cuando la base de datos de pacman tiene registro de que se debe hacer una copia de seguridad de un determinado archivo que pertenece a un paquete, se creará un archivo .pacsave. Cuando esto sucede, pacman envía un mensaje como el siguiente:\n\n```\nadvertencia: /etc/pam.d/usermod guardado como /etc/pam.d/usermod.pacsave\n```\n\nEstos archivos requieren la intervención manual del usuario y es una buena práctica manejarlos inmediatamente después de cada actualización o eliminación de un paquete. Si no se manejan, las configuraciones incorrectas pueden dar como resultado un mal funcionamiento del software, o que el mismo no se ejecute al completo.\n\n"
    },
    {
      "title": "Copias de seguridad de archivos de paquetes",
      "level": 2,
      "content": "El archivo PKGBUILD de un paquete especifica qué archivos deben conservarse o respaldarse cuando el paquete se actualiza o se elimina. Por ejemplo, PKGBUILD para pulseaudio contiene la siguiente línea:\n\n```\nbackup=('etc/pulse/client.conf' 'etc/pulse/daemon.conf' 'etc/pulse/default.pa')\n```\n\nPara evitar que cualquier paquete sobrescriba un archivo determinado, consulte Pacman (Español)#Evitar la instalación de archivos en el sistema.\n\n"
    },
    {
      "title": ".pacnew",
      "level": 3,
      "content": "Para cada uno de las #Copias de seguridad de archivos de paquetes que se están actualizando, pacman compara tres md5sums generados a partir del contenido del archivo: una suma para la versión instalada originalmente por el paquete, otra para la versión actualmente en el sistema de archivos y otra última para la versión en el nuevo paquete. Si la versión del archivo que se encuentra actualmente en el sistema de archivos se modificó con respecto a la versión instalada originalmente por el paquete, pacman no puede saber cómo combinar esos cambios con la nueva versión del archivo. Por lo tanto, en lugar de sobrescribir el archivo modificado al actualizar, pacman guarda la nueva versión con una extensión .pacnew y deja la versión modificada sin tocar.\n\nPara más detalles, la comparación de la suma MD5 a tres bandas dará uno de los siguientes resultados:\n\n"
    },
    {
      "title": ".pacsave",
      "level": 3,
      "content": "Si el usuario ha modificado uno de los archivos especificados en backup, ese archivo cambiará de nombre con una extensión .pacsave y permanecerá en el sistema de archivos después de que se elimine el resto del paquete.\n\n"
    },
    {
      "title": "Localizar archivos .pac*",
      "level": 2,
      "content": "pacman no trata los archivos .pacnew automáticamente: deben mantenerse por el usuario. Algunas herramientas se presentan en la siguiente sección. Para hacer esto manualmente, primero necesitará localizarlos. Al actualizar o eliminar una gran cantidad de paquetes, se pueden perder los archivos .pac* actualizados. Para descubrir si se ha instalado algún archivo .pac*, use una de la órdenes siguientes:\n\n- Para buscar dentro de /etc donde se almacenan la mayoría de las configuraciones globales: $ find /etc -regextye posix-extended -regex \".+\\.pac(new|save)\" 2> /dev/null o para buscar en todo el disco, sustituya /etc por / en la orden anterior\n- Si está instalado, locate también se puede usar. Primero vuelva a indexar la base de datos: # updatedb Luego ejecute: $ locate --existing --regex \"\\.pac(new|save)$\"\n- Utilice el registro de pacman para encontrarlos: $ grep --extended-regexp \"pac(new|save)\" /var/log/pacman.log Tenga en cuenta que el registro no pierde de vista los archivos que se encuentran actualmente en el sistema de archivos ni los que ya se han eliminado; la orden anterior mostrará una lista de todos los archivos .pac* que hayan existido en su sistema. Para obtener solo los 10 archivos .pac* más recientes, canalice el resultado con tail.\n\n```\n$ find /etc -regextye posix-extended -regex \".+\\.pac(new|save)\" 2> /dev/null\n```\n\n```\n# updatedb\n```\n\n```\n$ locate --existing --regex \"\\.pac(new|save)$\"\n```\n\n```\n$ grep --extended-regexp \"pac(new|save)\" /var/log/pacman.log\n```\n\n"
    },
    {
      "title": "pacdiff",
      "level": 3,
      "content": "pacman-contrib proporciona una sencilla herramienta, pacdiff, para gestionar archivos pacnew/pacsave. Buscará todos los archivos .pacnew y .pacsave y solicitará cualquier acción sobre ellos. Utiliza vimdiff de forma predeterminada, pero puede especificar una herramienta diferente con DIFFPROG=your_editor pacdiff. Vea List of applications/Utilities#Comparison, diff, merge para otras herramientas de comparación comunes.\n\n"
    },
    {
      "title": "Utilidades de terceros",
      "level": 3,
      "content": "En AUR (Español) dispone de algunas utilidades de terceros que proporcionan varios niveles de automatización para estas tareas.\n\nAlgunas de dichas herramientas son las siguientes:\n\n- dotpac — Script interactivo básico con una interfaz de texto basada en ncurses y un tutorial útil. No proporciona características de fusión o fusión automática.\n\n- etc-update — Puerto de Arch de la utilidad etc-update de Gentoo, que proporciona un CLI simple para ver, combinar y editar interactivamente los cambios. Los cambios triviales (como los comentarios) pueden ser mezclados automáticamente.\n\n- pacnews-git — Un script simple destinado a encontrar todos los archivos .pacnew, para luego editarlos con vimdiff.\n\n"
    }
  ]
}