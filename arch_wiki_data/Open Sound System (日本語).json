{
  "title": "Open Sound System (日本語)",
  "url": "https://wiki.archlinux.org/title/Open_Sound_System_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Open Sound System (OSS) は Unix ライクな POSIX 互換のシステム向けのもうひとつのサウンドアーキテクチャです。OSS バージョン 3 は Linux のデフォルトのサウンドシステムでしたが、OSS バージョン 4 がプロプライエタリソフトウェアになったことで2002年に Advanced Linux Sound Architecture (ALSA) に取って代わられました。2007年には 4Front Technologies がソースコードを公開し GPL ライセンスでリリースしたことで OSSv4 はまたフリーソフトウェアになっています。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 ALSA との比較 1.1 OSS の利点 (ユーザー) 1.2 OSS の利点 (開発者) 1.3 OSS に対する ALSA の優位点\n- 2 インストール\n- 3 テストする\n- 4 ボリュームコントロールミキサー 4.1 色の定義 4.2 ミキサーのレベルを保存する 4.3 他のミキサー\n- 5 OSS を使うようにアプリケーションを設定する 5.1 GStreamer を使用するアプリケーション 5.2 OpenAL を使用するアプリケーション 5.3 Audacity 5.4 Gajim 5.5 MOC 5.6 MPD 5.7 MPlayer 5.8 Skype 5.9 VLC media player 5.10 Wine 5.11 他のアプリケーション\n- 6 ヒントとテクニック 6.1 OSS でマルチメディアキーを使う 6.2 サンプルレートを変更する 6.3 シンプルなシステムトレイアプレット 6.4 起動時にシステムトレイの中に ossxmix を実行する 6.4.1 KDE 6.4.2 Gnome 6.5 プログラムからの音声出力を録音する 6.6 サスペンドとハイバネーション 6.7 デフォルトの音声出力を変更する 6.8 Creative Sound Blaster X-Fi Surround 5.1 SB1090 USB 6.9 ALSA のエミュレーション 6.9.1 手順 6.10 特定のドライバーにあわせた設定\n- 7 トラブルシューティング 7.1 HD Audio デバイスのトラブルシューティング 7.1.1 問題の所在 7.1.2 解決方法 7.2 Totem で MMS の音にノイズが乗る 7.3 マイクロフォンが出力チャンネルで再生される\n- 8 参照\n\n- 1.1 OSS の利点 (ユーザー)\n- 1.2 OSS の利点 (開発者)\n- 1.3 OSS に対する ALSA の優位点\n\n- 4.1 色の定義\n- 4.2 ミキサーのレベルを保存する\n- 4.3 他のミキサー\n\n- 5.1 GStreamer を使用するアプリケーション\n- 5.2 OpenAL を使用するアプリケーション\n- 5.3 Audacity\n- 5.4 Gajim\n- 5.5 MOC\n- 5.6 MPD\n- 5.7 MPlayer\n- 5.8 Skype\n- 5.9 VLC media player\n- 5.10 Wine\n- 5.11 他のアプリケーション\n\n- 6.1 OSS でマルチメディアキーを使う\n- 6.2 サンプルレートを変更する\n- 6.3 シンプルなシステムトレイアプレット\n- 6.4 起動時にシステムトレイの中に ossxmix を実行する 6.4.1 KDE 6.4.2 Gnome\n- 6.5 プログラムからの音声出力を録音する\n- 6.6 サスペンドとハイバネーション\n- 6.7 デフォルトの音声出力を変更する\n- 6.8 Creative Sound Blaster X-Fi Surround 5.1 SB1090 USB\n- 6.9 ALSA のエミュレーション 6.9.1 手順\n- 6.10 特定のドライバーにあわせた設定\n\n- 6.4.1 KDE\n- 6.4.2 Gnome\n\n- 6.9.1 手順\n\n- 7.1 HD Audio デバイスのトラブルシューティング 7.1.1 問題の所在 7.1.2 解決方法\n- 7.2 Totem で MMS の音にノイズが乗る\n- 7.3 マイクロフォンが出力チャンネルで再生される\n\n- 7.1.1 問題の所在\n- 7.1.2 解決方法\n\n"
    },
    {
      "title": "ALSA との比較",
      "level": 2,
      "content": "Advanced Linux Sound Architecture を使用するのと比較したメリットとデメリット。\n\n"
    },
    {
      "title": "OSS の利点 (ユーザー)",
      "level": 3,
      "content": "- アプリケーションごとにボリュームをコントロールできます。\n- 古いカードによってはサポートが優れている場合があります。\n\n"
    },
    {
      "title": "OSS の利点 (開発者)",
      "level": 3,
      "content": "- ユーザースペースでドライバーをサポートしています。\n- クロスプラットフォーム (OSS は BSD や Solaris でも動作します)。\n- クリーンで使いやすい API。\n\n"
    },
    {
      "title": "OSS に対する ALSA の優位点",
      "level": 3,
      "content": "- USB オーディオデバイスのサポートが優れています。\n- Bluetooth オーディオデバイスをサポートしています。\n- Si3055 などのダイアルアップ式のソフトウェアモデム、AC'97 や HD Audio をサポートしています。\n- MIDI デバイスのサポートが優れています。\n- サスペンドをサポートしています。\n- ジャック検出のサポートが優れています。\n- 現代的なハードドライブをより良くサポートしています。\n\n- OSS は USB オーディオデバイスへの出力を実験的にサポートしていますが、入力は使えません。\n- Timidity や FluidSynth などのソフトウェアシンセサイザーの助けを借りて OSS は MIDI デバイスをサポートします。\n\n"
    },
    {
      "title": "インストール",
      "level": 2,
      "content": "AUR から利用できる ossAUR をインストールしてください。他にも AUR には OSS の実験バージョンである oss-gitAUR パッケージもあります。\n\nOSS をインストールすると、OSS インストールスクリプトが走り (一時期に ALSA モジュールが無効になります) OSS カーネルモジュールがインストールされます。ブートスクリプトではデフォルトで ALSA が有効になっているので、OSS と衝突しないように無効にする必要があります。モジュールをブラックリストに入れることが無効にすることが可能です:\n\n```\n/etc/modprobe.d/alsa_blacklist.conf\n```\n\n```\ninstall soundcore /bin/false\n```\n\nモジュールをブラックリストに入れた後、oss デーモンを有効にすればブート時に起動するようにできます。\n\nユーザーが audio グループに入ってない場合は、グループに追加して変更を適用するために再ログインしてください:\n\n```\n# gpasswd -a $USER audio\n```\n\nOSS があなたのカードを起動時に検出しない場合は、以下を実行してください:\n\n```\n# ossdetect -v\n# soundoff && soundon\n```\n\n"
    },
    {
      "title": "テストする",
      "level": 2,
      "content": "次を実行して OSS をテストしてください:\n\n```\n$ osstest\n```\n\nこのテストでは音楽が聞こえるはずです。音がしない場合、ボリュームを調節したり #トラブルシューティング セクションを参照してください。\n\n複数のアプリケーションから同時に音声が聞こえるようにするには、OSS のソフトウェアミキサーである vmix が必要です。\n\n次を実行して vmix が有効になっているか確認してください:\n\n```\n$ ossmix -a | grep -i vmix\n```\n\nvmix0-enable ON|OFF (currently ON) のような行が表示されるはずです。もし vmix で始まる行が全く表示されない場合は、おそらくサウンドデバイスに vmix が結び付けられていません。vmix を使うには、次のコマンドを実行してください:\n\n```\n$ vmixctl attach device\n```\n\ndevice はあなたのサウンドデバイスに置き換えてください (例: /dev/oss/oss_envy240/pcm0)。\n\nこれからもこのコマンドを手動で実行する必要をなくすために、ここ で提案されているように、/usr/lib/oss/soundon.user にコマンドを追加することができます。\n\n\"Device or resource busy\" エラーが起こる場合、vmix_no_autoattach=1 を /usr/lib/oss/conf/osscore.conf に追加して再起動してください。\n\n次のコマンドを使って検出されているデバイスを確認してください:\n\n```\n$ ossinfo\n```\n\nDevice Objects や Audio Devices の下にあなたの使っているデバイスが表示されるはずです。使用したいデバイスがセクションの一番上にない場合、/usr/lib/oss/etc/installed_drivers を編集してデバイスのドライバーを一番上に記述してください。おそらく次を実行する必要があります:\n\n```\n$ soundoff && soundon\n```\n\nこれで動作しない場合、あなたの使っているデバイスを除く全てのドライバーをコメントアウトしてください。\n\n"
    },
    {
      "title": "ボリュームコントロールミキサー",
      "level": 2,
      "content": "様々なデバイスのボリュームをコントロールするには、ミキサーのレベルを設定する必要があります。2つのミキサーが存在します:\n\n- ossmix: コマンドラインのミキサー、BSD のオーディオミキサー mixerctl に似ています。\n- ossxmix: GTK+ ベースのグラフィカルミキサー。\n\n基本的な ossxmix のコントロールは以下のようになります:\n\n```\n/ High Definition Audio ALC262 \\    --------------------------------> 1\n/________________________________\\________________________________\n|                                                                 \\\n| [x] vmix0-enable [vmix0-rate: 48.000kHz]      vmix0-channels    |--> 2\n|                                               [ Stereo [v] ]    |\n|                                                                 |\n|  __codec1______________________________________________________ |\n| |  _jack______________________________________________________ ||--> 3\n| | |  _int-speaker_________________   _green_________________  |||\n| | | |                             | |                       | |||\n| | | |  _mode_____ | |             | |  _mode_____   | |     | |||\n| | | | [ mix [v] ] o o [x] [ ]mute | | [ mix  [v] ]  o o [x] | |||\n| | | |             | |             | |               | |     | |||\n| | | |_____________________________| |_______________________| |||\n| | |___________________________________________________________|||\n| |______________________________________________________________||\n| ___vmix0______________________________________________________  |\n| |  __mocp___  O O   _firefox_  O O  __pcm7___  O O            | |--> 4\n| | |         | O O  |         | x x |         | O O            | |\n| | | | |     | x O  | | |     | x x | | |     | O O            | |\n| | | o o [x] | x x  | o o [x] | x x | o o [x] | O O            | |\n| | | | |     | x x  | | |     | x x | | |     | O O            | |\n| | |_________| x x  |_________| x x |_________| O O            | |\n| |_____________________________________________________________| |\n|_________________________________________________________________|\n```\n\n1. サウンドカードごとに一つのタブ\n1. 上のところに vmix (virtual mixer) の特別設定。サンプリングレートやミキサーの優先度など。\n1. サウンドカードのジャック設定 (入力と出力)。全てのミキサーコントロールはここに表示されます。\n1. アプリケーションの vmix ミキサーコントロールとサウンドメーター。アプリケーションがサウンドを再生していないときは pcm08, pcm09... のように表示され、アプリケーションが再生しているときはアプリケーションの名前が表示されます。\n\n"
    },
    {
      "title": "色の定義",
      "level": 3,
      "content": "high definition (HD) audio の場合、ossxmix は既定のジャックの色を使ってジャックの設定を色付けします:\n\nTable content:\n色 | タイプ | 接続子\ngreen | フロントチャンネル (ステレオ出力) | 3.5mm TRS\nblack | リアチャンネル (ステレオ出力) | 3.5mm TRS\ngrey | サイドチャンネル (ステレオ出力) | 3.5mm TRS\ngold | センターとサブウーファー (デュアル出力) | 3.5mm TRS\nblue | ラインレベル (ステレオ入力) | 3.5mm TRS\npink | マイクロフォン (モノ入力) | 3.5mm TS\n\n"
    },
    {
      "title": "ミキサーのレベルを保存する",
      "level": 3,
      "content": "ミキサーのレベルはコンピュータのシャットダウン時に保存されます。いますぐミキサーのレベルを保存したい場合、root で次を実行してください:\n\n```\n# savemixer\n```\n\n-f スイッチを使うことで savemixer によってミキサーレベルをファイルに保存することができ、-L スイッチで読み込むことができます。\n\n"
    },
    {
      "title": "他のミキサー",
      "level": 3,
      "content": "OSS をサポートしている他のミキサー:\n\n- Gnome Volume Control — GNOME 向け。\n\n- Kmix — KDE 向け。\n\n- VolWheel — インストール後、必要に応じて自動起動するよう設定してください。また、OSS サポートを有効にするために、システムトレイのアイコンを右クリックし、Preferences を選択して以下のように変更してください:\n\n- Driver: OSS。\n- Default Channel: vmix0-outvol (使用するチャンネルは ossmix でわかります)。\n- Default Mixer: ossxmix。\n- MiniMixer タブでは、vmix0-outvol などを任意で追加してください。\n\n"
    },
    {
      "title": "GStreamer を使用するアプリケーション",
      "level": 3,
      "content": "オーディオに Gstreamer を利用しているアプリケーションで問題が発生する場合、pulseaudio を削除して、oss4sink と oss4src が必要としている gstreamer0.10-good-pluginsAUR パッケージをインストールしてみてください。\n\nそれから gstreamer-properties (gstreamer-propertiesAUR パッケージに含まれています) を使って GStreamer 設定のサウンド出力をデフォルトの ALSA から OSS に変更してください。gstreamer-properties を起動して、以下のフィールドを修正する必要があります:\n\n- Default Output セクション: OSS がプラグインとして選択できない場合、Plugin を Custom に、Pipeline を oss4sink に変更してください。\n- Default Input セクション: OSS が選択できない場合、Plugin を Custom に、Pipeline を oss4src に変更してください。\n\nアプリケーションによっては、(gstreamer-properties によって変更が加えられる) audiosink ではなく musicaudiosink を使っているために、gstreamer-properties による設定を読み込みません。\n\nこの問題の回避方法として、gstreamer-properties で audiosink の値を設定してから gconf-editor を使って /system/gstreamer/0.10/default/audiosink の値を musicaudiosink (同じ場所にあります) にコピーできます。\n\nPhonon で GStreamer バックエンドを使っている場合は環境変数を設定する必要があります:\n\n```\nexport PHONON_GST_AUDIOSINK=oss4sink\n```\n\n上の行を ~/.bashrc に追記することでログイン時にロードされるようになります。\n\n"
    },
    {
      "title": "OpenAL を使用するアプリケーション",
      "level": 3,
      "content": "OpenAL はデフォルトでは ALSA を使います。これを変更するために、/etc/openal/alsound.conf で OSS の利用を定義してください:\n\n```\n/etc/openal/alsound.conf\n```\n\n```\ndrivers=oss\n```\n\n"
    },
    {
      "title": "Audacity",
      "level": 3,
      "content": "Audacity を起動しても、デバイスが開けないとエラーが出たり何も再生できない場合、vmix によって Audacity がサウンドデバイスへの独占的なアクセスをすることができなくなっている可能性があります。これを修正するには、Audacity を起動する前に、次を実行してください:\n\n```\n$ ossmix vmix0-enable OFF\n```\n\nAudacity を終了した後は次のコマンドで vmix を戻せます:\n\n```\n$ ossmix vmix0-enable ON\n```\n\n"
    },
    {
      "title": "Gajim",
      "level": 3,
      "content": "デフォルトでは Gajim は aplay -q を使ってサウンドを再生します。OSS を使うために Edit > Preferences > Advanced から ossplay -qq に変更することができます。Advanced Configuration Editor を開いて soundplayer 変数を変更してください。\n\n"
    },
    {
      "title": "MOC",
      "level": 3,
      "content": "OSS v4.1 で MOC を使うには (~/.moc にある) 設定ファイルの OSSMixerDevice を /dev/ossmix に変更する必要があります。インターフェイスの問題については mocp で w を押して OSSMixerChannel を (ソフトウェアミキサー) に変更してみてください。\n\n"
    },
    {
      "title": "MPD",
      "level": 3,
      "content": "MPD の設定は /etc/mpd.conf もしくは ~/.mpdconf で行います。これらのファイルを両方ともチェックして、以下のようなところを探して下さい:\n\n```\n/etc/mpd.conf\n```\n\n```\n...\naudio_output {\n    type    \"alsa\"\n    name    \"Some Device Name\"\n}\n...\n```\n\n上記のように ALSA の設定がアンコメントされている (行頭が # になってない) 場合、全てコメントアウトするか削除して、以下を追記してください:\n\n```\n/etc/mpd.conf\n```\n\n```\n...\naudio_output {\n    type    \"oss\"\n    name    \"My OSS Device\"\n}\n...\n```\n\nほとんどのユーザーはこれ以上の設定は必要ありません。ただし、(MPD を再起動した後に正しく動作しないなどの) 問題が発生する場合や、(自動設定ではなく、ユーザーが設定した) 特定の設定ファイルを使いたい場合は、以下の手順で OSS のオーディオ出力を細かく設定できます\n\n- まず、次を実行してください:\n\n```\n$ ossinfo | grep /dev/dsp\n```\n\n- /dev/dsp -> /dev/oss/<SOME_CARD_IDENTIFIER>/pcm0 のような文字列が書かれた行を探して下さい。<SOME_CARD_IDENTIFIER> がどうなっているかメモを取って、MPD 設定ファイルの OSS audio_output に以下の行を追加してください:\n\n```\n/etc/mpd.conf\n```\n\n```\n...\naudio_output {\n    type            \"oss\"\n    name            \"My OSS Device\"\n    device          \"/dev/oss/<SOME_CARD_IDENTIFIER>/pcm0\"\n    mixer_device    \"/dev/oss/<SOME_CARD_IDENTIFIER>/mix0\"\n}\n...\n```\n\n参照: Music Player Daemon#グローバル設定。\n\n"
    },
    {
      "title": "MPlayer",
      "level": 3,
      "content": "GUI (SMplayer, GNOME MPlayer など) を使っている場合、設定ダイアログからデフォルト出力として OSS を選択できます。コマンドラインから MPlayer を使っている場合、音声出力を指定してください:\n\n```\n$ mplayer -ao oss /some/file/to/play.mkv\n```\n\n何度も入力するのが面倒ならば設定ファイル (~/.mplayer/config) に ao=oss を追加してください。\n\n参照: MPlayer#設定。\n\n"
    },
    {
      "title": "Skype",
      "level": 3,
      "content": "最近のバージョン (バージョン 4.3 以降) では OSS サポートが失くなったため、skype[リンク切れ: パッケージが存在しません] パッケージには ALSA のサポートしか含まれていません。コミュニティの努力によって、(PulseAudio を使わずに) OSS で Skype を使えるようにする方法があります:\n\nAUR から skype_oss_wrapper-gitAUR[リンク切れ: アーカイブ: aur-mirror] をインストールします。これによって偽の libpulse.so ライブラリを利用して Skype のために PulseAudio の挙動を偽装します。インストールした後は次のコマンドを使って Skype を起動する必要があります: skype_oss。もしくはパッケージによって作成されるアプリケーションショートカットを起動してください: \"Skype (OSSv4)\"。ラッパーとしては十分に機能しますが、48KHz の入力と出力でしか動作しません。何かおかしな挙動が発生したり欠けている機能を見つけたら、バグレポートとパッチを送ると良いでしょう。\n\nもしくは module-oss と pulseaudio を使うことも可能です:\n\n/etc/pulse/default.pa を編集して load-module module-udev-detect で始まる行をコメントアウトし、load-module module-oss device=\"/dev/dsp\" sink_name=output source_name=input mmap==0 を追記してください。\n\n"
    },
    {
      "title": "VLC media player",
      "level": 3,
      "content": "オーディオ設定から OSS をデフォルト出力に選択することができます。\n\n"
    },
    {
      "title": "Wine",
      "level": 3,
      "content": "Wine で OSS を設定するには、次を実行して:\n\n```\n$ winecfg\n```\n\nAudio タブから OSS Driver を選択してください。\n\n参照: Wine#サウンド。\n\n"
    },
    {
      "title": "他のアプリケーション",
      "level": 3,
      "content": "- ここに記載されていないアプリケーションで音が鳴らない場合は、Configuring Applications for OSSv4 のページを見て下さい。\n- pacman -Ss -- -oss や AUR で OSS 対応のパッケージを検索できます。\n\n参照: ossapps。\n\n"
    },
    {
      "title": "OSS でマルチメディアキーを使う",
      "level": 3,
      "content": "AUR にある ossvolAUR[リンク切れ: アーカイブ: aur-mirror] スクリプトを使うことでミュート・アンミュートやボリュームの上げ下げを簡単にできます。スクリプトに関する詳細は OSS wiki の この記事 を見て下さい。\n\nインストールしたら、ミュートを切り替えるには次を入力します:\n\n```\n$ ossvol -t\n```\n\nまた、利用できるコマンドを表示するには:\n\n```\n$ ossvol -h\n```\n\nマルチメディアキーで ossvol を使いたい場合、特別なキーボードキーを見てキーを正しく設定してください。キーを設定したら、Xbindkeys などを使ってキーと ossvol スクリプトを結びつけることができます。以下を ~/.xbindkeysrc ファイルに追加してください:\n\n```\n~/.xbindkeysrc\n```\n\n```\n# Toggle mute\n\"ossvol -t\"\n    m:0x0 + c:121\n    XF86AudioMute\n\n# Lower volume\n\"ossvol -d 2\"\n    m:0x0 + c:122\n    XF86AudioLowerVolume\n\n# Raise volume\n\"ossvol -i 2\"\n    m:0x0 + c:123\n    XF86AudioRaiseVolume\n```\n\n使いたいショートカットに自由に変更することができます。\n\n"
    },
    {
      "title": "サンプルレートを変更する",
      "level": 3,
      "content": "まず、サンプルレート出力の変更は明瞭なものではありません。サンプルレートは root でしか変更ができず、変更する時はプログラムによって vmix が使われていない状態である必要があります。先に進む前に、受信機やアンプを通していて、コンピュータのスピーカーではなく高級スピーカーを使っているか確認してください。コンピュータのスピーカーしか使っていない場合、違いがほとんど生まれないので、サンプルレートの変更をする必要はありません。\n\nデフォルトのサンプルレートは 48000hz です。これを変更する必要がある場合は複数考えられます。全てはあなたの使用状況によります。一番良く使うメディアに合わせてサンプルレートを設定すると良いでしょう。ハードウェアに合わせてメディアのサンプリングレートを変更する必要がある場合、保証はできませんが基本的に音質が落ちます。ダウンサンプリングでこれは顕著です (96000hz → 48000hz)。この問題についてよく知りたいのならば、Stereophile に記事があり、Apple の CoreAudio API メーリングリストで 議論 がされています。\n\nサンプルレートの例:\n\n現在設定されているサンプルレートを確認するには、次を実行してください:\n\n```\nossmix | grep rate\n```\n\n普通は vmix0-rate <decimal value> (currently 48000) (Read-only) と表示されます。\n\nvmix0-rate (または vmix1-rate など) が出力されない場合、おそらく vmix が無効になっています。この場合、OSS はデバイスを使用するプログラムによって要求されたレートを使用します。そのためこのセクションは適用されません。例外として Envy24 (と Envy24HT) カードは特別な設定 envy24.rate を使って似た機能を実現します (oss_envy24 の man ページを見て下さい)。\n\nサンプルレートを変更するには:\n\n1. 最初に、あなたの使っているカードが新しいレートを使えるか確認してください。ossinfo -v2 を実行して使用したいレートが Native sample rates 出力の中にあるか見て下さい。\n1. root で、/usr/lib/oss/scripts/killprocs.sh を実行してください。サウンドチャンネルを開いているプログラムが終了されるので注意してください。\n1. vmix を使用するプログラムが全て終了したら、root で次を実行してください: vmixctl rate /dev/dsp 96000。rate はあなたの使用したいレートに置き換えてください (必要ならば ossmix envy24.rate 96000 も)。\n1. ossmix | grep rate を実行して変更が問題なく行われたか vmix0-rate <decimal value> (currently 96000) (Read-only) をチェックしてください。\n1. 変更を永続的にするには以下を soundon.user ファイルに追加してください:\n\n```\n/usr/lib/oss/soundon.user\n```\n\n```\n#!/bin/sh\n\nvmixctl rate /dev/dsp 96000\n# ossmix envy24.rate 96000 # uncomment if you have an Envy24(HT) card\n\nexit 0\n```\n\nそして実行可能属性をつけてください:\n\n```\n# chmod +x /usr/lib/oss/soundon.user\n```\n\n"
    },
    {
      "title": "シンプルなシステムトレイアプレット",
      "level": 3,
      "content": "軽量な OSS システムトレイアプレットが必要な場合は これ を見て下さい。\n\nインストールするには:\n\n- スクリプト を好きな名前でダウンロードしてください (例: ossvolctl)\n- 実行可能にしてください:\n\n```\n$ chmod +x ossvolctl\n```\n\n- /usr/bin にコピーしてください:\n\n```\n# cp ossvolctl /usr/bin/ossvolctl\n```\n\nまたは:\n\n```\n# install -Dm755 ossvolctl /usr/bin/ossvolctl\n```\n\n"
    },
    {
      "title": "KDE",
      "level": 4,
      "content": "ローカルアプリケーションランチャーディレクトリ (~/.local/share/applications/) の中に ossxmix.desktop という名前のアプリケーションランチャーファイルを作成してください:\n\n```\n~/.local/share/applications/ossxmix.desktop\n```\n\n```\n[Desktop Entry]\nName=Open Sound System Mixer\nGenericName=Audio Mixer\nExec=ossxmix -b\nIcon=audio-card\nCategories=Application;GTK;AudioVideo;Player;\nTerminal=false\nType=Application\nEncoding=UTF-8\n```\n\n自動実行するには、System Settings > System Administration > Startup and Shutdown > Autostart のリストに加えて下さい。\n\n"
    },
    {
      "title": "Gnome",
      "level": 4,
      "content": "root でファイル /usr/local/bin/ossxmix_bg を作成してください:\n\n```\n/usr/local/bin/ossxmix_bg\n```\n\n```\n#!/bin/sh\n\nexec /usr/bin/ossxmix -b\n```\n\nそれから System > Preferences > Start Up Applications を開き:\n\n- Add をクリックして、Name フィールドに OSSMIX、Command フィールドに /usr/local/bin/ossxmix_bg と入力して Add Button をクリックしてください。\n- 再ログインすれば変更が適用されます。\n\n"
    },
    {
      "title": "プログラムからの音声出力を録音する",
      "level": 3,
      "content": "- Recording sound output of a program.\n\n"
    },
    {
      "title": "サスペンドとハイバネーション",
      "level": 3,
      "content": "OSS はサスペンドに自動的な対応をしないため、サスペンドやハイバネートをする前に手動で停止して、その後再起動する必要があります。\n\nOSS には OSS を有効化・無効化する soundon と soundoff がありますが、これらはサウンドを使うプロセスが全て終了してからでしか OSS を停止することができません。\n\n以下の簡単なスクリプトでサスペンドをする前に OSS を自動的にアンロードしてその後リロードすることができます。\n\n```\n/usr/lib/systemd/system-sleep/50osssound.sh\n```\n\n```\n#!/bin/sh\nsuspend_osssound()\n{\n    /usr/lib/oss/scripts/killprocs.sh\n    /usr/bin/soundoff\n}\n \nresume_osssound()\n{\n    /usr/bin/soundon\n}\n \ncase $1 in\n    pre)\n        suspend_osssound\n \t;;\n    post)\n \tresume_osssound\n \t;;\n    *) exit $NA\n \t;;\nesac\n```\n\nスクリプトの中身を (root で) /usr/lib/systemd/system-sleep/50osssound.sh に保存して実行可能属性を付けて下さい:\n\n```\n# chmod a+x /usr/lib/systemd/system-sleep/50osssound.sh\n```\n\n他にもサスペンドに s2ram を使う方法もあります。サスペンドスクリプトを /usr/bin/suspend に作成して実行可能属性を付けて下さい。\n\n```\n#!/bin/sh\n\n ## Checking if you are a root or not\n if ! [ -w / ]; then\n   echo >&2 \"This script must be run as root\"\n   exit 1\n fi\n\n s2ram -f\n\n sleep 2\n\n systemctl restart oss.service 2>/tmp/oss.txt || echo \"OSS restart failed, check /tmp/oss.txt for information\"\n```\n\nこのスクリプトなら、全てのアプリがちゃんと動くはずです。\n\n"
    },
    {
      "title": "デフォルトの音声出力を変更する",
      "level": 3,
      "content": "osstest を実行した時に、一番目のチャンネルの最初のテストは通るのに、ステレオや右チャンネルで、音声が歪んだりシュッと音が鳴る場合、間違った出力に設定がされています。\n\n```\n*** Scanning sound adapter #-1 ***\n/dev/oss/oss_hdaudio0/pcm0 (audio engine 0): HD Audio play front\n- Performing audio playback test... \n<left> OK <right> OK <stereo> OK <measured srate 47991.00 Hz (-0.02%)>\n```\n\n左の音声が良くて、右やステレオが歪んだ音になっています。\n\n正しい出力が得られるまでテストを続けて下さい:\n\n```\n/dev/oss/oss_hdaudio0/spdout0 (audio engine 5): HD Audio play spdif-out \n- Performing audio playback test... \n<left> OK <right> OK <stereo> OK <measured srate 47991.00 Hz (-0.02%)>\n```\n\n左・右・ステレオ全てでテストが通ったら、次のステップに進んで下さい。\n\nデフォルトの出力を変更するコマンドは この OSS wiki の記事 を見て下さい。動作するやつに変更してください、例えば:\n\n```\n# ln -sf /dev/oss/oss_hdaudio0/spdout0 /dev/dsp_multich\n```\n\nサラウンド音声 (4.0-7.1) の場合 dsp_multich を選んで下さい。2チャンネルしかない場合は dsp で問題ありません。利用可能な全てのデバイスについては こちら を見て下さい。\n\n"
    },
    {
      "title": "Creative Sound Blaster X-Fi Surround 5.1 SB1090 USB",
      "level": 3,
      "content": "これは 4front-tech フォーラム からの情報です。\n\nossusb_audio.c の write_control_value(...) 関数で true が返されないために外付けカードが動作しないというのは驚きです。\n\nこれを修正するには、今のところ OSS のリコンパイルが必要になります。\n\n- Arch のリポジトリから最新の OSS を取得:\n\n```\nhttps://projects.archlinux.org/svntogit/community.git/tree/trunk?h=packages/oss\n```\n\n- 展開する\n- 展開したフォルダに cd\n- makepkg --nobuild を実行\n- src/kernel/drv/oss_usb/ に cd して ossusb_audio.c を編集: return 1; を追加 以下のようにします:\n\n- 以下のようにします:\n\n```\nossusb_audio.c\n```\n\n```\nstatic int\nwrite_control_value (ossusb_devc * devc, udi_endpoint_handle_t * endpoint,\n                     int ctl, int l, unsigned int v)\n{\n     return 1;\n...\n```\n\n- src/kernel/setup に cd して srcconf_linux.inc を編集、-Werror を探して削除する。そうしないと OSS がコンパイルされません。\n- makepkg --noextract を実行\n\nそして pacman -U でパッケージをインストールします。OSS を既にインストールしている場合は削除しておいてください。\n\n"
    },
    {
      "title": "ALSA のエミュレーション",
      "level": 3,
      "content": "alsa-lib に音声出力システムとして OSS を使うように指示することが可能です。これは一種の ALSA エミュレーションとして働きます。\n\nただし、この方法は音声出力に遅延を増やすことになり、またエミュレーションは完全でないので全てのアプリケーションで動作するというわけではありません。例えば、ALSA を使ってデバイスを検出するようなプログラムではエミュレーションは動きません。\n\n多くのアプリケーションは OSS を直接サポートしているので、この方法は最終手段としてのみ使って下さい。\n\n将来的には、libsalsa や cuckoo など ALSA を完全にエミュレートする方法が使えるようになるかもしれません。\n\n"
    },
    {
      "title": "手順",
      "level": 4,
      "content": "- 公式リポジトリにある alsa-plugins パッケージをインストールしてください。\n\n- /etc/asound.conf を以下のように編集してください。\n\n```\npcm.oss {\n   type oss\n    device /dev/dsp\n}\n\npcm.!default {\n    type oss\n    device /dev/dsp\n}\n\nctl.oss {\n    type oss\n    device /dev/mixer\n}\n\nctl.!default {\n    type oss\n    device /dev/mixer\n}\n```\n\n"
    },
    {
      "title": "特定のドライバーにあわせた設定",
      "level": 3,
      "content": "何かが動作しない場合、OSS 設定の中にドライバー固有のものがあったり、あなたのドライバーにあってなかったりする可能性があります。\n\nこれを解決するには:\n\n- どのドライバーが使われているのか確認します\n\n```\n$ lspci -vnn | grep -i -A 15 audio\n```\n\n```\n00:1e.2 Multimedia audio controller [0401]: Intel Corporation 82801FB/FBM/FR/FW/FRW (ICH6 Family) AC'97 Audio Controller [8086:266e] (rev 03)\nSubsystem: Hewlett-Packard Company NX6110/NC6120 [103c:099c]\nFlags: bus master, medium devsel, latency 0, IRQ 21\nI/O ports at 2100 [size=256]\nI/O ports at 2200 [size=64]\nMemory at d0581000 (32-bit, non-prefetchable) [size=512]\nMemory at d0582000 (32-bit, non-prefetchable) [size=256]\nCapabilities: <access denied>\nKernel driver in use: *oss_ich*\nKernel modules: snd-intel8x0\n```\n\n- デバイスの設定ファイルを探して下さい:\n\n```\n# cd /usr/lib/oss/conf/\n```\n\n- デフォルトの設定を変更してみて下さい。設定は少なく、見ればすぐわかります。\n\n例えば、oss_ich.conf に次の設定をすることで jack-sense がオンになります (ヘッドフォンの接続の認識やスピーカーのミュートに関係しています):\n\n```\nich_jacksense = 1\n```\n\njack-sense の他の設定は hdaudio.conf にあり hdaudio_jacksense 変数を変える必要があります。\n\n- 変更を適用するために oss デーモンを再起動します。\n\n"
    },
    {
      "title": "問題の所在",
      "level": 4,
      "content": "HD Audio サウンドデバイスを使う場合、大抵はサウンドを使えるようにする前にミキサーの設定を調整する必要があります。\n\nHD Audio デバイスはソフトウェアでいつでも調整できる小さな回路 (ウィジェットと呼ばれます) がいくつも入れられるという点でとても強力です。これらのコントロールはミキサーに表示され、これを使うことで、例えば、イヤフォンジャックをサウンドの出力端子ではなくサウンドの入力端子にすることができます。\n\nただし、弊害も存在します。主として HD Audio の仕様の柔軟性があまりにありすぎるというのと、メーカーが基本的に公式ドライバーが動くのにだけしか注意を払っていないのが原因です。\n\nHD Audio デバイスを使用する際には、乱雑なミキサーコントロールに手を焼き、デフォルトでは全く動作しないため、動作するようになるまで、あらゆるミキサーコントロールの組み合わせを試す羽目になります。\n\n"
    },
    {
      "title": "解決方法",
      "level": 4,
      "content": "ossxmix を開いて中部分のミキサーコントロールを全て変更してみてください、ボリュームコントロールミキサーセクションで説明されているように、サウンドカード固有のコントロールが含まれています。\n\nossxmix でミキサー設定を変更する間は、後ろでずっと録音・再生するプログラムを起動しておくと良いでしょう (例: 録音には ossrecord - | ossplay - で再生には osstest -lV)。\n\n- 全てのボリュームコントロールのスライダーを上げる。\n- それぞれのオプションボックスで、選択するオプションを変更して、全ての組み合わせを試して下さい。\n- ノイズが聞こえる場合、ノイズの元がわかるまで、ボリュームコントロールを低くしたりミュートにしてみてください。\n- /usr/lib/oss/conf/oss_hdaudio.conf を編集して、hdaudio_noskip=0 をアンコメントして 0-7 の値に変更することで ossxmix にさらに jack のオプションが表示されます。\n\n"
    },
    {
      "title": "Totem で MMS の音にノイズが乗る",
      "level": 3,
      "content": "Totem で再生中に音が割れたり異常なノイズが聞こえる場合は、FFmpeg など他のバックエンドを使ってみて下さい。MMS ストリームを再生すると GStreamer がポップアップする問題は修正できませんが、良い音質で聞こえるようになります。MPlayer で再生するのは簡単です:\n\n```\n# mplayer mmsh://yourstreamurl\n```\n\n"
    },
    {
      "title": "マイクロフォンが出力チャンネルで再生される",
      "level": 3,
      "content": "デフォルトで、OSS はマイクロフォンからの入力をスピーカーで再生するようになっています。これを無効にするには ossxmix の Misc セクションから input-mix-mute のボックスのチェックを全て外して下さい。\n\n"
    },
    {
      "title": "参照",
      "level": 2,
      "content": "- 公式ウェブサイト\n- OSS Wiki\n- OSS フォーラム\n- 開発者情報\n- Git リポジトリ\n- opensound-devel メーリングリスト\n\n"
    }
  ]
}