{
  "title": "Xmodmap (Русский)",
  "url": "https://wiki.archlinux.org/title/Xmodmap_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Ссылки по теме\n\n- Xorg (Русский)\n- Конфигурация клавиатуры в Xorg\n- Keyboard input (Русский)\n- Конфигурация клавиатуры в консоли\n- Xbindkeys (Русский)\n\nxmodmap - это утилита для изменения раскладки клавиш клавиатуры и мыши в Xorg.\n\nxmodmap не относится к X keyboard extension (XKB), так как использует другие (pre-XKB) идеи на то, как коды клавиш обрабатываются в X. В целом, он рекомендуется только для простых задач. Смотрите X keyboard extension для продвинутой настройки раскладки.\n\n- Настройки xmodmap сбрасываются утилитой setxkbmap, которая не только изменяет алфавитно-цифровые клавиши, но и сбрасывает все остальные клавиши на значения по умолчанию (смотрите LQWiki:Configuring keyboards).\n- Из-за ограничений Xorg настройки xmodmap не применяются к подключенным устройствам автоматически. Если клавиатура добавлена в систему после применения пользовательской таблицы, её придётся применять снова. [1]\n\n"
    },
    {
      "title": "Введение",
      "level": 2,
      "content": "В Xorg есть два типа значений клавиатуры: коды клавиш (keycodes) и символы клавиш (keysyms).\n\n"
    },
    {
      "title": "Установка",
      "level": 2,
      "content": "xmodmap можно установить с помощью пакета xorg-xmodmap.\n\nЕсли хотите, можете установить xkeycaps - это графический фронт-энд для xmodmap.\n\n"
    },
    {
      "title": "Таблица назначений клавиш",
      "level": 2,
      "content": "Чтобы отобразить текущую таблицу назначений клавиш, форматированную в выражения:\n\n```\n$ xmodmap -pke\n```\n\n```\n[...]\nkeycode  57 = n N\n[...]\n```\n\nПосле каждого кода клавиши идут символы клавиши, которые ему назначены. На примере выше видно, что коду клавиши 57 назначен символ нижнего регистра n, а символу верхнего регистра N назначен код клавиши 57 плюс Shift.\n\nКаждому столбцу символов клавиш в таблице соответствует определённая комбинация клавиш-модификаторов:\n\n1. Key\n1. Shift+Key\n1. Mode_switch+Key\n1. Mode_switch+Shift+Key\n1. ISO_Level3_Shift+Key\n1. ISO_Level3_Shift+Shift+Key\n\nНе обязательно назначать все символы клавиши; чтобы не назначать их в конкретных столбцах, можете использовать значение NoSymbol.\n\nЧтобы узнать какой код клавиши отвечает за нужную вам клавишу, смотрите статью Keyboard input (Русский)#Определение кодов клавиш в Xorg, в которой объясняется, как использовать утилиту xev.\n\nОбратите внимание, что на xmodmap влияют настройки xkbd, поэтому все восемь keysym доступны для раскладки xkbd US(intl), но не для US по умолчанию (в ней отсутствует символ ralt_switch, определённый в level3). Чтобы все 8 keysym были доступны, необходимо настроить (intl) вариант клавиатуры. Выполните $ setxkbmap -layout 'us(intl)' (пример для раскладки US) перед вызовом xmodmap для тестирования изменений в текущем сеансе X. Чтобы сделать это изменение постоянным, отредактируйте конфигурацию xorg или файл .xprofile или .xinitrc. Полное объяснение смотрите в разделе Конфигурация клавиатуры в Xorg#Настройка раскладки клавиатуры.\n\n"
    },
    {
      "title": "Изменение таблицы",
      "level": 2,
      "content": "Сохраним текущую таблицу назначений клавиш в файл (например, ~/.Xmodmap):\n\n```\n$ xmodmap -pke > ~/.Xmodmap\n```\n\nМожете убрать строки для клавиш, которые вы не собираетесь менять. Прописав/изменив нужные значения клавишам, применим изменения:\n\n```\n$ xmodmap ~/.Xmodmap\n```\n\n"
    },
    {
      "title": "Активация изменённой таблицы при загрузке",
      "level": 3,
      "content": "Если вы используете GDM, XDM или LightDM, нет необходимости выполнять source ~/.Xmodmap. А если вы пользуетесь startx, внесите следующее содержимое в файл ~/.xinitrc:\n\n```\n~/.xinitrc\n```\n\n```\n[[ -f ~/.Xmodmap ]] && xmodmap ~/.Xmodmap\n```\n\nДругим вариантом является редактирование глобального скрипта автозапуска /etc/X11/xinit/xinitrc.\n\n"
    },
    {
      "title": "Попробовать изменения",
      "level": 3,
      "content": "Чтобы сделать временные изменения:\n\n```\n$ xmodmap -e \"keycode  46 = l L l L lstroke Lstroke lstroke\"\n$ xmodmap -e \"keysym a = e E\"\n```\n\n"
    },
    {
      "title": "Клавиши-модификаторы",
      "level": 2,
      "content": "xmodmap также умеет переопределять клавиши-модификаторы, например, можно \"поменять местами\" клавиши Control и Super.\n\nВывод текущей таблицы модификаторов:\n\n```\n$ xmodmap -pm\n```\n\n```\nxmodmap:  up to 4 keys per modifier, (keycodes in parentheses):\n\nshift       Shift_L (0x32),  Shift_R (0x3e)\nlock        Caps_Lock (0x42)\ncontrol     Control_L (0x25),  Control_R (0x69)\nmod1        Alt_L (0x40),  Meta_L (0xcd)\nmod2        Num_Lock (0x94)\nmod3\nmod4        Super_R (0x86),  Super_L (0xce),  Hyper_L (0xcf)\nmod5        ISO_Level3_Shift (0x5c),  ISO_Level3_Shift (0x6c),  Mode_switch (0x85),  Mode_switch (0xcb)\n```\n\nПеред тем, как назначать клавишу-модификатор, её надо очистить. Это относится как к модификаторам, которые вы собираетесь назначить, так и к модификаторам на клавишах, которые вы собираетесь использовать. Например, если вы собираетесь назначить Caps_Lock на клавишу A, а B — на клавишу NumLock, вам нужно сначала очистить модификаторы для Caps_Lock и Num_Lock, затем назначить символы клавиш и, наконец, добавить модификаторы обратно.\n\n```\n~/.Xmodmap\n```\n\n```\n[...]\nclear lock\nclear mod2\nkeycode  38 = Caps_Lock\nkeycode  77 = Num_Lock\nadd lock = Caps_Lock\nadd mod2 = Num_Lock\n```\n\n! является комментированием, так что в следующем примере будут очищены только клавиши Control и Mod4. Затем символы клавиш Control_L, Control_R, Super_L и Super_R переназначены на противоположные. Переназначение как левой, так и правой клавиш на один и тот же модификатор означает, что обе клавиши будут функционировать одинаково.\n\n```\n~/.Xmodmap\n```\n\n```\n[...]\n!clear Shift\n!clear Lock\nclear Control\n!clear Mod1\n!clear Mod2\n!clear Mod3\nclear Mod4\n!clear Mod5\n!add Shift   = Shift_L Shift_R\n!add Lock    = Caps_Lock\nadd Control = Super_L Super_R\n!add Mod1    = Alt_L Alt_R\n!add Mod2    = Mode_switch\n!add Mod3    =\nadd Mod4    = Control_L Control_R\n!add Mod5    =\n```\n\nСледующий пример изменяет CapsLock на Control и Shift+CapsLock на CapsLock:\n\n```\n~/.Xmodmap\n```\n\n```\nclear lock\nclear control\nadd control = Caps_Lock Control_L Control_R\nkeycode 66 = Control_L Caps_Lock NoSymbol NoSymbol\n```\n\n"
    },
    {
      "title": "Клавиша Compose",
      "level": 2,
      "content": "Клавиша Compose позволяет вводить специальные знаки и символы, которых нет непосредственно на клавиатуре. Это особенно полезно при наборе акцетов для букв неанглийских языков. Например, при последовательном нажатии Compose e ' получается é. Некоторые символы требуют нажатия более двух клавиш после Compose. Обычно на Compose назначается клавиша-модификатор. Клавишу можно выбрать в настройках в большинстве сред рабочего стола, но эти опции не будут работать, если используется пользовательская таблица сопоставления клавиш, как описано в этой статье. Чтобы установить клавишу compose с помощью Xmodmap, используйте идентификатор Multi_key. Например, для сопоставления правого alt (AltGr) с клавишей compose:\n\n```\n~/.Xmodmap\n```\n\n```\n[...]\nkeycode 108 = Multi_key Alt_R Meta_R Alt_R Meta_R\n```\n\nКод клавиши может быть другим в зависимости от клавиатуры.\n\n"
    },
    {
      "title": "Прокрутка в другую сторону",
      "level": 2,
      "content": "Иногда такую прокрутку называют естественной. Она похожа на поведение прокрутки на смартфонах. Добиться такого поведения можно с помощью xmodmap. Так как драйвер synaptics использует кнопки 4/5/6/7 для прокрутки вверх/вниз/влево/вправо, вы просто можете поменять порядок объявления кнопок в файле ~/.Xmodmap:\n\n```\n~/.Xmodmap\n```\n\n```\npointer = 1 2 3 5 4 7 6 8 9 10 11 12\n```\n\nТеперь примените изменения:\n\n```\n$ xmodmap ~/.Xmodmap\n```\n\n"
    },
    {
      "title": "Переназначение кнопок мыши",
      "level": 2,
      "content": "Левая, средняя и правая кнопки мыши соответствуют кнопкам 1, 2 и 3 соответственно в драйвере synaptics. Чтобы поменять местами левую и правую кнопки мыши, просто измените порядок их расположения в файле ~/.Xmodmap:\n\n```\n~/.Xmodmap\n```\n\n```\npointer = 3 2 1\n```\n\nНе забудьте применить изменения:\n\n```\n$ xmodmap ~/.Xmodmap\n```\n\n"
    },
    {
      "title": "Испанский",
      "level": 3,
      "content": "```\n~/.Xmodmap\n```\n\n```\nkeycode  24 = a A aacute Aacute ae AE ae\nkeycode  26 = e E eacute Eacute EuroSign cent EuroSign\nkeycode  30 = u U uacute Uacute downarrow uparrow downarrow\nkeycode  31 = i I iacute Iacute rightarrow idotless rightarrow\nkeycode  32 = o O oacute Oacute oslash Oslash oslash\nkeycode  57 = n N ntilde Ntilde n N n\nkeycode  58 = comma question comma questiondown dead_acute dead_doubleacute dead_acute\nkeycode  61 = exclam section exclamdown section dead_belowdot dead_abovedot dead_belowdot\n!Maps the Mode key to the Alt key\nkeycode 64 = Mode_switch\n```\n\n"
    },
    {
      "title": "Эсперанто",
      "level": 3,
      "content": "```\n~/.Xmodmap\n```\n\n```\nkeycode 54 = c C c C ccircumflex Ccircumflex\nkeycode 42 = g G g G gcircumflex Gcircumflex\nkeycode 43 = h H h H hcircumflex Hcircumflex\nkeycode 44 = j J j J jcircumflex Jcircumflex\nkeycode 39 = s S s S scircumflex Scircumflex\nkeycode 30 = u U u U ubreve Ubreve\n```\n\n"
    },
    {
      "title": "Вместо CapsLock Control",
      "level": 3,
      "content": "Простейший пример изменения CapsLock на Control.\n\n```\n~/.Xmodmap\n```\n\n```\nclear lock\nclear control\nkeycode 66 = Control_L\nadd control = Control_L Control_R\n```\n\n"
    },
    {
      "title": "Вместо CapsLock Control, а вместо LeftControl Hyper",
      "level": 3,
      "content": "Некоторые пользователи ноутбуков предпочитают, чтобы CapsLock работал как Control. А клавиша Left Control может быть использоваться в качестве модификатора Hyper (дополнительный модификатор для emacs, openbox или i3).\n\n```\n~/.Xmodmap\n```\n\n```\nclear      lock \nclear   control\nclear      mod1\nclear      mod2\nclear      mod3\nclear      mod4\nclear      mod5\nkeycode      37 = Hyper_L\nkeycode      66 = Control_L\nadd     control = Control_L Control_R\nadd        mod1 = Alt_L Alt_R Meta_L\nadd        mod2 = Num_Lock\nadd        mod3 = Hyper_L\nadd        mod4 = Super_L Super_R\nadd        mod5 = Mode_switch ISO_Level3_Shift\n```\n\n"
    },
    {
      "title": "Вместо Super_R Hyper_R",
      "level": 3,
      "content": "Пользователи, которые хотят иметь клавишу Hyper на полной раскладке клавиатуры, могут использовать правый Super в качестве Hyper.\n\n```\n~/.Xmodmap\n```\n\n```\nremove  mod4 = Super_R\nkeycode  134 = Hyper_R\nadd     mod3 = Hyper_R\n```\n\n"
    },
    {
      "title": "Переключение каждой цифровой клавиши N на Shift-N и наоборот для хорватской раскладки",
      "level": 3,
      "content": "Должен отлично работать и для раскладок, похожих на хорватский.\n\n```\n~/.Xmodmap\n```\n\n```\nkeycode 10 = exclam 1 1 exclam asciitilde dead_tilde asciitilde\nkeycode 11 = quotedbl 2 2 quotedbl dead_caron caron dead_caron\nkeycode 12 = numbersign 3 3 numbersign asciicircum dead_circumflex asciicircum\nkeycode 13 = dollar 4 4 dollar dead_breve breve dead_breve\nkeycode 14 = percent 5 5 percent degree dead_abovering degree\nkeycode 15 = ampersand 6 6 ampersand dead_ogonek ogonek dead_ogonek\nkeycode 16 = slash 7 7 slash grave dead_grave grave\nkeycode 17 = parenleft 8 8 parenleft dead_abovedot abovedot dead_abovedot\nkeycode 18 = parenright 9 9 parenright dead_acute apostrophe dead_acute\nkeycode 19 = equal 0 0 equal dead_doubleacute doubleacute dead_doubleacute\n```\n\n"
    },
    {
      "title": "Смотрите также",
      "level": 2,
      "content": "- xmodmap(1)\n- Multimediakeys with .Xmodmap HOWTO by Christian Weiske\n- Mapping unsupported keys with xmodmap by Pascal Bleser\n- LQWiki:List of Keysyms Recognised by Xmodmap\n\n"
    }
  ]
}