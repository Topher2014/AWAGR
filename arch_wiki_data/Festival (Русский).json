{
  "title": "Festival (Русский)",
  "url": "https://wiki.archlinux.org/title/Festival_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Ссылки по теме\n\n- Speech dispatcher\n\nFestival — это многоязычная система синтеза речи, разработанная CSTR (Centre for Speech Technology Research). Она предлагает основу для построения систем синтеза речи, а также включает примеры различных модулей. В целом, она предлагает преобразование текста в речь через несколько API: на уровне командной оболочки, через интерпретатор команд Scheme, как библиотека C++, из Java и интерфейс Emacs. Festival является мультиязычным (в настоящее время это британский английский, американский английский, итальянский, чешский и испанский, другие языки доступны в прототипе).\n\n"
    },
    {
      "title": "Установка",
      "level": 2,
      "content": "Установите пакет festival и какие-нибудь голосовые пакеты:\n\n- festival-english — британский и американский английский языки;\n- festival-us — американские мужчина/женщина и шотландский мужчина;\n- festvox-ruAUR — русский.\n\nБольше голосовых пакетов есть в AUR.\n\n"
    },
    {
      "title": "Настройка",
      "level": 2,
      "content": "Глобального файла конфигурации в /etc/ нет, но можно создать пользовательский файл ~/.festivalrc, или редактировать непосредственно /usr/share/festival/festival.scm. Оба эти файла являются файлами Scheme, используют синтаксис Scheme и перезапускаются при каждом запуске festival.\n\n"
    },
    {
      "title": "Звуковой сервер",
      "level": 3,
      "content": "Вы должны выбрать звуковой сервер (PulseAudio или ALSA). Следующие настройки позволяют Festival работать, если уже воспроизводится звук из других источников.\n\nДля PulseAudio:\n\n```\n(Parameter.set 'Audio_Required_Format 'aiff)\n(Parameter.set 'Audio_Method 'Audio_Command)\n(Parameter.set 'Audio_Command \"paplay $FILE --client-name=Festival --stream-name=Speech\")\n```\n\nДля ALSA: [1]\n\n```\n(Parameter.set 'Audio_Method 'Audio_Command)\n(Parameter.set 'Audio_Command \"aplay -q -c 1 -t raw -f s16 -r $SR $FILE\")\n```\n\n"
    },
    {
      "title": "Голоса",
      "level": 3,
      "content": "Arch разделяет набор официальных голосов на festival-us (рекомендуемый) и festival-english. В AUR есть и другие, находящиеся в разном состоянии поддержки, которые могут работать или не работать в данный момент.\n\nЧтобы узнать, какие голоса в настоящее время установлены и какой из них используется по умолчанию, используйте #Интерактивный режим (REPL scheme). Чтобы навсегда изменить голос по умолчанию, добавьте такую строку в свой файл настроек (пример для русского голоса из пакета festvox-ruAUR):\n\n```\n(set! voice_default voice_msu_ru_nsh_clunits)\n```\n\nДобавьте её в файл /usr/share/festival/siteinit.scm, чтобы задать новый голос по умолчанию для всех пользователей.\n\n"
    },
    {
      "title": "Ручная установка голосов",
      "level": 4,
      "content": "Вы также можете получить голоса напрямую из Festvox [2] [3]. Файлы для загрузки различных голосов имеют вид \"festvox_*.tgz\". Чтобы их задействовать, необходимо распакованный архив переместить в каталог, содержащий голос. На данный момент для Arch подходящей директорией является /usr/share/festival/voices/ с соответствующей подкаталогом для голоса из 'festvox'.\n\n"
    },
    {
      "title": "Поддержка русского языка",
      "level": 3,
      "content": "Стандартная установка Festival не знает про существование русского языка. Можно просто прописать использование голоса msu_ru_nsh_clunits из пакета festvox-ruAUR, но если вы хотите, чтобы опция --language russian тоже работала, то можно отредактировать файл /usr/share/festival/languages.scm.\n\nВ начале файла допишите:\n\n```\n(define (language_russian)\n \"(language_russian)\n  Set up language parameters for Russian.\"\n  (set! male1 voice_msu_ru_nsh_clunits)\n  (male1)\n  (Parameter.set 'Language 'russian)\n)\n```\n\nи в этом же файле после строки (define (select_language language) и перед любой строкой ((equal? добавьте:\n\n```\n((equal? language 'russian)\n(language_russian))\n```\n\nДля проверки выполните команду:\n\n```\n$ echo \"Арч самый лучший. Я гарантирую!\" | festival --tts --language russian\n```\n\n"
    },
    {
      "title": "Использование файлов в качестве ввода или вывода",
      "level": 3,
      "content": "Чтение текста из файла:\n\n```\n$ festival --tts текстовый_файл\n```\n\nЧтение выделенного текста:\n\n```\n$ xsel | festival --tts\n```\n\nПреобразование текстового файла в mp3-файл:\n\n```\n$ text2wave текстовый_файл | lame - текст.mp3\n```\n\nСоздание аудиофайла с указанными голосом:\n\n```\n$ text2wave -o вывод.wav -eval '(voice_msu_ru_nsh_clunits)' текстовый_файл\n```\n\n"
    },
    {
      "title": "Интерактивный режим",
      "level": 3,
      "content": "Festival имеет командную строку, которая вы можете использовать для тестов. Для её запуска введите команду festival. Несколько примеров:\n\nПосмотреть голос, используемый по умолчанию:\n\n```\nvoice_default\n```\n\nСписок доступных голосов:\n\n```\n(voice.list)\n```\n\nУстановить голос:\n\n```\n(voice_msu_ru_nsh_clunits)\n```\n\nПроизнести:\n\n```\n(SayText \"Арч делает меня счастливым\")\n```\n\nСписок доступных команд:\n\n```\nhelp\n```\n\nВыход - ctrl+d или набрать:\n\n```\n(quit)\n```\n\n"
    },
    {
      "title": "Can't open /dev/dsp",
      "level": 3,
      "content": "Если festival возвращает следующую ошибку:\n\n```\nLinux: can't open /dev/dsp\n```\n\nСмотрите раздел #Звуковой сервер выше.\n\n"
    },
    {
      "title": "Воспроизведение через alsa с неправильной скоростью",
      "level": 3,
      "content": "Если решение выше даёт скрипучий (писклявый) голос, можно попробовать следующее:\n\n```\n(Parameter.set 'Audio_Method 'Audio_Command)\n(Parameter.set 'Audio_Command \"aplay -Dplug:default -f S16_LE -r $SR $FILE\")\n```\n\n"
    },
    {
      "title": "Команда aplay не найдена",
      "level": 3,
      "content": "Установите пакет alsa-utils.\n\n"
    },
    {
      "title": "Завершение процесса festival не останавливает аудио",
      "level": 3,
      "content": "Завершение фонового процесса festival не остановит продолжение воспроизведения звука.\n\nЧтобы остановить воспроизведение звука, нужно завершить дочерние процессы audsp. Это можно сделать с помощью команды:\n\n```\n$ pkill -v audsp\n```\n\n"
    },
    {
      "title": "Сервер",
      "level": 3,
      "content": "Для использования Festival с Speech dispatcher (например, для режима чтения в Firefox) установите festival-freebsoft-utilsAUR.\n\n"
    },
    {
      "title": "Смотрите также",
      "level": 2,
      "content": "- Руководство Festival\n- List of applications/Other#Speech synthesizers\n- Банк скриптов для голосового движка Festival\n- Учим компьютер говорить по-русски / Festival скрипты\n- Говорящий пингвин. Учим Linux говорить и слушать\n\n"
    }
  ]
}