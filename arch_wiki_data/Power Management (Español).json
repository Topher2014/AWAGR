{
  "title": "Power Management (Español)",
  "url": "https://wiki.archlinux.org/title/Power_Management_(Espa%C3%B1ol)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Note: **Este artículo o sección necesita ser traducido.** Este artículo o sección necesita ser traducido.\n\nEste artículo o sección necesita ser traducido.\n\nNote: **2019-05-26** \n\nArtículos relacionados\n\n- Power management/Suspender e hibernar\n- Display Power Management Signaling\n- CPU escala de frecuencia\n- Hybrid graphics\n- Módulos del núcleo\n- sysctl\n- udev\n\nLa gestión de energía es una característica que apaga la alimentación o los interruptores del sistema para un menor consume de energía cuando está incactivo.\n\nEn Arch Linux, la administración de energía consiste en dos partes principales:\n\n1. Configurar el kernel de Linux, que interactua con el hardware. Parámetros del nucleo Módulos del kernel Reglas udevs\n1. Las herramientas de configuración del espacio del usuario pueden interactuar con el núcleo y reaccionar a sus eventos. Muchas de estás herramientas le permiten también modificar la configuración del núcleo de una forma fácil. Vea #Herramientas de espacio del usuario para las opciones.\n\n- Parámetros del nucleo\n- Módulos del kernel\n- Reglas udevs\n\n"
    },
    {
      "title": "Herramientas de espacio del usuario",
      "level": 2,
      "content": "Utilizando estas herramientas puede remplazar la configuración de muchos ajustes a mano. Solo ejecute una de estas herramientas para evitar conflictos ya que todas trabajan más o menos de la misma forma. Eche un vistazo a la categoria de administracion de energía para tener una noción de las opciones de administración energética que existen en Arch Linux.\n\nAquí están los scripts y herramientas más populares para ahorrar energía:\n\n"
    },
    {
      "title": "Consola",
      "level": 3,
      "content": "- acpid — Un demonio para llevar los eventos de energía ACPI con soporte netlink.\n\n- Laptop Mode Tools — Utilidad para configurar los ajustes de administración de energía de los portátiles considerado por muchos una utilidad clave para ahorrar energía, puede requerir un poco de configuración.\n\n- powertop — Una herramienta para diagnosticar problemas con el consumo y la administración de energía para ayudarle a establecer ajustes de ahorro de energía.\n\n- systemd — Un administrador de servicios y del sistema.\n\n- TLP — Administración avanzada de energía de Linux.\n\n"
    },
    {
      "title": "Gráficos",
      "level": 3,
      "content": "- cbatticon — Icono de batería ligero y rápido que se encuentra en la bandeja del sistema.\n\n- GNOME Power Statistics — Información y estadísticas de la energía del sistema para GNOME.\n\n- KDE Power Devil — Módulo de administración de energía para Plasma.\n\n- LXQt Power Management — Módulo de administración de energía para LXQt.\n\n- MATE Power Management — Herramientas de administración de energía para MATE.\n\n- MATE Power Statistics — Información y estadísticas de la energía del sistema para MATE.\n\n- Xfce Power Manager — Administración de energía para Xfce.\n\n- vattery — Aplicación de monitorización de la batería escrito en Vala que muestra el estado de la batería del portátil en la bandeja del sistema.\n\n"
    },
    {
      "title": "Eventos de ACPI",
      "level": 3,
      "content": "Systemd puede manejar algunos eventos ACPI («Interfaz Avanzada de Configuración y Energía») cuyas acciones pueden configurarse en /etc/systemd/logind.conf o en /etc/systemd/logind.conf.d/*.conf — vea logind.conf(5). En sistemas que no tienen un administrador de energía dedicado puede que los ajustes se remplacen con el demonio acpid que se usa normalmente para reaccionar a los eventos ACPI.\n\nLa acción especificada para cada evento puede ser una de las siguientes: ignore, poweroff, reboot, halt, suspend, hibernate, hybrid-sleep, suspend-then-hibernate, lock o kexec. En caso de hibernar y suspender deben ajustarse apropiadamente. Si un evento no esta configurado systemd utilizara la acción por defecto.\n\nTable content:\nControlador de evento | Descripción | Acción por defecto\nHandlePowerKey | Especifica qué acción se invoca cuando el botón de encendido se pulsa. | poweroff\nHandleSuspendKey | Especifica qué acción se invoca cuando se pulsa el botón de suspensión. | suspend\nHandleHibernateKey | Especifica qué acción se invoca cuando se pulsa el botón de hibernación. | hibernate\nHandleLidSwitch | Especifica qué acción se invoca cuando la tapa del portátil se cierra a excepción de los casos descritos más abajo. | suspend\nHandleLidSwitchDocked | Especifica que acción se invoca la tapa del portátil se cierra si el sistema está insertado en una estación de acoplamiento o si hay más de una pantalla conectada. | ignore\nHandleLidSwitchExternalPower | TEspecifica que acción se invoca la tapa del portátil se cierra si el sistema está conectado a una fuente de corriente externa. | Acción establecida por HandleLidSwitch\n\nPara aplicar cualquier cambio reinicie systemd-logind.service (esto terminará todas las sesiones iniciadas).\n\n"
    },
    {
      "title": "Administradores de energía",
      "level": 4,
      "content": "Algunos entornos de escritorio incluyen administradores de energía que inhiben (desactiva temporalmente) algunos o todos los ajustes ACPI de systemd. Si hay algún administrador de energía ejecutándose las acciones ACPI solo se pueden configurar en el administrador de energía. Los cambios en /etc/systemd/logind.conf o /etc/systemd/logind.conf.d/*.conf solo se necesitan hacer solo si desea configurar algún evento particular que no inhibe el administrador de energía.\n\nTenga en cuenta que el administrador de energía no inhibe systemd en los eventos apropiados en los que pueden terminar con una situación en la que systemd suspenda su sistema y después de que systemd lo despierte el otro administrador de energía vuelva a suspender el equipo. En diciembre de 2016 los administradores de energía como KDE, GNOME, Xfce y MATE solucionan los comandos necesarios inhibidos. Si los comandos inhibidos no se han solucionado, como cuando se utiliza acpid o otros administradores de eventos ACPI, establezca la opción Handle a ignore. Vea también systemd-inhibit(1).\n\n"
    },
    {
      "title": "xss-lock",
      "level": 4,
      "content": "xss-lock Funciona con los eventos de systemd suspend, hibernate, lock-session, y unlock-session con las acciones apropiadas (ejecutar el bloqueador y espera al usuario para desbloquearse o terminar el bloqueador). xss-lock también reacciona a los eventos DPMS y ejecuta o termina el bloqueador en respuesta.\n\nInicie xss-lock en su archivo de inicio en el arranque así:\n\n```\nxss-lock -- i3lock -n -i background_image.png &\n```\n\n"
    },
    {
      "title": "Suspensión e hibernación",
      "level": 3,
      "content": "Systemd proporciona órdenes para suspender en RAM, hibernar y una suspensión hibrida usando le funcionalidad de suspensión/reanudación nativa del kernel. También existen mecanismos para agregar hooks para personalizar las acciones de pre y post-suspensión.\n\nsystemctl suspend debería funcionar tras su instalación, sin embargo, para que systemctl hibernate pueda trabajar en su sistema debe seguir las instrucciones de hibernar.\n\nAquí hay dos modos de combinar la suspensión y la hibernación:\n\n- systemctl hybrid-sleep suspende el sistema en RAM y en disco, así cuando el sistema se quede completamente sin energía no se perderán los datos. Este modo se llama también suspensión híbrida.\n- systemctl suspend-then-hibernate inicialmente suspende el sistema en RAM y si no se interrumpe en el periodo de tiempo especificado en HibernateDelaySec en systemd-sleep.conf(5) el sistema se despertará utilizando una alarma RTC y se hibernará.\n\n"
    },
    {
      "title": "Suspensión híbrida en suspensión o en hibernación",
      "level": 4,
      "content": "Es posible configurar systemd para que siempre haga una suspensión híbrida cuando se realice una petición de suspensión o hibernación.\n\nLa acción por defecto de suspender e hibernar se pueden configurar en el archivo /etc/systemd/sleep.conf. Para establecer ambas acciones a suspensión híbrida:\n\n```\n/etc/systemd/sleep.conf\n```\n\n```\n[Sleep]\n# suspend=hybrid-sleep\nSuspendMode=suspend\nSuspendState=disk\n# hibernate=hybrid-sleep\nHibernateMode=suspend\nHibernateState=disk\n```\n\nVea la página sleep.conf.d(5) del manual para más detalles y la documentación de los estados de energía del kernel linux.\n\n"
    },
    {
      "title": "Archivos de servicios para suspender/reanudar",
      "level": 4,
      "content": "Los archivos de servicios pueden ser asociados a suspend.target, hibernate.target, sleep.target, hybrid-sleep.target y suspend-then-hibernate.target para ejecutar acciones antes o después de suspender/hibernar. Deben crearse archivos separados para las acciones del usuario y las acciones de root/sistema. Active los servicios suspend@user y resume@user para que se inicien en el arranque. Ejemplos:\n\n```\n/etc/systemd/system/suspend@.service\n```\n\n```\n[Unit]\nDescription=User suspend actions\nBefore=sleep.target\n\n[Service]\nUser=%I\nType=forking\nEnvironment=DISPLAY=:0\nExecStartPre= -/usr/bin/pkill -u %u unison ; /usr/local/bin/music.sh stop ; /usr/bin/mysql -e 'slave stop'\nExecStart=/usr/bin/sflock\n\n[Install]\nWantedBy=sleep.target\n```\n\n```\n/etc/systemd/system/resume@.service\n```\n\n```\n[Unit]\nDescription=User resume actions\nAfter=suspend.target\n\n[Service]\nUser=%I\nType=simple\nExecStartPre=/usr/local/bin/ssh-connect.sh\nExecStart=/usr/bin/mysql -e 'slave start'\n\n[Install]\nWantedBy=suspend.target\n```\n\nPara las acciones de root/sistema (active root-resume y los servicios root-suspend para iniciarlos en el arranque):\n\n```\n/etc/systemd/system/root-suspend.service\n```\n\n```\n[Unit]\nDescription=Local system resume actions\nAfter=suspend.target\n\n[Service]\nType=simple\nExecStart=/usr/bin/systemctl restart mnt-media.automount\n\n[Install]\nWantedBy=suspend.target\n```\n\n```\n/etc/systemd/system/root-resume.service\n```\n\n```\n[Unit]\nDescription=Local system suspend actions\nBefore=sleep.target\n\n[Service]\nType=simple\nExecStart=-/usr/bin/pkill -9 sshfs\n\n[Install]\nWantedBy=sleep.target\n```\n\n- Si está presente Type=OneShot, entonces puede utilizar múltiples líneas ExecStart=. De lo contrario, solo está permitida una línea ExecStart. No obstante, puede agregar más órdenes con ExecStartPre o mediante la separación de las órdenes con un punto y coma (véase el primer ejemplo de arriba; fíjese en los espacios en blanco antes y después del punto y coma... ¡estos son necesarios!).\n- Una orden con un prefijo - causará un código de salida distinto de cero que será ignorado y la orden será tratada como cumplida.\n- El mejor método para encontrar errores a fin de solucionar problemas con estos archivos de servicios es, por supuesto, con systemd (Español)/Journal (Español).\n\n"
    },
    {
      "title": "Archivo de servicio combinando suspensión/reanudación",
      "level": 4,
      "content": "Con el archivo de servicio que combina suspender/reanudar, un solo hook puede hacer todo el trabajo para las diferentes fases (dormir/continuar) y para diferentes objetivos (suspender/hibernar/suspensión híbrida).\n\nHe aquí un ejemplo y su explicación:\n\n```\n/etc/systemd/system/wicd-sleep.service\n```\n\n```\n[Unit]\nDescription=Wicd sleep hook\nBefore=sleep.target\nStopWhenUnneeded=yes\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStart=-/usr/share/wicd/daemon/suspend.py\nExecStop=-/usr/share/wicd/daemon/autoconnect.py\n\n[Install]\nWantedBy=sleep.target\n```\n\n- RemainAfterExit=yes: Después de que se inicie el servicio se mantendrá siempre activo hasta que se detenga explícitamente.\n- StopWhenUnneeded=yes: Cuando se active, el servicio se detendrá si ningún servicio activo lo requiere. En este caso el servicio se detendrá después de que se detenga sleep.target.\n- Debido a que sleep.target es apartado por suspend.target, hibernate.target y hybrid-sleep.target y debido a que sleep.target es en sí mismo un servicio StopWhenUnneeded garantiza que el hook iniciará/detendrá correctamente las diferentes tareas.\n\n"
    },
    {
      "title": "Hooks en /usr/lib/systemd/system-sleep",
      "level": 4,
      "content": "Systemd iniciará todos los archivos ejecutables ubicados en /usr/lib/systemd/system-sleep/, y pasará dos argumentos a cada uno de ellos:\n\n- Argument 1: o bien pre o post, dependiendo de si la máquina se está durmiendo o despertando.\n- Argument 2: suspend, hibernate o hybrid-sleep, dependiendo de lo que se ha invocado.\n\nSystemd ejecutará estos scripts en paralelo y no uno tras el otro.\n\nLas salidas de cualquier script personalizado se registrarán por systemd-suspend.service, systemd-hibernate.service o systemd-hybrid-sleep.service. Se pueden ver las salidas en el systemd (Español)/Journal (Español) de systemd:\n\n```\n# journalctl -b -u systemd-suspend.service\n```\n\nHe aquí un ejemplo de script de sleep personalizado:\n\n```\n/usr/lib/systemd/system-sleep/example.sh\n```\n\n```\n#!/bin/sh\ncase $1/$2 in\n  pre/*)\n    echo \"Going to $2...\"\n    ;;\n  post/*)\n    echo \"Waking up from $2...\"\n    ;;\nesac\n```\n\nNo debemos olvidarnos de hacer el script ejecutable:\n\n```\n# chmod a+x /usr/lib/systemd/system-sleep/example.sh\n```\n\nVéanse systemd.special(7) y systemd-sleep(8) para obtener más información.\n\n"
    },
    {
      "title": "Acción retardada del interruptor de la tapa",
      "level": 4,
      "content": "Al hacer cambios en la tapa muy rápido, logind retarda la acción de suspender hasta 90s para detectar posibles muelles. [1] Este retardo se hizo configurable en systemd v220: [2]\n\n```\n/etc/systemd/logind.conf\n```\n\n```\n...\nHoldoffTimeoutSec=30s\n...\n```\n\n"
    },
    {
      "title": "La suspensión desde la tecla Fn correspondiente del portátil no funciona",
      "level": 4,
      "content": "Si, independientemente de la configuración de logind.conf, el botón dormir no funciona (presionándolo no produce ningún mensaje en syslog) logind probablemente no vea el dispositivo de teclado. [3] Realice:\n\n```\n# journalctl --grep=\"Watching system buttons\"\n```\n\nDebería ver algo como esto:\n\n```\nMay 25 21:28:19 vmarch.lan systemd-logind[210]: Watching system buttons on /dev/input/event2 (Power Button)\nMay 25 21:28:19 vmarch.lan systemd-logind[210]: Watching system buttons on /dev/input/event3 (Sleep Button)\nMay 25 21:28:19 vmarch.lan systemd-logind[210]: Watching system buttons on /dev/input/event4 (Video Bus)\n```\n\nNote que no hay ningún dispositivo teclado. Ahora obtenga el nombre ATTRS del dispositivo de teclado [4] :\n\n```\n# udevadm info -a /dev/input/by-path/*-kbd\n```\n\n```\n...\nKERNEL==\"event0\"\n...\nATTRS{name}==\"AT Translated Set 2 keyboard\"\n```\n\nAhora escriba una regla personalizada udev para añadir la etiqueta \"power-switch\":\n\n```\n/etc/udev/rules.d/70-power-switch-my.rules\n```\n\n```\nACTION==\"remove\", GOTO=\"power_switch_my_end\"\nSUBSYSTEM==\"input\", KERNEL==\"event*\", ATTRS{name}==\"AT Translated Set 2 keyboard\", TAG+=\"power-switch\"\nLABEL=\"power_switch_my_end\"\n```\n\nReinicie los servicios y recargue las reglas:\n\n```\n# systemctl restart systemd-udevd.service\n# udevadm trigger\n# systemctl restart systemd-logind.service\n```\n\nAhora debe ver Watching system buttons on /dev/input/event0 en syslog.\n\n"
    },
    {
      "title": "Ahorrar energía",
      "level": 2,
      "content": "Esta sección es una referencia para crear scripts personalizados y ajustar el ahorro energético mediante las reglas udev. Asegurese de que no están administradas por alguna otra herramienta para evitar conflictos.\n\nCasi todas las características que se listan aquí serán útiles dependiendo de si el ordenador está conectado a corriente o a la batería. Muchas tiene un impacto considerable en el rendimiento y no están habilitadas por defecto porque normalmente causan problemas con los controladores/hardware. Reducir el uso de energía significa reducir el calor con el que se puede conseguir un mayor rendimiento en un CPU Intel o AMD moderno gracias al overclocking dinámico.\n\n"
    },
    {
      "title": "Procesadores con soporte HWP (Hardware P-state)",
      "level": 3,
      "content": "Las preferencias disponibles para la energía de un procesador que soporta HWP son default performance balance_performance balance_power power.\n\nEsto se puede comprobar con $ cat /sys/devices/system/cpu/cpufreq/policy?/energy_performance_available_preferences\n\nPara conservar más energía puede configurarlo creando la siguiente línea:\n\n```\n/etc/tmpfiles.d/energy_performance_preference.conf\n```\n\n```\nw /sys/devices/system/cpu/cpufreq/policy?/energy_performance_preference - - - - balance_power\n```\n\nVea las páginas de manual systemd-tmpfiles(8) y tmpfiles.d(5) para más detalles.\n\n"
    },
    {
      "title": "Audio",
      "level": 3,
      "content": "Por defecto el ahorro de energía de audio está apagado por muchos controladores. Se puede activar ajustando el parámetro power_save: tiempo (en segundos) para cambiar al modo en reposo. Para dejar en reposo la tarjeta de sonido después de un segundo crea la siguiente línea para las tarjetas de sonido Intel.\n\n```\n/etc/modprobe.d/audio_powersave.conf\n```\n\n```\noptions snd_hda_intel power_save=1\n```\n\nAlternativamente, utilice la siguiente para ac97:\n\n```\noptions snd_ac97_codec power_save=1\n```\n\n- Para recuperar el fabricante y el controlador correspondiente del núcleo que se está utilizando en su tarjeta de sonido ejecute lspci -k.\n- Cambiar el estado de energía de las tarjetas de sonido puede causar que suene un estallido o una latencia notable en algún dispositivo roto.\n\nEs posible reducir los requerimientos de energía de audio desactivando la salida de audio HDMI que se puede hacer añadiendo en la lista negra los módulos del núcleo apropiados (por ejemplo en caso de dispositivos Intel snd_hda_codec_hdmi).\n\n"
    },
    {
      "title": "Retroiluminación",
      "level": 3,
      "content": "Vea retroiluminación.\n\n"
    },
    {
      "title": "Bluetooth",
      "level": 3,
      "content": "Para desactivar completamente el bluetooth añada en la lista negra los módulos btusb y bluetooth.\n\nPara apagar el bluetooth temporalmente utilice rfkill:\n\n```\n# rfkill block bluetooth\n```\n\nO con una regla udev:\n\n```\n/etc/udev/rules.d/50-bluetooth.rules\n```\n\n```\n# disable bluetooth\nSUBSYSTEM==\"rfkill\", ATTR{type}==\"bluetooth\", ATTR{state}=\"0\"\n```\n\n"
    },
    {
      "title": "Cámara web",
      "level": 3,
      "content": "Si no va a utilizar la cámara web integrada añada en la lista negra el módulo uvcvideo.\n\n"
    },
    {
      "title": "Parámetros Kernel",
      "level": 3,
      "content": "Esta sección utiliza las configuraciones en /etc/sysctl.d/ que es \"un directorio para los parámetros de sysctl del kernel.\" Vea Los nuevos archivos de configuración y más especificamente sysctl.d(5) para más información.\n\n"
    },
    {
      "title": "Desactivar NMI watchdog",
      "level": 4,
      "content": "El watchdog NMI es una característica de desarrollador que captura los cuelgues que causan el kernel panic. En algunos sistemas puede generar muchas interrupciones causando un aumento del uso energético:\n\n```\n/etc/sysctl.d/disable_watchdog.conf\n```\n\n```\nkernel.nmi_watchdog = 0\n```\n\no añada nmi_watchdog=0 al parámetro kernel para desactivarlo completamente desde el principio del arranque.\n\n"
    },
    {
      "title": "Tiempo de reescritura",
      "level": 4,
      "content": "Aumentando el tiempo de reescritura de la sucia memoria virtual ayuda a agregar discos I/O juntos reduciendo así las escrituras en disco distribuidas y aumentando el ahorro energético. Para establecer este valor en 60 segundos (por defecto está en 5 segundos):\n\n```\n/etc/sysctl.d/dirty.conf\n```\n\n```\nvm.dirty_writeback_centisecs = 6000\n```\n\nPara hacer lo mismo con las actualizaciones de journal en los sistemas de ficheros soportados (p.ej. ext4, btrfs...) utilice commit=60 como una opción en fstab.\n\nNote que modificando este valor tiene un efecto secundario de la configuración del modo portátil descrito a continuación. Vea también memoria virtual para otros parámetros que afectan al rendimiento I/O y ahorran energía.\n\n"
    },
    {
      "title": "Modo portátil",
      "level": 4,
      "content": "Vea la documentación del kernel en el modo portatil 'knob.' \"Un valor sensible para knob es 5 segundos.\"\n\n```\n/etc/sysctl.d/laptop.conf\n```\n\n```\nvm.laptop_mode = 5\n```\n\n"
    },
    {
      "title": "Interfaces de red",
      "level": 3,
      "content": "Wake-on-LAN Puede ser una característica útil pero si no va hacer uso de ella es simplemente un consumo extra de energía esperando un paquete mágico mientras está en suspensión. Puede adaptar la regla udev para deactivar la característica para todas las interfaces de red. Para activar el ahorro de energía con iw en todas las interfaces inalámbricas:\n\n```\n/etc/udev/rules.d/81-wifi-powersave.rules\n```\n\n```\nACTION==\"add\", SUBSYSTEM==\"net\", KERNEL==\"wl*\", RUN+=\"/usr/bin/iw dev $name set power_save on\"\n```\n\nEl nombre del archivo de configuración es importante. Con el uso de nombres fijos de dispositivos, en systemd la regla de red de arriba, nombrado léxico-gráficamente después 80-net-setup-link.rules, se aplica después de que el servicio se renombre con un nombre fijo p.ej wlan0 renombrada a wlp3s0. Tenga en cuenta que el comando RUN se ejecuta después de que todas las reglas se hayan procesado y tienen que utilizar de cualquier forma el nombre fijo disponible en $name para el dispositivo emparejado.\n\n"
    },
    {
      "title": "Tarjetas inalámbricas Intel (iwlwifi)",
      "level": 4,
      "content": "Se pueden activar funciones adicionales de ahorro de energía de las tarjetas inalámbricas Intel con el controlador iwlwifi pasando los parámetros correctos al módulo kernel. Para hacerlo permanente se puede guardad añadiendo la línea de debajo al archivo /etc/modprobe.d/iwlwifi.conf file:\n\n```\noptions iwlwifi power_save=1 d0i3_disable=0 uapsd_disable=0\noptions iwldvm force_cam=0\n```\n\nTenga en mente que estas opciones de ahorro de energía son experimentales y pueden causar inestabilidades en el sistema.\n\n"
    },
    {
      "title": "Administración de energía en estado activo",
      "level": 4,
      "content": "Si cree que el ordenador no soporta ASPM se desactivará en el aranque:\n\n```\n# lspci -vv | grep 'ASPM.*abled;'\n```\n\nASPM lo maneja la BIOS. Si ASPM está desactivado puede ser porque[enlace roto 2024-10-12]:\n\n1. La BIOS lo ha desactivado por alguna razón (¿Por conflictos?).\n1. La PCIE requiere ASPM pero L0s es opcional (puede que L0s esté desactivado y solo esté activado L1).\n1. La BIOS aún no ha sido programada para ello.\n1. La BIOS esta defectuosa.\n\nSi cree que el ordenador tiene soporte para ASPM se puede forzar al kernel que se encargue con el parámetro kernel pcie_aspm=force.\n\n- Forzar ASPM puede causar un congelamiento/error fatal. Así que asegurese que tiene alguna forma de deshacer la opción si no funciona.\n- En los sistemas que no soportan forzar ASPM pueden incrementar el consumo de energía.\n- Esto fuerza ASPM en el kernel mientras puede estar desactivado en el hardware y no funcione. Para comprobar si este es el caso se puede utilizar el comando dmesg | grep ASPM y si es el caso se debe consultar el artículo Wiki específico del hardware.\n\nPara ajustar el powersave ejecute (el siguiente comando no funcionara a no ser que este activado):\n\n```\n# echo powersave > /sys/module/pcie_aspm/parameters/policy\n```\n\nPor defecto se mostrara como esto:\n\n```\n$ cat /sys/module/pcie_aspm/parameters/policy\n```\n\n```\n[default] performance powersave\n```\n\n"
    },
    {
      "title": "Administración de energía PCI en tiempo de ejecución",
      "level": 4,
      "content": "```\n/etc/udev/rules.d/pci_pm.rules\n```\n\n```\nSUBSYSTEM==\"pci\", ATTR{power/control}=\"auto\"\n```\n\nLa regla de arriba apaga todos los dispositivos no utilizados pero algunos dispositivos no se despertarán. Para permitir la administración de energía PCI en tiempo de ejecución que sabe que funcionan utilice simplemente la combinación de vendedor y el ID del dispositivo (utilice lspci -nn para obtener estos valores):\n\n```\n/etc/udev/rules.d/pci_pm.rules\n```\n\n```\n# Lista blanca para la auto suspensión pci\nSUBSYSTEM==\"pci\", ATTR{vendor}==\"0x1234\", ATTR{device}==\"0x1234\", ATTR{power/control}=\"auto\"\n```\n\nAlternativamente para poner en la lista negra los dispositivos que no funcionan con la administración de energía PCI en tiempo de ejecución y activarlo para todos los demás dispositivos:\n\n```\n/etc/udev/rules.d/pci_pm.rules\n```\n\n```\n# Lista negra para la administración de energía PCI en tiempo de ejecución\nSUBSYSTEM==\"pci\", ATTR{vendor}==\"0x1234\", ATTR{device}==\"0x1234\", ATTR{power/control}=\"on\", GOTO=\"pci_pm_end\"\n\nSUBSYSTEM==\"pci\", ATTR{power/control}=\"auto\"\nLABEL=\"pci_pm_end\"\n```\n\n"
    },
    {
      "title": "Auto suspensión USB",
      "level": 4,
      "content": "El kernel Linux puede suspender automáticamente los dispositivos USB cuando no se utilizan. Esto ocasionalmente puede ahorrar un poco de energía. Sin embargo algunos dispositivos USB no son compatibles con el ahorro de energía USB y se inicia con un mal comportamiento (normalmente con ratones y teclados). Las reglas udev basadas en la lista blanca o lista negra puede ayudar a mitigar el problema.\n\nLo más simple y seguramente inservible es habilitar la auto suspensión para todos los dispositivos USB:\n\n```\n/etc/udev/rules.d/50-usb_power_save.rules\n```\n\n```\nACTION==\"add\", SUBSYSTEM==\"usb\", TEST==\"power/control\", ATTR{power/control}=\"auto\"\n```\n\nPara permitir auto suspender solo los dispositivos que sabe que van a funcionar simplemente utilice la combinación entre vendedor y el ID del producto (utilice lsusb para obtener estos valores):\n\n```\n/etc/udev/rules.d/50-usb_power_save.rules\n```\n\n```\n# Lista blanca auto suspensión usb\nACTION==\"add\", SUBSYSTEM==\"usb\", TEST==\"power/control\", ATTR{idVendor}==\"05c6\", ATTR{idProduct}==\"9205\", ATTR{power/control}=\"auto\"\n```\n\nAlternativamente para poner en la lista negra los dispositivos que no funcionan con la auto suspensión USB y activarlo para el resto de dispositivos:\n\n```\n/etc/udev/rules.d/50-usb_power_save.rules\n```\n\n```\n# Lista negra auto suspensión usb\nACTION==\"add\", SUBSYSTEM==\"usb\", ATTR{idVendor}==\"05c6\", ATTR{idProduct}==\"9205\", GOTO=\"power_usb_rules_end\"\n\nACTION==\"add\", SUBSYSTEM==\"usb\", TEST==\"power/control\", ATTR{power/control}=\"auto\"\nLABEL=\"power_usb_rules_end\"\n```\n\nEl tiempo de retardo por defecto en la auto suspensión se controla con el parámetro autosuspend del módulo kernel usbcore. Para establecer el retardo a 5 segundos en vez de los 2 segundos por defecto:\n\n```\n/etc/modprobe.d/usb-autosuspend.conf\n```\n\n```\noptions usbcore autosuspend=5\n```\n\nDe forma similar para power/control el tiempo de retardo puede personalizarse para cada dispositivo ajustando el atributo power/autosuspend.\n\nVea la documentación kernel de Linux para más información sobre la administración de energía USB.\n\n"
    },
    {
      "title": "Administración de energía de enlace activo SATA",
      "level": 4,
      "content": "Desde Linux 4.15 hay un nuevo ajuste llamado med_power_with_dipm que marca el comportamiento de los ajustes del controlador Windows IRST y no debería causar pérdida de datos en discos SSD/HDD recientes. El ahorro de energía puede ser insignificante, entre 1.0 a 1.5 Vatios (en reposo). Será un ajuste por defecto en los portátiles basados en Intel en Linux 4.16 [5].\n\nLos ajustes actuales se pueden leer desde /sys/class/scsi_host/host*/link_power_management_policy como sigue:\n\n```\n# cat /sys/class/scsi_host/host*/link_power_management_policy\n```\n\nTable content:\nAjuste | Descripción | Ahorro energético\nmax_performance | Actualmente por defecto | Ninguno\nmedium_power | - | ~1.0 Vatios\nmed_power_with_dipm | Ajuste recomendado | ~1.5 Vatios\nmin_power | ADVERTENCIA: Posible pérdida de datos | ~1.5 Vatios\n\n```\n/etc/udev/rules.d/hd_power_save.rules\n```\n\n```\nACTION==\"add\", SUBSYSTEM==\"scsi_host\", KERNEL==\"host*\", ATTR{link_power_management_policy}=\"med_power_with_dipm\"\n```\n\n"
    },
    {
      "title": "Controlador de disco duro",
      "level": 3,
      "content": "Vea Configuración energética hd para más información sobre los parámentros que se pueden establecer.\n\nEl ahorro energético no es efectivo cuando varios programas están escribiendo en el disco duro. Siga todos los programas y como y cuando escriben en el disco para poder limitar el uso del disco. Utilice iotop para ver qué programas utilizan el disco frecuentemente. Vea mejorar el rendimiento de dispositivos de almacenamiento para otros consejos.\n\nTambién detalles como ajustar la opción noatime puede ayudar. Si hay suficiente RAM disponible considere limitar o deshabilitar swappiness limitando posiblemente un gran número de escrituras a disco.\n\n"
    },
    {
      "title": "Utilizar un script y una regla udev",
      "level": 3,
      "content": "Desde que los usuarios de systemd pueden suspender o hibernar a través de systemctl suspend o systemctl hibernate y encargarse de los eventos acpi con /etc/systemd/logind.conf puede ser interesante eliminar pm-utils y acpid. Solo hay una cosa que systemd no puede hacer (a partir de systemd-204): administrar la energía dependiendo su el sistema está ejecutando con AC o con batería. Para solventar esto puede crear una regla udev simple que ejecute un script cuando el adaptador AC se conecte y desconecte:\n\n```\n/etc/udev/rules.d/powersave.rules\n```\n\n```\nSUBSYSTEM==\"power_supply\", ATTR{online}==\"0\", RUN+=\"/path/to/your/script true\"\nSUBSYSTEM==\"power_supply\", ATTR{online}==\"1\", RUN+=\"/path/to/your/script false\"\n```\n\nEjemplo de un script de powersave:\n\n- ftw, paquete: ftw-gitAUR\n- powersave\n- throttlectl, de throttlectlAUR\n\nLas reglas udev de arriba suelen funcionar como se esperan pero su sus ajustes de energía no se actualizan después de suspender o hibernar debe añadir un script en /usr/lib/systemd/system-sleep/ con el siguiente contenido:\n\n```\n/usr/lib/systemd/system-sleep/00powersave\n```\n\n```\n#!/bin/sh\n\ncase $1 in\n    pre) /ruta/a/su/script false ;;\n    post)       \n\tif cat /sys/class/power_supply/AC0/online | grep 0 > /dev/null 2>&1\n\tthen\n    \t\t/ruta/a/su/script true\t\n\telse\n    \t\t/ruta/a/su/script false\n\tfi\n    ;;\nesac\nexit 0\n```\n\n¡No olvide hacerlo ejecutable!\n\n"
    },
    {
      "title": "Ajustes de energía de la impresora",
      "level": 3,
      "content": "Este script ajusta la administra energéticamente la impresora y otras propiedades para los dispositivos PCI y USB. Note que se necesitan permisos root para ver todos los ajustes.\n\n```\n#!/bin/bash\n\nfor i in $(find /sys/devices -name \"bMaxPower\")\ndo\n\tbusdir=${i%/*}\n\tbusnum=$(<$busdir/busnum)\n\tdevnum=$(<$busdir/devnum)\n\ttitle=$(lsusb -s $busnum:$devnum)\n\n\tprintf \"\\n\\n+++ %s\\n  -%s\\n\" \"$title\" \"$busdir\"\n\n\tfor ff in $(find $busdir/power -type f ! -empty 2>/dev/null)\n\tdo\n\t\tv=$(cat $ff 2>/dev/null|tr -d \"\\n\")\n\t\t[[ ${#v} -gt 0 ]] && echo -e \" ${ff##*/}=$v\";\n\t\tv=;\n\tdone | sort -g;\ndone;\n\nprintf \"\\n\\n\\n+++ %s\\n\" \"Kernel Modules\"\nfor mod in $(lspci -k | sed -n '/in use:/s,^.*: ,,p' | sort -u)\ndo\n\techo \"+ $mod\";\n\tsystool -v -m $mod 2> /dev/null | sed -n \"/Parameters:/,/^$/p\";\ndone\n```\n\n"
    },
    {
      "title": "Vea también",
      "level": 2,
      "content": "- ThinkWiki:Como reducir el consumo energético (en inglés).\n- Como tener una mayor duración de la batería en Linux (en inglés).\n\n"
    }
  ]
}