{
  "title": "Overlay filesystem (Русский)",
  "url": "https://wiki.archlinux.org/title/Overlay_filesystem_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Из первоначального коммита в ядро:\n\nOverlayfs доступен в ядре Linux с версии 3.18.\n\n"
    },
    {
      "title": "Установка",
      "level": 2,
      "content": "Overlayfs включён в ядре по умолчанию, а модуль overlay автоматически подгружается после ввода команды монтирования.\n\n"
    },
    {
      "title": "Использование",
      "level": 2,
      "content": "Используйте следующие аргументы mount для монтирования overlay:\n\n```\n# mount -t overlay overlay -o lowerdir=/lower,upperdir=/upper,workdir=/work /merged\n```\n\nНижняя директория может быть списком каталогов, разделённых :, все изменения в каталоге merged по-прежнему будут отражаться в upper.\n\nПример:\n\n```\n# mount -t overlay overlay -o lowerdir=/lower1:/lower2:/lower3,upperdir=/upper,workdir=/work /merged\n```\n\nNote: Таким образом порядок слоёв из вышеупомянутого примера будет следующим:\n\nТаким образом порядок слоёв из вышеупомянутого примера будет следующим:\n\n```\n/upper\n/lower1\n/lower2\n/lower3\n```\n\nИспользуйте следующий формат, чтобы добавить запись overlayfs в /etc/fstab:\n\n```\n/etc/fstab\n```\n\n```\noverlay /merged overlay noauto,x-systemd.automount,lowerdir=/lower,upperdir=/upper,workdir=/work 0 0\n```\n\nПараметры монтирования noauto и x-systemd.automount необходимы для предотвращения зависания systemd при загрузке, например, из-за ошибки монтирования overlay. Также overlay теперь будет монтироваться при первом обращении, а запросы будут буферизироваться до готовности самого overlay. Для получения дополнительной информации смотрите раздел Fstab (Русский)#Автоматическое монтирование с systemd.\n\n"
    },
    {
      "title": "Overlay только для чтения",
      "level": 3,
      "content": "Иногда необходимо создать представление из комбинации двух или более каталогов, доступное только для чтения. В этом случае его можно создать более простым способом, так как каталоги upper и work не обязательны:\n\n```\n# mount -t overlay overlay -o lowerdir=/lower1:/lower2 /merged\n```\n\nКогда upperdir не указан, overlay автоматически монтируется только для чтения.\n\n"
    },
    {
      "title": "Смотрите также",
      "level": 2,
      "content": "- Документация файловой системы Overlay\n- Обзор OverlayFS - что она делает и как работает\n- Wikipedia:OverlayFS\n\n"
    }
  ]
}