{
  "title": "Fcitx (日本語)",
  "url": "https://wiki.archlinux.org/title/Fcitx_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- Fcitx5\n- IBus\n- SCIM\n- UIM\n\nFcitx (Flexible Input Method Framework) は Linux に環境非依存の言語サポートを提供する軽量の インプットメソッドフレームワーク です。多くの言語をサポートし便利な non-CJK 機能が含まれています。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 インストール 1.1 インプットメソッドエンジン 1.1.1 中国語 1.1.2 日本語 1.1.3 他の言語 1.2 インプットメソッドモジュール 1.3 その他\n- 2 使用方法 2.1 デスクトップ環境での自動起動 2.2 インプットメソッドモジュールの環境変数の設定 2.3 Xim\n- 3 設定 3.1 設定ツール 3.2 入力メソッドの設定 3.3 デフォルト UI の変更 3.4 ピンイン辞書の拡張 3.5 スキン 3.6 cloud ピンインの設定\n- 4 ヒントとテクニック 4.1 ショートカットキー 4.2 Vim 4.3 クリップボード 4.4 特殊記号 4.5 クリップボードアクセス 4.6 fcitx-remote（リモート） 4.7 特殊文字入力\n- 5 トラブルシューティング 5.1 トリガー入力方法の追加キー を無効化または変更する [sic] 5.2 問題の診断 5.3 Emacs 5.3.1 Emacs デーモン 5.4 Ctrl+Space が GTK のプログラムで機能しない 5.5 内蔵の Chinese Pinyin がデフォルトで有効にならない 5.6 fcitx と KDE 5.7 勝手にインプットメソッドが英語に切り替わってしまう 5.8 GNOME/Wayland 上での Fcitx の利用 5.9 xmodmap の設定が上書きされる 5.10 HiDPI 環境では Fcitx の preedit box が小さすぎる\n- 6 参照\n\n- 1.1 インプットメソッドエンジン 1.1.1 中国語 1.1.2 日本語 1.1.3 他の言語\n- 1.2 インプットメソッドモジュール\n- 1.3 その他\n\n- 1.1.1 中国語\n- 1.1.2 日本語\n- 1.1.3 他の言語\n\n- 2.1 デスクトップ環境での自動起動\n- 2.2 インプットメソッドモジュールの環境変数の設定\n- 2.3 Xim\n\n- 3.1 設定ツール\n- 3.2 入力メソッドの設定\n- 3.3 デフォルト UI の変更\n- 3.4 ピンイン辞書の拡張\n- 3.5 スキン\n- 3.6 cloud ピンインの設定\n\n- 4.1 ショートカットキー\n- 4.2 Vim\n- 4.3 クリップボード\n- 4.4 特殊記号\n- 4.5 クリップボードアクセス\n- 4.6 fcitx-remote（リモート）\n- 4.7 特殊文字入力\n\n- 5.1 トリガー入力方法の追加キー を無効化または変更する [sic]\n- 5.2 問題の診断\n- 5.3 Emacs 5.3.1 Emacs デーモン\n- 5.4 Ctrl+Space が GTK のプログラムで機能しない\n- 5.5 内蔵の Chinese Pinyin がデフォルトで有効にならない\n- 5.6 fcitx と KDE\n- 5.7 勝手にインプットメソッドが英語に切り替わってしまう\n- 5.8 GNOME/Wayland 上での Fcitx の利用\n- 5.9 xmodmap の設定が上書きされる\n- 5.10 HiDPI 環境では Fcitx の preedit box が小さすぎる\n\n- 5.3.1 Emacs デーモン\n\n"
    },
    {
      "title": "インストール",
      "level": 2,
      "content": "fcitx は公式リポジトリから Pacman でインストールできます。\n\n"
    },
    {
      "title": "インプットメソッドエンジン",
      "level": 3,
      "content": "入力したい言語にあわせて、インプットメソッドエンジンをインストールしてください:\n\n"
    },
    {
      "title": "中国語",
      "level": 4,
      "content": "- fcitx-baidupinyinAUR: Baidu Pinyin インプットメソッドがベース。\n- fcitx-chewing: libchewing がベースの繁体字の注音入力エンジン。\n- fcitx-cloudpinyin: クラウドによる中国語入力をサポート。\n- fcitx-googlepinyin: libgooglepinyin がベース。Android 用の Google ピンイン IME。\n- fcitx-libpinyin: libpinyin がベース。fcitx-sunpinyin よりも優れたアルゴリズムが使われています。\n- fcitx-rime: Rime IME プロジェクトのスキーマがベース。\n- fcitx-sogoupinyinAUR: Linux 向けの捜狗インプットメソッド。同音異字、クラウド入力、英語入力、混合入力をサポート。\n- fcitx-sunpinyin: sunpinyin がベース。速度と正確性のバランスが良い。\n\n"
    },
    {
      "title": "日本語",
      "level": 4,
      "content": "- fcitx-anthy: 人気の日本語入力エンジン。開発は停止しています。\n- fcitx-mozc: Google 日本語入力のオープンソース版である Mozc がベース。\n- fcitx-kkc: libkkc がベースの新しい日本語仮名漢字入力エンジン。\n- fcitx-skk: libskk がベースの日本語仮名漢字入力エンジン。\n\n"
    },
    {
      "title": "他の言語",
      "level": 4,
      "content": "- fcitx-hangul: libhangul がベースの韓国語のハングル入力エンジン。\n- fcitx-m17n: M17n によって提供されている他の言語の入力エンジン。\n- fcitx-sayura: シンハラ文字入力エンジン。\n- fcitx-unikey: ベトナム文字入力エンジン。\n\n"
    },
    {
      "title": "インプットメソッドモジュール",
      "level": 3,
      "content": "GTK+ や Qt プログラムでより良い動作を得るには、必要に応じて fcitx-qt4AUR, fcitx-qt5 パッケージをインストールしてください。もしくは fcitx-im グループで全てのパッケージをインストールできます。モジュールをインストールしなくてもアプリケーション上でインプットメソッドは動作しますが、フリーズしたりプレビューウィンドウの位置がおかしくなったり、プレビューが表示されなくなったりします。\n\n以下のアプリケーションは GTK+/Qt インプットモジュールを使用しません:\n\n- Tk, motif, xlib などを使用するアプリケーション\n- Emacs, Opera, OpenOffice, LibreOffice, Skype, Wine, Java, Xterm, urxvt, WPS\n\n"
    },
    {
      "title": "その他",
      "level": 3,
      "content": "- fcitx-ui-light: fcitx の軽量 UI。\n- fcitx-table-extra: 倉頡, 郑码, 嘸蝦米サポートを追加。\n- fcitx-table-other: LaTeX, 絵文字など。\n- fcitx-tabletAUR: 手書きのタブレットサポート。\n- fcitx-tsundereAUR: 文字を入力した後に何某かを追加するモジュール。\n- kcm-fcitx: fcitx の KDE 設定モジュール。\n- #設定ツール\n\nfcitx のコンポーネントをインストールした後は fcitx の再起動が必要です。\n\n"
    },
    {
      "title": "デスクトップ環境での自動起動",
      "level": 3,
      "content": "KDE, GNOME (X 上で動作している場合), Xfce, LXDE などの XDG 互換のデスクトップ環境を使っている場合は、再ログインで自動的に起動するようになるはずです。起動しないときは、ターミナルを開いて次のように入力してください:\n\n```\n$ fcitx-autostart\n```\n\nfcitx が正しく動作しているか確認するために、leafpad といったアプリケーションを開いて Ctrl+Space (インプットメソッドの切り替えのデフォルトのショートカット) を押して FCITX を呼び出しなにか文字を入力してみて下さい。\n\nFcitx があなたの環境で自動で起動しない場合や fcitx を起動するパラメータを変更したい場合は、デスクトップ環境によって提供されているツールを使って xdg の自動起動を設定するか ~/.config/autostart/ ディレクトリ内の fcitx-autostart.desktop ファイルを編集してください (存在しないときは /etc/xdg/autostart/ からコピーしてください)。\n\nデスクトップ環境が xdg 自動起動をサポートしていない場合は、(環境変数を正しく設定した後に) 次の行をスタートアップスクリプトに追加してください:\n\n```\n$ fcitx-autostart\n```\n\nxim サポートのある他のインプットメソッドが動作していると、Fcitx は xim エラーで起動できません。Fcitx を起動する前に他のインプットメソッドが動いていないことを確認してください。\n\n"
    },
    {
      "title": "インプットメソッドモジュールの環境変数の設定",
      "level": 3,
      "content": "インプットメソッドモジュールを登録するために、以下の環境変数をセットします。\n\n```\nGTK_IM_MODULE=fcitx\nQT_IM_MODULE=fcitx\nXMODIFIERS=@im=fcitx\n```\n\nただし、Qt5 アプリケーションは XIM をサポートしていないため、IM モジュールのインストールが必要です。\n\nfcitx プロセスが自動的に起動しない場合、~/.xinitrc に fcitx & を追加する必要があるかもしれません。 もし fcitx & が起動しない場合は、その後に sleep 2 とタイプしてください。\n\n- このために .bashrc を使わないようにしてください。https://mywiki.wooledge.org/DotFiles を参照。\n- 全ての Qt アプリケーションで fcitx に問題がある場合、qtconfig (qtconfig-qt4) を実行し、3番目のタブで Default Input Method コンボボックスに fcitx があることを確認します。\n\n"
    },
    {
      "title": "Xim",
      "level": 3,
      "content": "任意で、上記のモジュールをインストールせずに、GTK や Qt のプログラム、あるいはその両方で X Input Method (XIM) を使用するように設定することも可能です。この場合、上記の対応する行を以下のように変更してください:\n\n```\nGTK_IM_MODULE DEFAULT = xim\nQT_IM_MODULE DEFAULT = xim\n```\n\n~/.xprofile または ~/.xinitrc を変更する場合は、export を追加します。\n\n変更を適用するためにログインしなおしてください。\n\n"
    },
    {
      "title": "設定ツール",
      "level": 3,
      "content": "Fcitx は GUI の設定ツールを提供しています。kcm-fcitx (KDE) または fcitx-configtool (GTK+3 ベース) がインストールできます。fcitx-configtool をインストールしたら fcitx-config-gtk3 を起動してください。別の言語のインプットメソッドを使用したいときは Only Show Current Language の設定を解除してください。\n\n設定を変更する前に fcitx は停止してください。停止しないと変更が反映されません。\n\nスペルチェックを有効にするには、fcitx が fcitx-keyboard によるインプットメソッドを使っている時に ctrl + alt + h を押して下さい。長い単語を入力すれば、動いているかどうか確認できます。\n\n"
    },
    {
      "title": "入力メソッドの設定",
      "level": 3,
      "content": "GUI ツールで入力メソッドの追加/削除が可能です。大文字と小文字を区別して検索することに注意してください。\n\n最初に設定された入力メソッドは非アクティブ状態、それ以外はすべてアクティブ状態になります。一般に、非アクティブ状態は キーボード オプションの1つです（例:\"キーボード - 英語（US）\") これらのオプションは、名前にあるキーボードレイアウトに基づいて入力するだけです。\n\nグローバル設定では、トリガー入力メソッドのショートカットは非アクティブ状態と最後に使用したアクティブ状態の間でしか切り替わりません。Scroll between Input Methods はデフォルトでは異なるアクティブ状態間のスクロールのみですが、詳細設定で非アクティブ状態を含むように設定することもできます。さらに、Scroll between Input Methods のショートカットは順番に押さなければなりません。例えば ALT_SHIFT は alt が shift より前に押されたときのみ有効になります。\n\nIME の設定は、キーボードを任意の IME に設定し、トレイアイコンを右クリックすることで確認できます。\n\n"
    },
    {
      "title": "デフォルト UI の変更",
      "level": 3,
      "content": "Fcitx は kimpanel プロトコルによるデスクトップの統合をサポートしています。\n\n- Gnome-Shell: extensions.gnome.org や gnome-shell-extension-kimpanel-gitAUR パッケージから kimpanel をインストールでき、ibus-gjs と同じように使うことができます。\n- KDE: kimtoy は Sogou や fcitx のスキンを使えます。\n\n"
    },
    {
      "title": "ピンイン辞書の拡張",
      "level": 3,
      "content": "ピンイン辞書は ~/.config/fcitx/pinyin に存在します。pybase.mb ファイルには単一文字が pyphrase.mb ファイルにはピンインのフレーズが定義されています。拡張するには /usr/share/fcitx/pinyin にファイルを保存して fcitx を再起動してください。\n\n"
    },
    {
      "title": "スキン",
      "level": 3,
      "content": "スキンをダウンロードし、以下のディレクトリのいずれかに解凍します。ディレクトリが存在しない場合は、作成することができます。\n\n```\n/usr/share/fcitx/skin   #Global settings\n~/.config/fcitx/skin    #User settings\n```\n\n"
    },
    {
      "title": "cloud ピンインの設定",
      "level": 3,
      "content": "fcitx-cloudpinyin 入力メソッドをインストールした後、fcitx を再起動してください。コンフィギュレーション GUI で見つからない場合は、advanced settingsを有効にしてください。クラウドクエリの結果は自動的に現在の入力メソッドの辞書に追加されます。\n\nGoogle にアクセスできない場合は、cloud ピンインのソースを Baidu に変更します。\n\ncloud のクエリ結果は、デフォルトでは二次候補としてリストアップされますが、設定可能です。既に結果が存在する場合は、1件のみ表示されます。\n\n"
    },
    {
      "title": "ショートカットキー",
      "level": 3,
      "content": "よく使われるデフォルトのショートカットキーをいくつか紹介します。\n\n- Ctrl+Space - 入力メソッドをアクティブにします。\n- Left Shift - 一時的に英語に切り替わります。\n- Ctrl+Shift - 入力方式を切り替えます。\n- -/= - ページ送り/戻し\n- Shift+Space - 全角・半角切り替え\n\n"
    },
    {
      "title": "Vim",
      "level": 3,
      "content": "Vim で Fcitx をよく使う場合、vim-fcitxAUR プラグインをインストールするか、以下のコードを ~/.vimrc に追加してください。挿入モードを終了するときは Fcitx は自動的に閉じられ、そうでないときはその逆です。\n\n```\n\"##### auto fcitx  ###########\nlet g:input_toggle = 1\nfunction! Fcitx2en()\n   let s:input_status = system(\"fcitx-remote\")\n   if s:input_status == 2\n      let g:input_toggle = 1\n      let l:a = system(\"fcitx-remote -c\")\n   endif\nendfunction\n\nfunction! Fcitx2zh()\n   let s:input_status = system(\"fcitx-remote\")\n   if s:input_status != 2 && g:input_toggle == 1\n      let l:a = system(\"fcitx-remote -o\")\n      let g:input_toggle = 0\n   endif\nendfunction\n\nset ttimeoutlen=150\n\"Exit insert mode\nautocmd InsertLeave * call Fcitx2en()\n\"Enter insert mode\nautocmd InsertEnter * call Fcitx2zh()\n\"##### auto fcitx end ######\n```\n\n"
    },
    {
      "title": "クリップボード",
      "level": 3,
      "content": "Fcitx にはクリップボードが付属しています、ショートカットキーは Ctrl+; です。\n\n"
    },
    {
      "title": "特殊記号",
      "level": 3,
      "content": "~/.config/fcitx/data/pySym.mb を作成し、ファイルの内容は以下の通りです。\n\n```\n#The first line with \"#\" is a comment\n #Format: coding symbol\n #Code can only be lowercase letters, after pinyin analysis, the longest is 10 (such as py is 2, pinyin is also 2)\n #Mathematics symbols\n sxfh ＋\n sxfh －\n sxfh ＜\n sxfh ＝\n sxfh ＞\n sxfh ±\n sxfh ×\n sxfh ÷\n sxfh ∈\n sxfh ∏\n sxfh ∑\n sxfh ∕\n sxfh √\n sxfh ∝\n```\n\n対応する特殊記号と一致するコードを直接入力してください。\n\n"
    },
    {
      "title": "クリップボードアクセス",
      "level": 3,
      "content": "fcitx を使ってクリップボード (とクリップボード履歴) にある文章を入力することが可能です。デフォルトのトリガーキーは Control-; です。このトリガーキーはクリップボードのアドオンの設定ページにある他のオプションと同じように設定することが可能です。\n\n"
    },
    {
      "title": "fcitx-remote（リモート）",
      "level": 3,
      "content": "fcitx-remote は fcitx の状態を制御するために使用することができるコマンドラインツールです。fcitx パッケージと一緒にインストールされます。\n\nここで詳しく説明する価値のあるオプションは fcitx-remote -s imname で、これは imname で特定される入力メソッドに切り替わります。使用中の入力メソッドに対する正しい imname は、 fcitx-diagnose を実行し、 \"## インプットメソッド:\" セクションで確認することができます。\n\n"
    },
    {
      "title": "特殊文字入力",
      "level": 3,
      "content": "Fcitx5#特殊文字を入力 を参照してください。この内容は Fcitx にも適用されます。\n\n"
    },
    {
      "title": "トリガー入力方法の追加キー を無効化または変更する [sic]",
      "level": 3,
      "content": "この設定は Global Config タブにあり、デフォルトは SHIFT 左右 です。つまり、どちらかのシフトキーを押せばすぐに入力方法が変わるということです。本来はシフトキーを個別に押した場合にのみ適用されるはずですが、標準的なキーボード入力を使用しているときに大文字の入力やキーボードによるテキスト選択などがランダムに中断される傾向があります。\n\nまた、この設定は、いつでも警告なしにデフォルトに戻る可能性があります。fcitx の設定を変更できないようにするためには、fcitx の設定ファイルを ”不変\" にする必要があります。chattr +i ~/.config/fcitx/config (rootユーザで)\n\n"
    },
    {
      "title": "問題の診断",
      "level": 3,
      "content": "fcitx を使っていて問題が発生する場合、例えばどのアプリケーションでも Ctrl+Space が使えないときは、fcitx-diagnose を使ってまず問題を診断してみてください。fcitx-diagnose はよくある問題についての手がかりを提供してくれます。また、(IRC やフォーラムなどで) 他の人に相談するときはコマンドの出力を貼り付けると役に立つはずです。\n\n"
    },
    {
      "title": "Emacs",
      "level": 3,
      "content": "LC_CTYPE が英語の場合、emacs のバグによって emacs でインプットメソッドが使えなくなることがあります。emacs を起動する前に ja_JP.UTF-8 など LC_CTYPE を他の値に設定することで問題を回避できます。\n\n使用するロケールは有効である必要があります。/etc/locale.gen を編集して適当な行 (例: ja_JP.UTF-8) をアンコメントし、locale-gen を実行してください。\n\nデフォルトのフォントセットはベースフォントとして -*-*-*-r-normal--14-*-*-*-*-*-*-* を使います (src/xfns.c)。マッチするフォント (terminus や 75dpi など、xlsfonts の出力を見て下さい) がない場合、XIM は有効になりません。\n\n"
    },
    {
      "title": "Emacs デーモン",
      "level": 4,
      "content": "emacs デーモン/クライアントモードを使う場合、デーモンの起動時に LC_CTYPE を設定してください。例えば LC_CTYPE=ja_JP.UTF-8 emacs --daemon というコマンドを使って emacs デーモンを起動します。\n\nsystemd から emacs デーモンを起動している場合、ユニットファイルで以下のように Environment を設定してください:\n\n```\nEnvironment=\"LC_CTYPE=ja_JP.UTF-8\" \"XMODIFIERS=@im=fcitx\"\n```\n\nsystemd は .xprofile をロードしないため XMODIFIERS は明示的に設定する必要があります。emacs で initial-environment 変数をチェックして変数が両方とも正しく設定されていることを確認してください。\n\n"
    },
    {
      "title": "Ctrl+Space が GTK のプログラムで機能しない",
      "level": 3,
      "content": "ロケールを英語に設定しているとこの問題が発生することがあります。GTK_IM_MODULE が正しく設定されているか確認してください。\n\n参照: FAQ\n\n- _IM_MODULE 環境変数を設定していても fcitx が有効にできない場合は、適切なインプットメソッドモジュールをインストールしているか確認してください。\n\nプログラムによっては xim しか使わないため、そうしたプログラムを使っているときは、XMODIFIERS が正しく設定されているか確認してください。プログラムの例: gtk や qt を使わないプログラム全て (例: tk や motif、もしくは xlib を直接使っているプログラム), emacs, opera, openoffice, libreoffice, skype。\n\ngnome の gnome-terminal で fcitx が有効にできず、上の方法で効果がない場合は、以下のコマンドを試してみて下さい:\n\n```\n$ gsettings set org.gnome.settings-daemon.plugins.xsettings overrides \"{'Gtk/IMModule':<'fcitx'>}\"\n```\n\n"
    },
    {
      "title": "内蔵の Chinese Pinyin がデフォルトで有効にならない",
      "level": 3,
      "content": "ロケールが en_US.UTF-8 である場合、fcitx は内蔵の Chinese Pinyin インプットメソッドをデフォルトで有効にしません。fcitx-keyboard-us インプットメソッドだけが有効にされます。fcitx-diagnose コマンドを実行すると以下のように表示されます:\n\n```\n## Input Methods:\n       1.  Found 1 enabled input methods:\n               fcitx-keyboard-us\n       2.  Default input methods:\n           **You only have one input method enabled, please add a keyboard input method as the first one and your main input method as the second one.**\n```\n\nGUI の設定ツールで Pinyin や Shuangpin インプットメソッドを追加してインプットメソッドが有効にしてください。\n\n"
    },
    {
      "title": "fcitx と KDE",
      "level": 3,
      "content": "何らかの理由で、KDE がキーボードレイアウトを適切に扱えないことがあります。例えば、US (English) から LT (Lithuanian) に切り替えた場合、キーボードの数字キーは全てリトアニア文字になるはずですが、数字が出力されてしまいます。以下の手順で修正することが可能です:\n\n1. 上のセクションで書かれているパッケージをインストールしてください。\n1. バックグラウンドで fcitx を動かしている場合は終了してください。\n1. KDE に関連することを無効にします: System settings --> Input devices --> Layouts (tab) から \"Configure layouts\" のチェックを外して下さい。 System settings --> Input devices --> Advanced (tab) から \"Configure keyboard options\" のチェックを外して下さい。\n1. ターミナルを開いて fcitx と入力して fcitx を起動します。ターミナルは閉じてもかまいません。fcitx はバックグラウンドで動作し続けます。\n1. 必要なレイアウトを設定してください (システムトレイアイコンを右クリックして \"Configure\" をクリック)。\n1. システムトレイアイコンを右クリックして、\"Exit\" をクリック。\n\n1. System settings --> Input devices --> Layouts (tab) から \"Configure layouts\" のチェックを外して下さい。\n1. System settings --> Input devices --> Advanced (tab) から \"Configure keyboard options\" のチェックを外して下さい。\n\nこれでレイアウトがちゃんと使えるようになるはずです。KDE のレイアウト切り替えrアイコンが表示され、マウススクロールしたりアイコンをクリックすることでレイアウトを切り替えられます。\n\n"
    },
    {
      "title": "勝手にインプットメソッドが英語に切り替わってしまう",
      "level": 3,
      "content": "XMind でエンターを押してノードを作成したときなど、インプットメソッドが勝手に英語に切り替わってしまって、元のインプットメソッドに手動で戻さなくてはならないことがあります。\n\nこの問題を修正するには、fcitx の GUI 設定ツール (fcitx-configtool に含まれています) を開いて、\"Global Config\" タブの \"Share State Among Window\" ドロップダウンメニューから、\"PerProgram\" または \"All\" を選択してください。\n\n"
    },
    {
      "title": "GNOME/Wayland 上での Fcitx の利用",
      "level": 3,
      "content": "Wayland は ~/.xprofile に保管された環境変数を読み込むことができないため、Wayland 上で Fcitx を使うときは /etc/environment で環境変数を設定してください。\n\n"
    },
    {
      "title": "xmodmap の設定が上書きされる",
      "level": 3,
      "content": "Fcitx はキーボードレイアウトを制御するため、xmodmap の設定は上書きされてしまいます。4.2.7 から、Fcitx は ~/.Xmodmap のロードを行うようになります。\n\nxmodmap の変更を保存する方法については FAQ を参照してください。\n\n"
    },
    {
      "title": "HiDPI 環境では Fcitx の preedit box が小さすぎる",
      "level": 3,
      "content": "こちらを参照 HiDPI#Fcitx\n\n"
    },
    {
      "title": "参照",
      "level": 2,
      "content": "- Fcitx GitHub\n- Fcitx Wiki\n\n"
    }
  ]
}