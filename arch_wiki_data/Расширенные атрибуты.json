{
  "title": "Расширенные атрибуты",
  "url": "https://wiki.archlinux.org/title/%D0%A0%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5_%D0%B0%D1%82%D1%80%D0%B8%D0%B1%D1%83%D1%82%D1%8B",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Ссылки по теме\n\n- Разрешения и атрибуты файлов\n- Capabilities (Русский)\n\nРасширенные атрибуты (Extended attributes) — это пары ключ-значение, привязанные к файлу или каталогу. Существует четыре их класса: security, system, trusted и user.\n\nРасширенные атрибуты также используются для установки привилегий (Capabilities).\n\n"
    },
    {
      "title": "Пользовательские расширенные атрибуты",
      "level": 2,
      "content": "Класс user может использоваться для хранения произвольной информации о файле. Пример создания атрибута:\n\n```\n$ setfattr -n user.checksum -v \"3baf9ebce4c664ca8d9e5f6314fb47fb\" файл.txt\n```\n\nПросмотр имеющихся атрибутов:\n\n```\n$ getfattr -e text -d файл.txt\n```\n\n```\n# file: файл.txt\nuser.checksum=\"3baf9ebce4c664ca8d9e5f6314fb47fb\"\n```\n\nУдаление атрибута:\n\n```\n$ setfattr -x user.checksum файл.txt\n```\n\nДля поиска файлов с определёнными расширенными атрибутами используйте rawhideAUR:\n\n```\n$ rh /путь/к/каталогу '\"XATTR_REGEX\".reea'\n```\n\nНекоторые другие пользовательские расширенные атрибуты:\n\n- user.mime_type: помогает программам узнать MIME-тип.\n- user.charset: используется модулем mod_mime_xattr веб-сервера Apache.\n- user.creator: название приложения, в котором был создан файл.\n\nXDG также предлагает набор стандартизированных расширенных атрибутов для использования программами:\n\n- user.xdg.comment: поддерживается в Dolphin и других файловых менеджерах.\n- user.xdg.origin.url: ссылка, по которой был скачан файл.\n- user.xdg.robots.index: «true», если файл нужно индексировать, иначе «false».\n- user.xdg.robots.backup: «true», если для файла нужно создавать резервные копии, иначе «false».\n- user.xdg.language\n- user.xdg.creator\n- user.xdg.publisher\n- user.xdg.origin.email.subject\n- user.xdg.origin.email.from\n- user.xdg.origin.email.message-id\n\n"
    },
    {
      "title": "Сохранение расширенных атрибутов",
      "level": 2,
      "content": "Table content:\nКоманда | Сохраняет по умолчанию? / Требуемый флаг\ncp | --archive/--preserve=all/--preserve=xattr\nmv | Да1\ntar | --xattrs для создания и --xattrs-include='*' для извлечения\nbsdtar | -p для извлечения\nrsync | -X, --xattrs\ncpio | Нет\ngzip | Нет\npax | Нет\nsyncthing | при включении syncXattrs\n\n1. mv без предупреждения убирает расширенные атрибуты, если целевая файловая система их не поддерживает.\n\nЧтобы сохранить расширенные атрибуты в текстовых редакторах, настройте их на усечение (truncate) файлов при сохранении вместо использования rename(2).[1]\n\n"
    },
    {
      "title": "Файловые системы",
      "level": 3,
      "content": "Все основные файловые системы Linux, в том числе Ext4, Btrfs, ZFS и XFS, поддерживают расширенные атрибуты. Ядро позволяет иметь имена расширенных атрибутов размером до 255 байт и значения до 64 КиБ, однако Ext4 и Btrfs могут устанавливать меньшие ограничения, требуя, чтобы расширенные атрибуты умещались в «блок файловой системы».\n\nNTFS использует альтернативные потоки данных (Alternative Data Streams) для хранения пользовательских данных. По умолчанию должна использоваться опция монтирования user_xattr или streams_interface=xattr. Однако это может не поддерживаться, если используется streams_interface=windows. NTFS-3G поддерживает сопоставление альтернативных потоков данных с расширенными атрибутами в FUSE.\n\nNFS на данный момент не поддерживает расширенные атрибуты.\n\n"
    },
    {
      "title": "Программы",
      "level": 3,
      "content": "Table content:\nПриложение | Поддержка расширенных атрибутов | Примечания\nbaloo | user.xdg.tags user.baloo.rating | \ncaja | Да | Поддерживается расширениями caja-xattr-tags и caja.eiciel.\nChromium | Нет | Использовались для поддержки referrer и url, но были отключены из соображений приватности и безопасности. Смотрите также CVE-2018-20483.\nbraveAUR | Нет | \nCURL | user.xdg.origin.url user.xdg.referrer.url | Включется флагом --xattrs.\ndolphin | user.baloo.rating user.xdg.comment user.xdg.tags | [2]\nDropbox | user.com.dropbox.attributes | \nemacs-vm | Нет | Удаляет имеющиеся атрибуты у mbox.\nEpiphany | Нет | \nExiftool | Нет | \nfd | Нет | \nfindutils | Нет | \nFirefox | Нет | \ngallery-dlAUR | Нет | \nGwenview | user.xdg.tags | \nkfind | Нет | \nkonqueror | Нет | \nkio | [3] | \nNautilus | Нет | \nrecoll | user.xdg.tags | \ntagspacesAUR | Нет | \ntmsuAUR | Нет | \nThunar | Нет | \nyoutube-dlAUR, yt-dlp | user.xdg.referrer.url user.dublincore.title user.dublincore.date user.dublincore.description user.dublincore.contributor user.dublincore.format | Включается флагом --xattrs.\nWget | user.xdg.origin.url user.xdg.referrer.url | Включается флагом --xattrs.\nWebkit | Нет | \n\n```\nuser.xdg.tags\nuser.baloo.rating\n```\n\n```\nuser.xdg.origin.url\nuser.xdg.referrer.url\n```\n\n```\nuser.baloo.rating\nuser.xdg.comment\nuser.xdg.tags\n```\n\n```\nuser.xdg.referrer.url\nuser.dublincore.title\nuser.dublincore.date\nuser.dublincore.description\nuser.dublincore.contributor\nuser.dublincore.format\n```\n\n```\nuser.xdg.origin.url\nuser.xdg.referrer.url\n```\n\n"
    },
    {
      "title": "Другие системы тегов",
      "level": 2,
      "content": "Расширенные атрибуты могут оказаться недоступны из-за отсутствия поддержки со стороны файловой системы или программ. Поэтому многие медиаформаты позволяют хранить метаданные прямо внутри файла, и просмотреть их можно с помощью программ типа Exiftool или более специализированных, например id3AUR для аудио.\n\n- Для любых файлов: Exiftool\n- Для аудио: Audio tag editors\n- Для видео: ffprobe(1) из ffmpeg\n\n"
    },
    {
      "title": "gvfs",
      "level": 3,
      "content": "Другим решением, не зависящим от файловой системы, является gvfs — виртуальная файловая система Gnome, которая используется для хранения метаданных (gvfsd-metadata). Например, Firefox хранит метаданные таким образом, и их можно просмотреть с помощью команды:\n\n```\n$ gio info --attributes=metadata:: скачанный-файл.html\n```\n\nДругие программы, использующие этот подход:\n\n- Thunar: для сохранения цветов файлов.\n\n"
    },
    {
      "title": "Смотрите также",
      "level": 2,
      "content": "- XDG guidelines for extended attributes\n- wikipedia:Extended file attributes#Linux\n- Extended attributes: the good, the not so good, the bad.\n\n"
    }
  ]
}