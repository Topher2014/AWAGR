{
  "title": "OpenRC (Русский)",
  "url": "https://wiki.archlinux.org/title/OpenRC_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Ссылки по теме\n\n- eudev\n- init\n- SysVinit\n\nOpenRC - менеджер служб, поддерживаемый разработчиками Gentoo. Это система инициализации на основе зависимостей, которая работает вместе с программой инициализации SysVinit.\n\n"
    },
    {
      "title": "Установка",
      "level": 2,
      "content": "OpenRC и сопутствующие пакеты доступны в AUR. Для получения подробной информации о компонентах инициализации смотрите Init.\n\nУстановите пакет openrcAUR или openrc-gitAUR[ссылка недействительна: package not found]. С версии 0.25 OpenRC предоставляет собственный init (/usr/bin/openrc-init). В качестве альтернативы можно использовать busybox. Файлы сервисов содержатся в пакете openrc-arch-services-gitAUR.\n\nДля поддержки совместимости с initscripts-forkAUR, файлы настроек будут установлены в /etc/openrc/. Бинарный sysvinit init устанавливается в /usr/bin/openrc-init для совместимости с systemd-sysvcompat или подобных пакетов.\n\n"
    },
    {
      "title": "Загрузка",
      "level": 3,
      "content": "Для загрузки с OpenRC, добавьте init=/usr/bin/openrc-init в параметры ядра. Чтобы вернуться к systemd, удалите этот параметр ядра.\n\nКаталог /etc/openrc/conf.d, и файл /etc/openrc/rc.d используются для настройки.\n\n"
    },
    {
      "title": "Использование",
      "level": 2,
      "content": "В этом разделе проводится параллель между systemd и другими системами init.\n\nВы можете опустить расширения .service и .target, особенно при временном редактировании kernel parameters.\n\nTable content:\nsystemd | SysVinit | OpenRC | Description\nsystemctl list-units | rc.d list | rc-status | Список состояний запущенных служб.\nsystemctl --failed |  | rc-status --crashed | Проверка отказавших служб.\nsystemctl --all |  | rc-update -v show | Отображение всех доступных служб.\nsystemctl (start, stop, restart, status) daemon.service | rc.d (start, stop, restart) daemon | rc-service daemon (start, stop, restart, status) | Изменить состояние службы.\nsystemctl (enable, disable) daemon.service | chkconfig daemon (on, off) | rc-update (add, del) daemon | Включить или выключить службу.\nsystemctl daemon-reload | chkconfig daemon --add |  | Создание или изменение конфигурации.\n\n"
    },
    {
      "title": "Настройка",
      "level": 2,
      "content": "Для получения общей информации о настройке OpenRC смотрите:\n\n- руководство OpenRC (Англ.)\n- миграция на OpenRC (Англ.)\n- gentoo wiki.\n\n"
    },
    {
      "title": "Подготовка",
      "level": 3,
      "content": "Смотрите Init#Configuration.\n\n"
    },
    {
      "title": "Службы",
      "level": 3,
      "content": "Службы OpenRC включаются от имени суперпользователя (root) используя rc-update add имя службы runlevel. По крайней мере рекомендуется включить следующие службы:\n\nTable content:\nИмя службы | Runlevel | Описание\nudev | sysinit | Устройство горячего подключения\nalsa | default | ALSA state\nacpid | default | ACPI events\ndbus | default | Шина сообщений\ndcron | default | Планировщик\nsyslog-ng | default | Системные журналы (логи)\n\nСмотрите также Native services и демоны.\n\n"
    },
    {
      "title": "Сеть",
      "level": 3,
      "content": "Для общей информации по сети смотрите Network configuration.\n\nСеть настраивается с помощью newnet. [1] Измените файл /etc/openrc/conf.d/network; поддерживаются обе команды ip (iproute2) и ifconfig (net-tools). Ниже приведён пример с использованием ip.\n\n```\nip_eth0=\"192.168.1.2/24\"\ndefaultiproute=\"via 192.168.1.1\"\nifup_eth0=\"ip link set \\$int mtu 1500\"\n```\n\nСетевой сервис добавляется в загрузочный уровень по умолчанию, так что дальнейшие действия не требуются.\n\n"
    },
    {
      "title": "Логи загрузки",
      "level": 3,
      "content": "Чтобы включить ведение журнала загрузки, раскомментируйте строку rc_logger=\"YES\" в /etc/openrc/rc.conf. Когда он включен, журналы загрузки хранятся в /var/log/rc.log\n\n"
    },
    {
      "title": "Имя хоста (Hostname)",
      "level": 3,
      "content": "OpenRC устанавливает имя хоста из /etc/openrc/conf.d/hostname. Файл выглядит следующим образом:\n\n```\n# Set to the hostname of this machine\nhostname=\"myhostname\"\n```\n\n"
    },
    {
      "title": "Модули ядра",
      "level": 3,
      "content": "OpenRC использует /etc/openrc/conf.d/modules вместо /etc/modules-load.d. Например:\n\n```\n/etc/openrc/conf.d/modules\n```\n\n```\n# Вы должны ознакомится с настройками и документацией вашего ядра\n# для списка модулей и их параметров.\n\nmodules=\"vboxdrv acpi_cpufreq\"\n```\n\n"
    },
    {
      "title": "Локаль",
      "level": 3,
      "content": "Раскладка клавиатуры настраивается с помощью /etc/openrc/conf.d/keymaps и /etc/openrc/conf.d/consolefont. Вы также можете настроить параметры через файл /etc/locale.conf, который получается с помощью /etc/profile.d/locale.sh.\n\nСмотрите [2] и Locale для подробностей.\n\n"
    },
    {
      "title": "Тихая загрузка",
      "level": 3,
      "content": "Чтобы скрыть загрузочные сообщения из OpenRC, вы можете отредактировать /etc/inittab и добавить --quiet к каждой команде openrc. Дополнительную информацию можно найти в $ openrc -h.\n\n"
    },
    {
      "title": "Ошибка при размонтировании /tmp",
      "level": 3,
      "content": "При выключении системы, вы можете получить сообщение об ошибке, например:\n\n```\n* Unmounting /tmp ... \n* in use but fuser finds nothing [ !! ]\n```\n\nЭто можно исправить путем добавления\n\n```\nno_umounts=\"/tmp\"\n```\n\nв /etc/openrc/conf.d/localmount\n\n"
    },
    {
      "title": "Не работает отключение IPv6",
      "level": 3,
      "content": "Одним из вариантов является добавление:\n\n```\n# Disable ipv6\nnet.ipv6.conf.all.disable_ipv6 = 1\n```\n\nв файле с расширением .conf в /etc/openrc/sysctl.d\n\n"
    },
    {
      "title": "Во время выключения, и перемонтирования раздела root, происходят ошибки чтения",
      "level": 3,
      "content": "Если такое происходит, отредактируйте файл /etc/openrc/init.d/mount-ro и поместите:\n\n```\ntelinit u\n```\n\nпосле следующей строки:\n\n```\n# Flush all pending disk writes now\nsync; sync\n```\n\n"
    },
    {
      "title": "Не найден /etc/sysctl.conf",
      "level": 3,
      "content": "По умолчанию, sysctl --system вызывается для загрузки настройки sysctl. [3] Он содержит файл /etc/sysctl.conf, который удалён в Arch. [4]\n\nЧтобы предотвратить ошибку \"файл не найден\", создайте файл:\n\n```\n# touch /etc/sysctl.conf\n```\n\n"
    },
    {
      "title": "opentmpfiles-setup не удалось запустить",
      "level": 3,
      "content": "При загрузке openrc вы можете увидеть такие строки, как :\n\n```\n* Setting up tmpfiles.d entries ...\nchattr: Operation not supported while setting flags on /var/log/journal\nchattr: No such file or directory while trying to stat /var/log/journal/%m\nchattr: Operation not supported while setting flags on /var/log/journal/remote\n[ !! ]\nERROR: opentmpfiles-setup failed to start\n```\n\nЭто вызвано тем, что /usr/lib/tmpfiles.d/journal-nocow.conf использует опции, которые действительны только если журнал находится на файловой системе btrfs.\n\nПодробности см. на https://github.com/OpenRC/opentmpfiles/issues/2.\n\nОбходным решением является создание пустого /etc/tmpfiles.d/journal-nocow.conf для переопределения настроек.\n\n"
    },
    {
      "title": "Использование OpenRC с окружением рабочего стола (DE)",
      "level": 2,
      "content": "Если используется OpenRC с окружением рабочего стола, может помочь ConsoleKit. Установите сервис в /etc/openrc/init.d, и включите его:\n\n```\n# rc-update add consolekit default\n```\n\nДля большей информации смотрите ConsoleKit.\n\n"
    },
    {
      "title": "Возвращение к systemd",
      "level": 2,
      "content": "В большинстве случаев возврат к systemd не вызывает затруднений. По сути, это обратная процедура перехода на OpenRC, при этом следует обратить внимание на следующее:\n\n- Удаление или иное редактирование параметра init= в командной строке ядра.\n- Замена любых пакетов с поддержкой OpenRC или без нее на их эквиваленты (например, замена dbus-nosystemdAUR[ссылка недействительна: package not found] на dbus)\n\n"
    },
    {
      "title": "Смотрите также",
      "level": 2,
      "content": "- Реально ли установить и пользоваться Arch без systemd?\n- Wikipedia OpenRC\n- Gentoo wiki\n- OpenRC for Arch Linux - sourceforge repository\n- Forum thread about OpenRC in Arch\n- Blog: OpenRC on Arch Linux[устаревшая ссылка 2024-03-03 ⓘ]\n- Manjaro wiki\n\n"
    }
  ]
}