{
  "title": "BluRay (日本語)",
  "url": "https://wiki.archlinux.org/title/BluRay_(%E6%97%A5%E6%9C%AC%E8%AA%9E)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "関連記事\n\n- 光学ディスクドライブ\n\nこの記事では Linux ユーザーが合法的に購入した Blu-ray ディスクをコンピューター上で再生する方法を説明しています。Linux で利用可能な公式の Blu-ray プレイヤーのソフトウェアは存在しないため、Linux ユーザーはディスクのコンテンツを保護している DRM を扱えるオープンソースのライブラリを使う必要があります。これは相互運用性が許可している国では合法です。日本では著作権法の改正によって保護技術を回避しての複製は違法になっていますが、再生は問題ありません。\n\n"
    },
    {
      "title": "目次",
      "level": 2,
      "content": "- 1 仕組み 1.1 Blu-ray DRM 1.1.1 AACS 1.1.1.1 AACS の復号プロセス 1.1.2 BD+\n- 2 再生 2.1 準備 2.2 復号化プロセス 2.2.1 VUK による復号化 (ステップ 3.1 または 3.2.1) 2.2.2 PK と Host K/C による復号化 (ステップ 3.2.2) 2.2.3 BD+ のサポート 2.3 メディアプレーヤー 2.3.1 MPlayer 2.3.1.1 動画が遅れる 2.3.1.2 音声言語が間違っている 2.3.1.3 音声がズレる 2.3.2 VLC 2.3.3 xine 2.4 トラブルシューティング 2.4.1 KEYDB.cfg ファイルが存在しない 2.4.2 無効になった Host Key/Certificate 2.4.3 aacskeys を使う 2.4.3.1 aacskeys がキーを生成できない場合 2.4.4 正しい VUK を使っているのに Blu-ray が再生されない\n- 3 他の有用なソフトウェア\n\n- 1.1 Blu-ray DRM 1.1.1 AACS 1.1.1.1 AACS の復号プロセス 1.1.2 BD+\n\n- 1.1.1 AACS 1.1.1.1 AACS の復号プロセス\n- 1.1.2 BD+\n\n- 1.1.1.1 AACS の復号プロセス\n\n- 2.1 準備\n- 2.2 復号化プロセス 2.2.1 VUK による復号化 (ステップ 3.1 または 3.2.1) 2.2.2 PK と Host K/C による復号化 (ステップ 3.2.2) 2.2.3 BD+ のサポート\n- 2.3 メディアプレーヤー 2.3.1 MPlayer 2.3.1.1 動画が遅れる 2.3.1.2 音声言語が間違っている 2.3.1.3 音声がズレる 2.3.2 VLC 2.3.3 xine\n- 2.4 トラブルシューティング 2.4.1 KEYDB.cfg ファイルが存在しない 2.4.2 無効になった Host Key/Certificate 2.4.3 aacskeys を使う 2.4.3.1 aacskeys がキーを生成できない場合 2.4.4 正しい VUK を使っているのに Blu-ray が再生されない\n\n- 2.2.1 VUK による復号化 (ステップ 3.1 または 3.2.1)\n- 2.2.2 PK と Host K/C による復号化 (ステップ 3.2.2)\n- 2.2.3 BD+ のサポート\n\n- 2.3.1 MPlayer 2.3.1.1 動画が遅れる 2.3.1.2 音声言語が間違っている 2.3.1.3 音声がズレる\n- 2.3.2 VLC\n- 2.3.3 xine\n\n- 2.3.1.1 動画が遅れる\n- 2.3.1.2 音声言語が間違っている\n- 2.3.1.3 音声がズレる\n\n- 2.4.1 KEYDB.cfg ファイルが存在しない\n- 2.4.2 無効になった Host Key/Certificate\n- 2.4.3 aacskeys を使う 2.4.3.1 aacskeys がキーを生成できない場合\n- 2.4.4 正しい VUK を使っているのに Blu-ray が再生されない\n\n- 2.4.3.1 aacskeys がキーを生成できない場合\n\n"
    },
    {
      "title": "Blu-ray DRM",
      "level": 3,
      "content": "ユニークな暗号化キーが発見されて簡単に突破された DVD の CSS とは対照的に、Blu-ray はより強固な DRM 機構を使っており、それによって難易度が跳ね上がっています。まず、AACS 規格はディスクのコンテンツを保護するために非常に複雑な暗号プロセスを使用しているだけでなく、突破されたキーを無効にすることが可能になっており、新しい BR ディスクを使って新しいキーを配布できるようになっています。次に、Blu-ray はもうひとつの保護レイヤーである BD+ を使うことも可能です。市販のディスクのほとんどは AACS を使っていますが、中にはそれに加えて BD+ も利用しているものも少数ながら存在します。2007年に、AACS システムは解読され、復号キーがインターネットに出回りました。多くの復号化プログラムが利用可能になりましたが、Linux ユーザーにとって重要なのは（合法に購入した）ディスクをコンピューターで再生できるかということです。業界は最初にリークされた復号キーを無効にすることができましたが、イタチごっこのように新しいキーが定期的に公開されています。\n\n"
    },
    {
      "title": "AACS",
      "level": 4,
      "content": "AACS の仕様と復号プロセスは [1] で公開されています。さらに詳細な説明が多数の記事や研究論文でなされています: [2], [3], [4]。 libaacs は VideoLAN 開発チームによる Advanced Access Content System の仕様を実装するという研究プロジェクトです。オープンソースのライブラリとして配布されています [5]。このプロジェクトでは著作権保護で暗号化されたデータをデコードするのに使うキーや証明書を提供していません。しかしながら、キーのデータベースファイルと組み合わせることで、AACS 規格を使っている Blu-ray ディスクを再生するのに使用することが可能です。このファイルは KEYDB.cfg と呼ばれており、libaccs は ~/.config/aacs からアクセスします。このファイルのフォーマットは [6] から確認できます。\n\nライセンスを受けたプレイヤーによる保護ディスクの AACS 復号化プロセスは4段階に分けて行われています:\n\n1. ソフトウェアや組み込みプレイヤーの Device Key と、ディスクの Media Key Block (MKB) データを使って \"Processing Key\" を取得します。さらに (MKB の他のデータと合わせて) それによって Media Key を計算します。\n1. この Media Key と、ドライブの有効な Host Certificate を持つプレイヤーによって取得されたディスクの Volume ID (VID) を使って、Volume Unique Key (VUK) を計算します。\n1. 計算された VUK を使ってディスクの暗号化された Title Key を解読します。\n1. 最後にこの Title Key がディスクの保護されたメディアコンテンツを解読します。\n\nMKB を含んでいるのはディスクだということに注意してください。MKB は最初の Blu-ray が2006年に市販開始された時から更新が行われています。最新の MKB はバージョン 64 ですが、実際はほとんどの MKB は同じキーを共有しています。ソフトウェアプレイヤーは Host Key/Certificate を提供する一方、ドライブは無効にされた Host Key/Certificate のリストを所持しています。(バージョンが新しい MKB を含んだ) 新しいディスクが復号化・再生されたとき、あるいは復号化・再生が試みられたときに Host Key と Certificate の無効化が発生します (ディスクをドライブに入れただけではアップデートは起こりません)。そうなると、ドライブは古い Host Key/Certificate を永遠に使えなくなります。\n\nlibaacs を使うことで、復号化プロセスの最後の手順に進み、メディアプレイヤーがディスクを再生できるようになるまでの段階をいくつかスキップすることができます。これは KEYDB.cfg ファイルで以下のどちらか（もしくは両方）を用意することで可能です:\n\n- (ディスクの MKB バージョンに対応している) 有効な Processing Key と有効な (ドライブによって無効にならない) Host Key/Certificate\n- 特定のディスクの有効な VUK\n\nディスクの MKB バージョンに対応した有効な Processing Key と有効な Host Key/Certificate を libaacs が見つけると、手順2から復号化プロセスが開始されます。ただし、Host Key/Certificate は新しい Blu-ray ディスクによって定期的に無効にされます。一度無効になると、ドライブは新旧両方のディスクが読み込めなくなります。基本的にこれを元に戻すことは不可能で、新しい最新の Host Key/Certificate を用意するしか直す方法はありません (Windows ユーザーの場合、ソフトウェアプレイヤーのアップデートでこれが行われています)。この方法の利点は、Host Key/Certificate が無効にされるまで、Processing Key が判明している MKB バージョンをディスクが使っている限り、libaacs は全てのディスクの VUK を計算することができるということです。現在、MKB バージョン 61 までの Processing Key が計算済みでインターネットから取得できるようになっています。\n\nありがたいことに、有効な Processing Key がなかったり Host Certificate が無効になっているような場合、libaacs にはディスクを復号する代わりの方法があります: KEYDB.cfg ファイルに有効な VUK を準備することです。これによって libaacs は手順3まで直接飛ぶことができます。Processing Key とは対照的に、VUK はディスクによって異なります。そのためユーザーはサードパーティから VUK を取得する必要があるので、あまり効率的ではありません。しかしながら VUK は無効にされることがないという点では大きく有利です。libaacs は (有効な Host Key/Certificate を使って) 手順2が実行できる場合、手順3で計算した VUK を ~/.cache/aacs/vuk に保存します。同じディスクを二度目に見る時は、libaacs は保存された VUK を再利用できます。そのため作成された VUK はバックアップしておくと良いでしょう。\n\n[7] や [8] など、様々な場所から VUK を収集する試みがありました。最近では [9] に VUK データベースが存在し 24,000 近くの VUK が公開されていましたが、既に利用できなくなっています。データベースのミラーが [10] など Doom9 のフォーラムに記載されています。\n\n"
    },
    {
      "title": "BD+",
      "level": 4,
      "content": "BD+ は Blu-ray DRM の任意の補助コンポーネントです。2013年12月、VideoLAN は BD+ 復号化の実験的なサポートを提供する待望の libbdplusAUR をリリースしました。ライブラリには BD+ の復号化に必要なキーや証明書が含まれていないので、別個に入手してインストールする必要があります。\n\n"
    },
    {
      "title": "準備",
      "level": 3,
      "content": "1. libbluray と libaacs パッケージをインストールしてください。\n1. [11] から KEYDB.cfg ファイルをダウンロードして ~/.config/aacs ディレクトリにコピーしてください。ファイルには PK, HC, VUK データが含まれており、以下で説明している復号化プロセスで必要になります。\n1. 必要であれば (ボリュームがシステムに自動的にマウントされない場合)、ディスクをディレクトリにマウントしてください。例: # mount /dev/sr0 /media/blurays\n\n```\n# mount /dev/sr0 /media/blurays\n```\n\n"
    },
    {
      "title": "復号化プロセス",
      "level": 3,
      "content": "VLC など Blu-ray に対応しているソフトウェアプレイヤーを起動して、ディスクを再生してください (VLC ではメディア -> ディスクを開くから、ディスクタブで Blu-ray を選択します。「ディスクメニューなし」にはチェックを入れてください)。ソフトウェアプレイヤーは以下のような復号化プロセスを辿ります:\n\n1. ユーザーが libbluray と libaacs をサポートしているビデオプレイヤーで Blu-ray の再生を始めます。\n1. BR ディスクが AACS で暗号化されていない場合、4.1 に進みます。\n1. BR ディスクが AACS で暗号化されている場合、libaacs は以下を実行します: ディスクの有効な VUK が ~/.cache/aacs/vuk/ に存在するか確認します。存在する場合、4.1 に進みます。存在しない場合、次のステップに進みます。 ~/.config/aacs/KEYDB.cfg を読み込みます: 有効な VUK が存在する場合、4.1 に進みます。存在しない場合、次のステップに進みます。 (ディスクの MKB バージョンに対応している) 有効な Processing Key と有効な Host Key/Certificate が存在する場合、libaacs は VUK を計算します。今後の使用のために VUK は ~/.cache/aacs/vuk に保存されます。その後ステップ 4.1 に進みます。有効な PK/HKC が存在しない場合、ステップ 4.2 に進みます。\n1. 結果 ソフトウェアプレイヤーはディスクのコンテンツを再生することができます。 ソフトウェアプレイヤーはディスクのコンテンツを読み込むことができません。\n\n1. ディスクの有効な VUK が ~/.cache/aacs/vuk/ に存在するか確認します。存在する場合、4.1 に進みます。存在しない場合、次のステップに進みます。\n1. ~/.config/aacs/KEYDB.cfg を読み込みます: 有効な VUK が存在する場合、4.1 に進みます。存在しない場合、次のステップに進みます。 (ディスクの MKB バージョンに対応している) 有効な Processing Key と有効な Host Key/Certificate が存在する場合、libaacs は VUK を計算します。今後の使用のために VUK は ~/.cache/aacs/vuk に保存されます。その後ステップ 4.1 に進みます。有効な PK/HKC が存在しない場合、ステップ 4.2 に進みます。\n\n1. 有効な VUK が存在する場合、4.1 に進みます。存在しない場合、次のステップに進みます。\n1. (ディスクの MKB バージョンに対応している) 有効な Processing Key と有効な Host Key/Certificate が存在する場合、libaacs は VUK を計算します。今後の使用のために VUK は ~/.cache/aacs/vuk に保存されます。その後ステップ 4.1 に進みます。有効な PK/HKC が存在しない場合、ステップ 4.2 に進みます。\n\n1. ソフトウェアプレイヤーはディスクのコンテンツを再生することができます。\n1. ソフトウェアプレイヤーはディスクのコンテンツを読み込むことができません。\n\n"
    },
    {
      "title": "VUK による復号化 (ステップ 3.1 または 3.2.1)",
      "level": 4,
      "content": "ディスク固有の VUK を使用する方法はいつでも機能し、無効化されることはありません。Blu-ray ディスクの直近の復号化キーだからです。ただし、VUK はディスク毎に異なるため、VUK リストやデータベースに依存します。VUK は以下のどちらかの方法で入手できます:\n\n- PK と Host K/C による復号化が上手くいくと、ディスクの VUK が ~/.cache/aacs/vuk に保存されます。\n- 第三者からディスクの VUK を取得する (KEYDB.cfg に指定します)。\n\nたとえディスクの MKB バージョンによって PK と Host Key/Certificate が無効化されても VUK があればディスクを読み込むことができます。VUK が存在しない場合、ソフトウェアプレイヤーは以下の方法を使って復号化を行います。\n\n"
    },
    {
      "title": "PK と Host K/C による復号化 (ステップ 3.2.2)",
      "level": 4,
      "content": "(特定の MBK バージョンまでの) あらゆるディスクを復号化して再生に必要な VUK を計算できる方法です。VUK が判明すると、次の利用のために保存されます。\n\nこの方法では KEYDB.cfg ファイルの最初にある Processing Key と Host Key/Certificate を使用します。現在、MKB v61 までのディスクを再生できますが、MKB v62 以上のディスクを再生しようとするとドライブによって KEYDB.cfg ファイル内の Host Key/Certificate が無効化されて再生できなくなります。\n\nディスクの再生が上手くいった場合、libaacs は VUK を ~/.cache/aacs/vuk に保存します。ファイル名はディスク ID になります。VLC は KEYDB.cfg ファイルが使えなくなっても場合、フォルダ内の VUK を再利用するため、将来のためにバックアップすることを推奨します。\n\n"
    },
    {
      "title": "BD+ のサポート",
      "level": 4,
      "content": "libbdplusAUR は BD+ の復号化を実験的にサポートしていますが、上手く行かない場合は makemkvAUR や DVDFab などの商用アプリケーションを使う必要があります。\n\nBD+ は基本的に動画ストリームにエラーデータを追加することで暗号化を施します。暗号化された状態でも全く視聴できなくなるわけではありませんが、動画に乱れがずっと発生するので見れたものではありません。公式プレイヤーはインターネットからダウンロードしたテーブルを使って、壊れた動画ストリームを正しい動画ストリームに変換します。libbdplus はかなり前から機能しなくなっており、オープンソースのアプリケーションで BD+ で保護されたディスクを再生する方法は現在存在しません。\n\n"
    },
    {
      "title": "メディアプレーヤー",
      "level": 3,
      "content": "以下のメディアプレーヤーは libbluray や libaacs を使って AACS で暗号化された Blu-ray ディスクを再生できます。\n\n"
    },
    {
      "title": "MPlayer",
      "level": 4,
      "content": "MPlayer で Blu-ray を再生する基本の再生コマンドは:\n\n```\n$ mplayer br:///</bluray/mount/dir>\n```\n\nもしくは:\n\n```\n$ mplayer br://<title number> -bluray-device </bluray/mount/dir>\n```\n\nおそらく Blu-ray をスムーズに再生するためにハードウェアアクセラレーションやマルチコアの CPU サポートを有効にする必要があります。\n\nnvidia のカードを使っている場合、libvdpau をインストールして mplayer で --hwdec=auto オプションを使ってハードウェアアクセラレーションを有効にしてください。例:\n\n```\n$ mplayer --hwdec=auto br:///</bluray/mount/dir>\n```\n\nマルチコアの CPU サポートを有効にするには --vd-lavc-threads=N オプションを使って下さい。N はコアの数に置き換えて下さい。例:\n\n```\n$ mplayer --vd-lavc-threads=4 br:///</bluray/mount/dir>\n```\n\n詳しくはハードウェアビデオアクセラレーションを見てください。\n\n# キーを使って再生言語を切り替えることができます。\n\nmplayer の最初の出力から、その Blu-ray に使用されているコーデックを探す必要があります。\"Selected video codec\" という行の最後にあります。\n\nH.264 ディスクなら -vc ffh264vdpau オプションを使って下さい。例:\n\n```\n$ mplayer -vc ffh264vdpau br:///</bluray/mount/dir>\n```\n\nVC-1 ディスクなら -vc ffvc1vdpau を使って下さい。例:\n\n```\n$ mplayer -vc ffvc1vdpau br:///</bluray/mount/dir>\n```\n\nMPEG ディスクなら -vc ffmpeg12vdpau を使って下さい。例:\n\n```\n$ mplayer -vc ffmpeg12vdpau br:///</bluray/mount/dir>\n```\n\n"
    },
    {
      "title": "VLC",
      "level": 4,
      "content": "バージョン 2.0.0 から、VLC は Blu-ray の再生を実験的にサポートしています。Blu-ray のメニューはまだ使えません (ただし、開発は行われています。libbluray の代わりに libbluray-gitAUR を使ってみてください)。\n\n次のコマンドで再生を開始します:\n\n```\n$ vlc bluray://</bluray/mount/dir>\n```\n\n"
    },
    {
      "title": "xine",
      "level": 4,
      "content": "次のコマンドで再生を開始します:\n\n```\n$ xine bluray://</bluray/mount/dir>\n```\n\n"
    },
    {
      "title": "KEYDB.cfg ファイルが存在しない",
      "level": 4,
      "content": "有効な VUK が ~/.cache/aacs/vuk に存在する場合、libaacs はコンテンツを復号するのに KEYDB.cfg を使う必要はありません。しかしながら、~/.config/aacs/ の KEYDB.cfg ファイルは必要です（ファイルが空であったとしても）。\n\n"
    },
    {
      "title": "無効になった Host Key/Certificate",
      "level": 4,
      "content": "残念ながら、新しい Blu-ray ディスクを再生しようとするとドライブによって Host Key/Certificate (ライセンスを受けたソフトウェアプレイヤーのキー) が無効になることがあります。無効化されると、aacskeysAUR は次のメッセージを返します:\n\n```\nThe given Host Certficate / Private Key has been revoked by your drive.\n```\n\nこれは AACS の保護機構に含まれていることです: インターネットにリークされた古いソフトウェアプレイヤーの Host Key は無効にすることができ、新しい市販のディスクのリリースによってリストが配布されます。これは不可逆の措置で、ドライブのフラッシュメモリを書き換えても戻すことはできません。修正する方法はたった2つしか存在しません:\n\n- KEYDB.cfg の Host Key/Certificate を（まだ）無効になっていないキーに更新する。\n- 上述のとおり各ディスクの VUK を KEYDB.cfg に追加する。VUK が無効にされることはありません。\n\n(mplayer や vlc を使って) ディスクの復号化が成功した場合、libaacs は ~/.cache/aacs/vuk に VUK を保存します。後になって KEYDB.cfg の Host Key/Certificate が無効になっても、VLC は保存された VUK を使うことができます。そのため今後のために ~/.cache/aacs ディレクトリはバックアップすることを推奨します。\n\n"
    },
    {
      "title": "aacskeys を使う",
      "level": 4,
      "content": "aacskeysAUR をインストールしてください。有効な Host Key/Certificate と Processing Key が含まれているディレクトリに移動してから aacskeysAUR を実行してください:\n\n```\n$ aacskeys </bluray/mount/dir>\n```\n\n例:\n\n```\n$ cd /usr/share/aacskeys && aacskeys /media/blurays\n```\n\n必要ならば、BR をキーデータベースに追加することができます: ~/.config/aacs/KEYDB.cfg を編集して以下の形式で aacskeys による情報出力を追加してください:\n\n```\n0x<unit key file hash> = Film Title    | V | 0x<volume unique key>\n```\n\nwine を使って DumpVID で VolumeID を生成してみて下さい。現在 VolumeID を使うことで aacskeys の VolumeID オプションによって bluray キーを生成できるようになっています。\n\n```\nUsage: aacskeys [options] <mountpath> [volume id / binding nonce]\n```\n\n"
    },
    {
      "title": "正しい VUK を使っているのに Blu-ray が再生されない",
      "level": 4,
      "content": "一部の Blu-ray ドライブは sg モジュールのロードを必要とします:\n\n```\n# modprobe sg\n```\n\n"
    },
    {
      "title": "他の有用なソフトウェア",
      "level": 2,
      "content": "DVD では、libdvdcss パッケージが必要な復号化ライブラリを提供します。以下は Blu-ray/HD-DVD の復号に使えるソフトウェアです:\n\n- aacskeysAUR - オープンソース\n- makemkvAUR - クローズドソース/無料制限ベータ\n\n- vukextract - プロプライエタリの DVDFab を使って VUK を抽出するオープンソースソフトウェア。\n- anydvdhd - 市販ソフトウェア、VM 上の Microsoft OS で動かす必要があります。\n- DVDFab HD Decrypter - Windows 用の商用ソフトウェア。Wine で動作します。\n\n"
    }
  ]
}