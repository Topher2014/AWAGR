{
  "title": "BIND (Español)",
  "url": "https://wiki.archlinux.org/title/BIND_(Espa%C3%B1ol)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Note: **2017-01-24** \n\nArtículos relacionados\n\n- DNSCrypt\n- dnsmasq\n- Pdnsd\n- Unbound\n- PowerDNS\n\nBIND (Berkeley Internet Name Daemon) es la implementación de referencia del protocolo DNS (Domain Name System).\n\n"
    },
    {
      "title": "Instalación",
      "level": 2,
      "content": "Los siguientes pasos indican cómo instalar una configuración básica de BIND como servidor local DNS de solo caché.\n\nInstale el paquete bind desde los repositorios oficiales.\n\nOpcionalmente, edite /etc/named.conf, y añada la siguiente línea en la sección de opciones (options), para permitir únicamente conexiones de localhost:\n\n```\nlisten-on { 127.0.0.1; };\n```\n\nEdite resolv.conf para usar el servidor local DNS, 127.0.0.1.\n\nInicie named.service con systemd.\n\n"
    },
    {
      "title": "Redireccionamiento",
      "level": 2,
      "content": "Cuando BIND actúa como un servidor de redireccionamiento DNS, almacena por una parte memoria caché de las búsquedas DNS ya realizadas, y por otra redirigirá las peticiones DNS no guardadas en caché a otros servidores DNS que se hayan definido, como podría ser el servidor DNS de nuestro ISP u otros servicios DNS globales como OpenNIC.\n\nPara configurar el redireccionamiento DNS, basta con añadir las siguientes líneas a /etc/named.conf en la secciones de opciones globales (options) o en una sección de zona específica, y cambiar la dirección IP de acuerdo con la del servidor DNS que deseamos emplear.\n\n```\noptions {\n listen-on { 192.168.66.1; };\n forwarders { 8.8.8.8; 8.8.4.4; };\n};\n```\n\nTras realizar este cambio, es necesario reiniciar named.service.\n\n"
    },
    {
      "title": "Plantilla de configuración para ejecutar un dominio",
      "level": 2,
      "content": "Este es un sencillo tutorial para configurar una servidor DNS en una red doméstica con bind. Usaremos \"domain.tld\" como nuestro dominio.\n\nPara ver ejemplo más elaborados, consúltese Two-in-one DNS server with BIND9.\n\n"
    },
    {
      "title": "1. Crear un archivo de zona",
      "level": 3,
      "content": "```\n# nano /var/named/domain.tld.zone\n```\n\n```\n$TTL 7200\n; domain.tld\n@       IN      SOA     ns01.domain.tld. postmaster.domain.tld. (\n                                        2007011601 ; Serial\n                                        28800      ; Refresh\n                                        1800       ; Retry\n                                        604800     ; Expire - 1 week\n                                        86400 )    ; Minimum\n                IN      NS      ns01\n                IN      NS      ns02\nns01            IN      A       0.0.0.0\nns02            IN      A       0.0.0.0\nlocalhost       IN      A       127.0.0.1\n@               IN      MX 10   mail\nimap            IN      CNAME   mail\nsmtp            IN      CNAME   mail\n@               IN      A       0.0.0.0\nwww             IN      A       0.0.0.0\nmail            IN      A       0.0.0.0\n@               IN      TXT     \"v=spf1 mx\"\n```\n\n$TTL define el tiempo de vida en segundos por defecto para todos los registros de todos los tipos. En este ejemplo es de 2 horas.\n\nEl número de serie (Serial) debe incrementarse manualmente antes de reiniciar named cada vez que se cambie un registro en la zona. De lo contrario los servidores esclavos no retransmitirán la zona, ya que para ello requieren un número serie mayor que el de la última versión de la zona que transfirieron.\n\n"
    },
    {
      "title": "2. Configurar un servidor maestro",
      "level": 3,
      "content": "Añade tu zona a /etc/named.conf:\n\n```\nzone \"domain.tld\" IN {\n        type master;\n        file \"domain.tld.zone\";\n        allow-update { none; };\n        notify no;\n};\n```\n\nInicie named.service.\n\nAlternativamente, recargue los archivos de configuración. Esta última opción mantendrá el servidor disponible mientras se ejecuta el cambio.\n\n"
    },
    {
      "title": "3. Configurarlo como el servidor DNS por defecto",
      "level": 3,
      "content": "Si estamos ejecutando nuestro propio servidor DNS, podríamos querer usarlo no solo para redirigir peticiones DNS, sino para realizar todas las búsquedas DNS. Esto requiere la capacidad de hacer búsquedas recursivas. Para prevenir ataques de amplificación de DNS (DNS Amplification Attacks), la búsqueda recursiva está desactivada por defecto en la mayor parte de las configuraciones. El fichero Arch /etc/named.conf por defecto solo permite habilitar la recursión en la interfaz de circuito cerrado (loopback) del sistema.\n\n```\nallow-recursion { 127.0.0.1; };\n```\n\nPor lo tanto, para permitir búsquedas DNS para nuestro equipo, el fichero resolv.conf debe incluir 127.0.0.1 como servidor de nombres. Consulte Conservar las configuraciones de DNS para prevenir que este fichero sea reescrito.\n\nPara proveer un servicio de nombres a nuestra red local, por ejemplo 192.168.0, debemos añadir el rango apropiado de direcciones IP a /etc/named.conf:\n\n```\nallow-recursion { 192.168.0.0/24; 127.0.0.1; };\n```\n\n"
    },
    {
      "title": "Configurar BIND para servir zonas firmadas con DNSSEC",
      "level": 2,
      "content": "Note: **This article or section needs expansion.** This article or section needs expansion.\n\nThis article or section needs expansion.\n\n- https://www.dnssec.net/practical-documents https://www.cymru.com/Documents/secure-bind-template.html[enlace roto 2024-12-14] (plantilla de configuración) https://www.bind9.net/manuals[enlace roto 2021-11-07] https://www.bind9.net/BIND-FAQ[enlace roto 2021-11-07]\n- http://blog.techscrawl.com/2009/01/13/enabling-dnssec-on-bind/[enlace roto 2024-07-30]\n- O use un mecanismo externo tal como OpenDNSSEC (cambio de clave completamente automático)\n\n- https://www.cymru.com/Documents/secure-bind-template.html[enlace roto 2024-12-14] (plantilla de configuración)\n- https://www.bind9.net/manuals[enlace roto 2021-11-07]\n- https://www.bind9.net/BIND-FAQ[enlace roto 2021-11-07]\n\n"
    },
    {
      "title": "Escuchar automáticamente nuevas interfaces",
      "level": 2,
      "content": "Por defecto, bind hace un escaneo en búsqueda de nuevas interfaces cada hora, y deja de escuchar aquellas que dejan de existir. Este comportamiento se puede modificar añadiendo el parámetro:\n\n```\ninterface-interval <rescan-timeout-in-minutes>;\n```\n\nen la sección de opciones de named.conf, con un valor máximo de 28 días (40320 min). También se puede desactivar esta caraterística con el valor 0.\n\nA continuación, reniciamos el servicio.\n\n"
    },
    {
      "title": "Ejecutar BIND en un entorno chroot",
      "level": 2,
      "content": "Ejecutar en un entorno chroot mejora la seguridad del servidor DNS.\n\n"
    },
    {
      "title": "Crear un sistema de archivos para la jaula chroot",
      "level": 3,
      "content": "En primer lugar, debemos crear un lugar donde contener la jaula chroot, como el directorio /srv/named por ejemplo, y disponer todos los archivos necesarios para el funcionamiento de BIND en el mismo.\n\n```\nmkdir -p /srv/named/{dev,etc,usr/lib/engines,var/{run,log,named}}\n # Copy over required system files\n cp -av /etc/{localtime,named.conf} /srv/named/etc/\n cp -av /usr/lib/engines/* /srv/named/usr/lib/engines/\n cp -av /var/named/* /srv/named/var/named/.\n # Set up required dev nodes\n mknod /srv/named/dev/null c 1 3\n mknod /srv/named/dev/random c 1 8\n # Set Ownership of the files\n chown -R named:named /srv/named\n```\n\nEstas operaciones deberían crear el sistema de archivos necesario para la jaula chroot.\n\n"
    },
    {
      "title": "Archivo de servicio",
      "level": 3,
      "content": "A continuación, debemos crear un nuevo archivo de servicio que fuerce bind a ejecutarse dentro de chroot.\n\n```\ncp -av /usr/lib/systemd/system/named.service /etc/systemd/system/named-chroot.service\n```\n\neditando cómo el servicio llama a bind.\n\n```\n/etc/systemd/system/named-chroot.service\n```\n\n```\nExecStart=/usr/bin/named -4 -f -u named -t \"/srv/named\"\n```\n\nAhora, reload systemd systemctl daemon-reload. Entonces inicie named-chroot.service\n\n"
    },
    {
      "title": "Véase también",
      "level": 2,
      "content": "- BIND 9 DNS Administration Reference Book\n- DNS and BIND by Cricket Liu and Paul Albitz\n- Pro DNS and BIND\n- Internet Systems Consortium, Inc. (ISC)\n- DNS Glossary[enlace roto 2021-11-07]\n- Archived mailing list discussion on BIND's future\n\n"
    }
  ]
}