{
  "title": "Reflector (Português)",
  "url": "https://wiki.archlinux.org/title/Reflector_(Portugu%C3%AAs)",
  "sections": [
    {
      "title": "Introduction",
      "level": 1,
      "content": "Artigos relacionados\n\n- Espelhos\n- Pacman\n\nReflector é um script que pode recuperar a lista de espelhos mais recente da página MirrorStatus, filtrar os espelhos mais atualizados, classificá-los por velocidade e substituir o arquivo /etc/pacman.d/mirrorlist.\n\n"
    },
    {
      "title": "Instalação",
      "level": 2,
      "content": "Instale o pacote reflector.\n\n"
    },
    {
      "title": "Uso",
      "level": 2,
      "content": "- Nos exemplos a seguir, /etc/pacman.d/mirrorlist vai ser sobrescrito. Faça um backup antes de proceder.\n- Certifique-se de que o /etc/pacman.d/mirrorlist resultante não contenha entradas que você considere não confiáveis antes de sincronizar ou atualizar com pacman.\n\nPara ver todos os comandos disponíveis, execute o seguinte comando:\n\n```\n# reflector --help\n```\n\n"
    },
    {
      "title": "Exemplos",
      "level": 3,
      "content": "Classifica e ordena de forma detalhada os cinco espelhos sincronizados mais recentemente pela velocidade do download e sobrescreve o arquivo /etc/pacman.d/mirrorlist:\n\n```\n# reflector --verbose --latest 5 --sort rate --save /etc/pacman.d/mirrorlist\n```\n\nSeleciona os 200 espelhos HTTP ou HTTPS sincronizado mais recentemente, ordena-os pela velocidade de download e sobrescreve o arquivo /etc/pacman.d/mirrorlist:\n\n```\n# reflector --latest 200 --protocol http --protocol https --sort rate --save /etc/pacman.d/mirrorlist\n```\n\nSeleciona os espelhos HTTPS sincronizados dentro das últimas 12 horas e localizados na França ou Alemanha, ordena-os pela velocidade de download e sobrescreve o arquivo /etc/pacman.d/mirrorlist:\n\n```\n# reflector --country France --country Germany --age 12 --protocol https --sort rate --save /etc/pacman.d/mirrorlist\n```\n\n"
    },
    {
      "title": "Hook do pacman",
      "level": 3,
      "content": "Você pode criar um hook do pacman que executará reflector e removerá o arquivo .pacnew criado toda vez que pacman-mirrorlist recebe uma atualização.\n\n```\n/etc/pacman.d/hooks/mirrorupgrade.hook\n```\n\n```\n[Trigger]\nOperation = Upgrade\nType = Package\nTarget = pacman-mirrorlist\n\n[Action]\nDescription = Updating pacman-mirrorlist with reflector and removing pacnew...\nWhen = PostTransaction\nDepends = reflector\nExec = /bin/sh -c \"reflector --country 'United States' --latest 200 --age 24 --sort rate --save /etc/pacman.d/mirrorlist; rm -f /etc/pacman.d/mirrorlist.pacnew\"\n```\n\nCertifique-se de substituir nos argumentos desejados para o refletor.\n\n"
    },
    {
      "title": "Serviço de systemd",
      "level": 3,
      "content": "Este é um exemplo de uma unit de serviço que espera que a rede esteja ativa e online antes de executar o refletor:\n\n```\n/etc/systemd/system/reflector.service\n```\n\n```\n[Unit]\nDescription=Pacman mirrorlist update\nWants=network-online.target\nAfter=network-online.target nss-lookup.target\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/reflector --protocol https --latest 30 --number 20 --sort rate --save /etc/pacman.d/mirrorlist\n\n[Install]\nWantedBy=multi-user.target\n```\n\nAo iniciar reflector.service, a lista de espelhos será atualizada. Para atualizar a lista de espelhos sempre que o computador inicializar, habilite o serviço.\n\n"
    },
    {
      "title": "Timer de systemd",
      "level": 3,
      "content": "Se você deseja executar reflector.service semanalmente, crie um timer associado. Por exemplo:\n\n```\n/etc/systemd/system/reflector.timer\n```\n\n```\n[Unit]\nDescription=Run reflector weekly\n\n[Timer]\nOnCalendar=Mon *-*-* 7:00:00\nRandomizedDelaySec=15h\nPersistent=true\n\n[Install]\nWantedBy=timers.target\n```\n\nE basta iniciar o reflector.timer.\n\n"
    },
    {
      "title": "Pacote reflector-timer",
      "level": 3,
      "content": "Instale reflector-timerAUR[link quebrado: package not found] para executar o reflector semanalmente.\n\nA configuração padrão, que pode ser editada para atender necessidades específicas de cada um, é:\n\n```\n/usr/share/reflector-timer/reflector.conf\n```\n\n```\nAGE=6\nCOUNTRY=Germany\nLATEST=30\nNUMBER=20\nSORT=rate\n### remova uma entrada, se você não deseja-o como um protocolo disponível\nPROTOCOL1='-p http'\nPROTOCOL2='-p https'\nPROTOCOL3='-p ftp'\n```\n\nCertifique-se de habilitar o reflector.timer.\n\n"
    },
    {
      "title": "Tarefa do cron",
      "level": 3,
      "content": "Para atualizar o mirrorlist diariamente, considere o seguinte:\n\n```\n/etc/cron.daily/mirrorlist\n```\n\n```\n#!/bin/bash\n\n# Obtém a lista por país\n/usr/bin/reflector -c \"India\" -p http --sort rate > /etc/pacman.d/mirrorlist\n\n# Trabalha com as alternativas\n/usr/bin/reflector -p http  --latest 20 -p https -p ftp --sort rate >> /etc/pacman.d/mirrorlist\n```\n\n"
    },
    {
      "title": "Veja também",
      "level": 2,
      "content": "- Tópico sobre o Reflector no fórum do Arch Linux\n\n"
    }
  ]
}